(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[    234816,       4934]
NotebookOptionsPosition[    229779,       4782]
NotebookOutlinePosition[    231458,       4834]
CellTagsIndexPosition[    231122,       4822]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Astronomical Clock", "DemoTitle",
 CellChangeTimes->{{3.542258080046875*^9, 3.542258088609375*^9}, {
  3.5424254136875*^9, 3.5424254158125*^9}}],

Cell["", "InitializationSection"],

Cell[CellGroupData[{

Cell["", "ManipulateSection"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", " ", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Quiet", "@", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Epsilon]", "=", 
         RowBox[{"23.45", "Degree"}]}], ",", "d", ",", "m", ",", "t", ",", 
        "sp", ",", "mp", ",", "ep"}], "}"}], ",", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"\[Phi]", "\[Equal]", "0"}], ",", 
         RowBox[{"\[Phi]", "=", ".001"}]}], "]"}], ";", 
       RowBox[{"thisYear", 
        RowBox[{"(*", 
         RowBox[{
         "the", " ", "current", " ", "year", " ", "as", " ", "an", " ", 
          "Integer"}], "*)"}], "=", 
        RowBox[{"First", "[", 
         RowBox[{"DateList", "[", "Today", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"d", "=", 
        RowBox[{"(*", 
         RowBox[{"date", " ", "calibration"}], "*)"}], 
        RowBox[{"2", "\[Pi]", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Mod", "[", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"\[Phi]", "\[GreaterEqual]", "0"}], ",", "date", ",", 
                RowBox[{"date", "-", "182.5"}]}], "]"}], ",", "365"}], "]"}], 
            "+", "10"}], ")"}], "/", "365"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"m", "=", 
        RowBox[{"(*", 
         RowBox[{"Moon", " ", "phase", " ", "calibration"}], "*)"}], 
        RowBox[{
         RowBox[{
          RowBox[{"-", "12.36"}], 
          RowBox[{"(*", 
           RowBox[{"lunations", " ", "in", " ", "a", " ", "year"}], "*)"}], 
          "2", "\[Pi]", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"date", "+", "10"}], ")"}], "/", "365"}]}], "+", ".7"}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"t", "=", 
        RowBox[{"(*", 
         RowBox[{"time", " ", "calibration"}], "*)"}], 
        RowBox[{
         RowBox[{"\[Pi]", "/", "12"}], 
         RowBox[{"(", 
          RowBox[{"30", "-", "time", "+", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"\[Phi]", "\[GreaterEqual]", "0"}], ",", "0", ",", 
             "12"}], "]"}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"sp", "=", 
        RowBox[{"(*", 
         RowBox[{"Sun", " ", "position"}], "*)"}], 
        RowBox[{"2", 
         RowBox[{"Sec", "[", "\[Epsilon]", "]"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             RowBox[{"Cos", "[", "d", "]"}]}], " ", 
            RowBox[{"Tan", "[", "\[Epsilon]", "]"}]}], "+", 
           RowBox[{"Sqrt", "[", 
            RowBox[{"1", "-", 
             RowBox[{
              RowBox[{
               RowBox[{"Sin", "[", "d", "]"}], "^", "2"}], " ", 
              RowBox[{
               RowBox[{"Tan", "[", "\[Epsilon]", "]"}], "^", "2"}]}]}], 
            "]"}]}], ")"}], 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"Cos", "[", "t", "]"}]}], ",", 
           RowBox[{"-", 
            RowBox[{"Sin", "[", "t", "]"}]}]}], "}"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"mp", "=", 
        RowBox[{"(*", 
         RowBox[{"Moon", " ", "position"}], "*)"}], 
        RowBox[{"2", 
         RowBox[{"Sec", "[", "\[Epsilon]", "]"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             RowBox[{"Cos", "[", 
              RowBox[{"d", "-", "m"}], "]"}]}], " ", 
            RowBox[{"Tan", "[", "\[Epsilon]", "]"}]}], "+", 
           RowBox[{"Sqrt", "[", 
            RowBox[{"1", "-", 
             RowBox[{
              RowBox[{
               RowBox[{"Sin", "[", 
                RowBox[{"d", "-", "m"}], "]"}], "^", "2"}], " ", 
              RowBox[{
               RowBox[{"Tan", "[", "\[Epsilon]", "]"}], "^", "2"}]}]}], 
            "]"}]}], ")"}], 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"Cos", "[", 
             RowBox[{"t", "-", "m"}], "]"}]}], ",", 
           RowBox[{"-", 
            RowBox[{"Sin", "[", 
             RowBox[{"t", "-", "m"}], "]"}]}]}], "}"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ep", "=", 
        RowBox[{"(*", 
         RowBox[{"ecliptic", " ", "position"}], "*)"}], 
        RowBox[{"2", " ", 
         RowBox[{"Tan", "[", "\[Epsilon]", "]"}], 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"d", "-", "t"}], "]"}], ",", 
           RowBox[{"-", 
            RowBox[{"Sin", "[", 
             RowBox[{"d", "-", "t"}], "]"}]}]}], "}"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Graphics", "[", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{"(*", "axes", "*)"}], 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Gray", ",", 
             RowBox[{"Line", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "3"}], ",", "0"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"3", ",", "0"}], "}"}]}], "}"}], "]"}], ",", 
             RowBox[{"Line", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0", ",", 
                  RowBox[{"-", "3"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "3"}], "}"}]}], "}"}], "]"}]}], "}"}], ",",
            "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"astro", " ", "night"}], "*)"}], 
           RowBox[{"{", 
            RowBox[{"Gray", ",", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"\[Phi]", "\[GreaterEqual]", "0"}], ",", 
               RowBox[{"Disk", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"0", ",", 
                   RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Cot", "[", " ", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"\[Pi]", "+", 
                    RowBox[{"10", " ", "\[Phi]"}]}], ")"}], "/", "20"}], 
                    "]"}]}], "-", 
                    RowBox[{"Tan", "[", " ", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"\[Pi]", "-", 
                    RowBox[{"10", " ", "\[Phi]"}]}], ")"}], "/", "20"}], 
                    "]"}]}]}], "}"}], ",", 
                 RowBox[{"Abs", "[", 
                  RowBox[{
                   RowBox[{"Cot", "[", " ", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"\[Pi]", "+", 
                    RowBox[{"10", " ", "\[Phi]"}]}], ")"}], "/", "20"}], 
                    "]"}], "-", 
                   RowBox[{"Tan", "[", " ", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"\[Pi]", "-", 
                    RowBox[{"10", " ", "\[Phi]"}]}], ")"}], "/", "20"}], 
                    "]"}]}], "]"}]}], "]"}], ",", 
               RowBox[{"Disk", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"0", ",", 
                   RowBox[{
                    RowBox[{"Cot", "[", " ", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"\[Pi]", "-", 
                    RowBox[{"10", " ", "\[Phi]"}]}], ")"}], "/", "20"}], 
                    "]"}], "+", 
                    RowBox[{"Tan", "[", " ", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"\[Pi]", "+", 
                    RowBox[{"10", " ", "\[Phi]"}]}], ")"}], "/", "20"}], 
                    "]"}]}]}], "}"}], ",", 
                 RowBox[{"Abs", "[", 
                  RowBox[{
                   RowBox[{"Cot", "[", " ", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"\[Pi]", "-", 
                    RowBox[{"10", " ", "\[Phi]"}]}], ")"}], "/", "20"}], 
                    "]"}], "-", 
                   RowBox[{"Tan", "[", " ", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"\[Pi]", "+", 
                    RowBox[{"10", " ", "\[Phi]"}]}], ")"}], "/", "20"}], 
                    "]"}]}], "]"}]}], "]"}]}], "]"}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", "almucantars", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Lighter", "[", 
              RowBox[{"Red", ",", ".75"}], "]"}], ",", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"\[Phi]", "\[GreaterEqual]", "0"}], ",", 
                 RowBox[{"Circle", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Cos", "[", "\[Phi]", "]"}]}], " ", 
                    RowBox[{"Csc", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"\[Alpha]", "+", "\[Phi]"}], ")"}], "/", "2"}], 
                    "]"}], " ", 
                    RowBox[{"Sec", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"\[Alpha]", "-", "\[Phi]"}], ")"}], "/", "2"}], 
                    "]"}]}]}], "}"}], ",", 
                   RowBox[{"Abs", "[", 
                    RowBox[{
                    RowBox[{"Cos", "[", "\[Alpha]", "]"}], " ", 
                    RowBox[{"Csc", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"\[Alpha]", "+", "\[Phi]"}], ")"}], "/", "2"}], 
                    "]"}], " ", 
                    RowBox[{"Sec", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"\[Alpha]", "-", "\[Phi]"}], ")"}], "/", "2"}], 
                    "]"}]}], "]"}]}], "]"}], ",", 
                 RowBox[{"Circle", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
                    RowBox[{"Csc", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"\[Alpha]", "-", "\[Phi]"}], ")"}], "/", "2"}], 
                    "]"}], " ", 
                    RowBox[{"Sec", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"\[Alpha]", "+", "\[Phi]"}], ")"}], "/", "2"}], 
                    "]"}]}]}], "}"}], ",", 
                   RowBox[{"Abs", "[", 
                    RowBox[{
                    RowBox[{"Cos", "[", "\[Alpha]", "]"}], " ", 
                    RowBox[{"Csc", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"\[Alpha]", "-", "\[Phi]"}], ")"}], "/", "2"}], 
                    "]"}], " ", 
                    RowBox[{"Sec", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"\[Alpha]", "+", "\[Phi]"}], ")"}], "/", "2"}], 
                    "]"}]}], "]"}]}], "]"}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"\[Alpha]", ",", 
                 RowBox[{
                  RowBox[{"-", "89.999"}], "Degree"}], ",", 
                 RowBox[{"90", "Degree"}], ",", 
                 RowBox[{"9.", "Degree"}]}], "}"}]}], "]"}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", "horizon", "*)"}], 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Lighter", "[", 
                RowBox[{"Gray", ",", ".5"}], "]"}], ",", 
               RowBox[{"Opacity", "[", ".5", "]"}], ",", 
               RowBox[{"Disk", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"0", ",", 
                   RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Cot", "[", 
                    RowBox[{"\[Phi]", "/", "2"}], "]"}]}], "+", 
                    RowBox[{"Tan", "[", 
                    RowBox[{"\[Phi]", "/", "2"}], "]"}]}]}], "}"}], ",", 
                 RowBox[{"2", 
                  RowBox[{"Abs", "[", " ", 
                   RowBox[{"Csc", "[", "\[Phi]", "]"}], "]"}]}]}], "]"}]}], 
              "}"}], ",", 
             RowBox[{"Directive", "[", 
              RowBox[{"Red", ",", 
               RowBox[{"AbsoluteThickness", "[", "3", "]"}]}], "]"}], ",", 
             RowBox[{"Circle", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", 
                 RowBox[{
                  RowBox[{"-", 
                   RowBox[{"Cot", "[", 
                    RowBox[{"\[Phi]", "/", "2"}], "]"}]}], "+", 
                  RowBox[{"Tan", "[", 
                   RowBox[{"\[Phi]", "/", "2"}], "]"}]}]}], "}"}], ",", 
               RowBox[{"2", " ", 
                RowBox[{"Abs", "[", 
                 RowBox[{"Csc", "[", "\[Phi]", "]"}], "]"}]}]}], "]"}]}], 
            "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"(*", "zenith", "*)"}], 
           RowBox[{"{", 
            RowBox[{"Red", ",", 
             RowBox[{"AbsoluteThickness", "[", "2", "]"}], ",", 
             RowBox[{"Circle", "[", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"\[Phi]", "\[GreaterEqual]", "0"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", 
                   RowBox[{
                    RowBox[{"-", "2"}], " ", 
                    RowBox[{"Cot", "[", " ", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"\[Pi]", "+", 
                    RowBox[{"2", " ", "\[Phi]"}]}], ")"}], "/", "4"}], 
                    "]"}]}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", 
                   RowBox[{"2", " ", 
                    RowBox[{"Tan", "[", " ", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"\[Pi]", "+", 
                    RowBox[{"2", " ", "\[Phi]"}]}], ")"}], "/", "4"}], 
                    "]"}]}]}], "}"}]}], "]"}], ",", ".05"}], "]"}]}], "}"}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"(*", "equator", "*)"}], 
           RowBox[{"{", 
            RowBox[{"Gray", ",", 
             RowBox[{"Circle", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", "0"}], "}"}], ",", " ", "2"}], "]"}]}], 
            "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"(*", "tropics", "*)"}], 
           RowBox[{"{", 
            RowBox[{"Gray", ",", "Dashed", ",", 
             RowBox[{"Circle", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", "0"}], "}"}], ",", 
               RowBox[{"2", " ", 
                RowBox[{
                 RowBox[{"Cos", "[", "\[Epsilon]", "]"}], "/", 
                 RowBox[{"(", 
                  RowBox[{"1", "+", 
                   RowBox[{"Sin", "[", "\[Epsilon]", "]"}]}], ")"}]}]}]}], 
              "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"AbsoluteThickness", "[", "5", "]"}], ",", "Black", ",", 
             RowBox[{"Circle", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", "0"}], "}"}], ",", 
               RowBox[{"2", " ", 
                RowBox[{
                 RowBox[{"Cos", "[", "\[Epsilon]", "]"}], "/", 
                 RowBox[{"(", 
                  RowBox[{"1", "-", 
                   RowBox[{"Sin", "[", "\[Epsilon]", "]"}]}], ")"}]}]}]}], 
              "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"(*", "motto", "*)"}], 
           RowBox[{"Text", "[", 
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{
              "\"\<Tempus Fugit\>\"", ",", "15", ",", "Italic", ",", "Bold"}],
               "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"-", "2.5"}]}], "}"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", "ecliptic", "*)"}], 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{"(*", "ring", "*)"}], 
            RowBox[{
             RowBox[{"AbsoluteThickness", "[", "3", "]"}], ",", "Blue", ",", 
             RowBox[{
              RowBox[{
               RowBox[{"Circle", "[", 
                RowBox[{"ep", ",", 
                 RowBox[{"#", 
                  RowBox[{"Sec", "[", "\[Epsilon]", "]"}]}]}], "]"}], "&"}], "/@", 
              RowBox[{"{", 
               RowBox[{"1.95", ",", "1.68"}], "}"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", "spokes", "*)"}], 
             RowBox[{"AbsoluteThickness", "[", "2", "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Line", "[", 
              RowBox[{"1.6", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", " ", 
                  RowBox[{
                   RowBox[{"Sin", "[", 
                    RowBox[{"d", "-", "t"}], "]"}], ",", " ", 
                   RowBox[{"Cos", "[", 
                    RowBox[{"d", "-", "t"}], "]"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"d", "-", "t"}], "]"}]}], ",", 
                   RowBox[{"-", " ", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"d", "-", "t"}], "]"}]}]}], "}"}]}], "}"}]}], 
              "]"}], ",", 
             RowBox[{"Line", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{".97", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", " ", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"d", "-", "t"}], "]"}]}], ",", " ", 
                   RowBox[{"Sin", "[", 
                    RowBox[{"d", "-", "t"}], "]"}]}], "}"}]}], ",", 
                RowBox[{"2.7", 
                 RowBox[{"{", " ", 
                  RowBox[{
                   RowBox[{"Cos", "[", 
                    RowBox[{"d", "-", "t"}], "]"}], ",", 
                   RowBox[{"-", " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"d", "-", "t"}], "]"}]}]}], "}"}]}]}], "}"}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{"month", " ", "separators"}], "*)"}], 
             RowBox[{"Line", "/@", 
              RowBox[{"Transpose", "[", 
               RowBox[{"Table", "[", 
                RowBox[{"(*", 
                 RowBox[{".35", "=", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"offset", " ", "Jan", " ", "1"}], " ", "&"}], " ",
                    "Winter", " ", "solstice", " ", "21", " ", "Dec"}]}], 
                 "*)"}], 
                RowBox[{
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], 
                    RowBox[{"Cos", "[", 
                    RowBox[{"#", "+", ".35"}], "]"}], " ", 
                    RowBox[{"Tan", "[", "\[Epsilon]", "]"}]}], "+", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"i", "^", "2"}], 
                    SuperscriptBox[
                    RowBox[{"Sec", "[", "\[Epsilon]", "]"}], "2"]}], "-", 
                    RowBox[{"4", 
                    RowBox[{
                    RowBox[{"Sin", "[", 
                    RowBox[{"#", "+", ".35"}], "]"}], "^", "2"}], " ", 
                    RowBox[{
                    RowBox[{"Tan", "[", "\[Epsilon]", "]"}], "^", "2"}]}]}], 
                    "]"}]}], ")"}], 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"#", "+", ".35", "+", "d", "-", "t"}], "]"}]}], 
                    ",", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"#", "+", ".35", "+", "d", "-", "t"}], "]"}]}], 
                    "}"}]}], "&"}], "/@", 
                    RowBox[{"Range", "[", 
                    RowBox[{
                    RowBox[{"\[Pi]", "/", "6"}], ",", 
                    RowBox[{"2", "\[Pi]"}], ",", 
                    RowBox[{"\[Pi]", "/", "6"}]}], "]"}]}], "}"}], 
                  "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", 
                   RowBox[{"{", 
                    RowBox[{"1.95", ",", "1.68"}], "}"}]}], "}"}]}], "]"}], 
               "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"Sun", "-", 
             RowBox[{"Moon", " ", "synchro", " ", "mechanism"}]}], "*)"}], 
           RowBox[{"{", 
            RowBox[{"Purple", ",", 
             RowBox[{"AbsolutePointSize", "[", "7", "]"}], ",", 
             RowBox[{"(*", 
              RowBox[{"center", " ", "ecliptic"}], "*)"}], 
             RowBox[{"Point", "[", "ep", "]"}], ",", 
             RowBox[{"AbsoluteThickness", "[", "1", "]"}], ",", 
             RowBox[{"(*", 
              RowBox[{"Sun", " ", "connect"}], "*)"}], 
             RowBox[{"Line", "[", 
              RowBox[{"{", 
               RowBox[{"ep", ",", "sp"}], "}"}], "]"}], ",", 
             RowBox[{"(*", 
              RowBox[{"Moon", " ", "connect"}], "*)"}], 
             RowBox[{"Line", "[", 
              RowBox[{"{", 
               RowBox[{"ep", ",", "mp"}], "}"}], "]"}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"clock", " ", "dial", " ", "etc"}], "*)"}], "dial", ",", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"Sun", " ", "hand"}], "*)"}], 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"AbsoluteThickness", "[", "3", "]"}], ",", 
             RowBox[{"Arrow", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{".35", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Cos", "[", "t", "]"}], ",", 
                   RowBox[{"Sin", "[", "t", "]"}]}], "}"}]}], ",", 
                RowBox[{
                 RowBox[{"-", "3.45"}], 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Cos", "[", "t", "]"}], ",", 
                   RowBox[{"Sin", "[", "t", "]"}]}], "}"}]}]}], "}"}], 
              "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"(*", "Sun", "*)"}], 
           RowBox[{"{", 
            RowBox[{"Yellow", ",", 
             RowBox[{"Disk", "[", 
              RowBox[{"sp", ",", ".195"}], "]"}], ",", "Red", ",", 
             RowBox[{"Circle", "[", 
              RowBox[{"sp", ",", ".198"}], "]"}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"Moon", " ", "hand"}], "*)"}], 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"AbsoluteThickness", "[", "2", "]"}], ",", "Gray", ",", 
             RowBox[{"Line", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{".35", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Cos", "[", 
                    RowBox[{"t", "-", "m"}], "]"}], ",", 
                   RowBox[{"Sin", "[", 
                    RowBox[{"t", "-", "m"}], "]"}]}], "}"}]}], ",", 
                RowBox[{
                 RowBox[{"-", "3.2"}], 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Cos", "[", 
                    RowBox[{"t", "-", "m"}], "]"}], ",", 
                   RowBox[{"Sin", "[", 
                    RowBox[{"t", "-", "m"}], "]"}]}], "}"}]}]}], "}"}], 
              "]"}]}], "}"}], ",", "\[IndentingNewLine]", " ", 
           RowBox[{"(*", "Moon", "*)"}], 
           RowBox[{"moon", "[", 
            RowBox[{
             RowBox[{"Rescale", "[", 
              RowBox[{
               RowBox[{"MoonPhase", "[", 
                RowBox[{"DatePlus", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"DateList", "[", "Today", "]"}], "]"}], ",", "0", 
                    ",", "0"}], "}"}], ",", "date"}], "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "1"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}], 
             RowBox[{"(*", 
              RowBox[{"1.95", 
               RowBox[{
                RowBox[{"TriangleWave", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"m", "/", "2"}], "/", "\[Pi]"}], "-", ".25"}], 
                 "]"}], "/", "2"}]}], "*)"}], ",", "mp", ",", ".185"}], "]"}],
            ",", "\[IndentingNewLine]", 
           RowBox[{"(*", "center", "*)"}], 
           RowBox[{"{", 
            RowBox[{"Disk", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}], ",", ".1"}], "]"}], "}"}]}], 
          "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"PlotRange", "\[Rule]", "4.1"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "400"}]}], "]"}]}]}], "]"}]}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"pd", 
       RowBox[{"(*", 
        RowBox[{"present", " ", "day"}], "*)"}], ",", 
       RowBox[{"Dynamic", "[", 
        RowBox[{"Quiet", "@", 
         RowBox[{"DateDifference", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"thisYear", ",", "1", ",", "1"}], "}"}], ",", 
           RowBox[{"DateList", "[", "]"}]}], "]"}]}], "]"}]}], "}"}], ",", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"pt", 
       RowBox[{"(*", 
        RowBox[{"present", " ", "time"}], "*)"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"DateList", "[", "]"}], "\[LeftDoubleBracket]", "4", 
         "\[RightDoubleBracket]"}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"DateList", "[", "]"}], "\[LeftDoubleBracket]", "5", 
          "\[RightDoubleBracket]"}], "/", "60."}]}]}], "}"}], ",", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], ",", 
   "\[IndentingNewLine]", "\"\<observer's latitude\>\"", ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Phi]", ",", 
       RowBox[{"51", "Degree"}], ",", "\"\<\>\""}], "}"}], ",", 
     RowBox[{
      RowBox[{"-", "90"}], "Degree"}], ",", 
     RowBox[{"90", "Degree"}], ",", 
     RowBox[{"1", "Degree"}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "Tiny"}], ",", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
     RowBox[{"AppearanceElements", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "\"\<InputField\>\"", ",", "\"\<StepLeftButton\>\"", ",", 
        "\"\<PlayPauseButton\>\"", ",", "\"\<StepRightButton\>\""}], 
       "}"}]}]}], "}"}], ",", "\[IndentingNewLine]", "\"\<city\>\"", ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Phi]", ",", 
       RowBox[{"51", "Degree"}], ",", "\"\<\>\""}], "}"}], ",", "latitudes"}],
     "}"}], ",", "Delimiter", ",", "\[IndentingNewLine]", "\"\<date\>\"", ",", 
   RowBox[{"Row", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Control", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"date", ",", "0", ",", "\"\<\>\""}], "}"}], ",", "0", ",", 
         RowBox[{"4", "*", "365"}], 
         RowBox[{"(*", 
          RowBox[{
          "slider", " ", "range", " ", "of", " ", "4", "*", "365", " ", 
           "days", " ", "starting", " ", "1", " ", "Jan", " ", "of", " ", 
           "current", " ", "year"}], "*)"}], ",", "1", ",", 
         RowBox[{"ImageSize", "\[Rule]", "Tiny"}], ",", 
         RowBox[{"AppearanceElements", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<InputField\>\"", ",", "\"\<StepLeftButton\>\"", ",", 
            "\"\<PlayPauseButton\>\"", ",", "\"\<StepRightButton\>\"", ",", 
            "\"\<FasterSlowerButtons\>\""}], "}"}]}]}], "}"}], "]"}], ",", 
      RowBox[{"Spacer", "[", "4", "]"}], ",", 
      RowBox[{"Dynamic", "[", 
       RowBox[{"DateString", "[", 
        RowBox[{
         RowBox[{"DatePlus", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"thisYear", ",", "1", ",", "1"}], "}"}], ",", "date"}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
          "\"\<Day\>\"", ",", "\"\< \>\"", ",", "\"\<MonthNameShort\>\"", 
           ",", "\"\< \>\"", ",", "\"\<YearShort\>\""}], "}"}]}], "]"}], 
       "]"}]}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Control", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"date", ",", "pd", ",", "\"\<\>\""}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"80.5", "\[Rule]", "\"\<Mar 21\>\""}], ",", 
        RowBox[{"172", "\[Rule]", "\"\<Jun 21\>\""}], ",", 
        RowBox[{"265", "\[Rule]", "\"\<Sep 22\>\""}], ",", 
        RowBox[{"355", "\[Rule]", "\"\<Dec 21\>\""}]}], "}"}]}], "}"}], "]"}],
    ",", "Delimiter", ",", "\[IndentingNewLine]", 
   "\"\<apparent solar time\>\"", ",", 
   RowBox[{"Row", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Control", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"time", ",", "0", ",", "\"\<\>\""}], "}"}], ",", "0", ",", 
         "24", ",", 
         RowBox[{"1.", "/", "60"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "Tiny"}], ",", 
         RowBox[{"AppearanceElements", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<InputField\>\"", ",", "\"\<StepLeftButton\>\"", ",", 
            "\"\<PlayPauseButton\>\"", ",", "\"\<StepRightButton\>\"", ",", 
            "\"\<FasterSlowerButtons\>\""}], "}"}]}]}], "}"}], "]"}], ",", 
      RowBox[{"Spacer", "[", "4", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Dynamic", "[", 
       RowBox[{"DateString", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"thisYear", ",", "1", ",", "1", ",", 
           RowBox[{"Mod", "[", 
            RowBox[{"time", ",", "12"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\"\<Hour\>\"", ",", "\"\<:\>\"", ",", "\"\<Minute\>\""}], 
          "}"}]}], "]"}], "]"}]}], "}"}], "]"}], ",", "Delimiter", ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Button", "[", 
    RowBox[{"\"\<at your location now\>\"", ",", 
     RowBox[{
      RowBox[{"\[Phi]", "=", 
       RowBox[{"First", "[", 
        RowBox[{
         RowBox[{"Round", "[", 
          RowBox[{
           RowBox[{
           "$GeoLocation", "\[LeftDoubleBracket]", "1", 
            "\[RightDoubleBracket]"}], "10"}], "]"}], 
         RowBox[{"Degree", "/", "10."}]}], "]"}]}], ";", 
      RowBox[{"date", "=", 
       RowBox[{
        RowBox[{"DateDifference", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"thisYear", ",", "1", ",", "1"}], "}"}], ",", 
          RowBox[{"DateList", "[", "]"}]}], "]"}], "\[LeftDoubleBracket]", 
        "1", "\[RightDoubleBracket]"}]}], ";", 
      RowBox[{"time", "=", 
       RowBox[{"(*", 
        RowBox[{"calculated", " ", "apparent", " ", "solar", " ", "time"}], 
        "*)"}], 
       RowBox[{"Mod", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"First", "[", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"DateList", "[", "]"}], "\[LeftDoubleBracket]", "4", 
               "\[RightDoubleBracket]"}], "*", "60"}], "+", 
             RowBox[{
              RowBox[{"DateList", "[", "]"}], "\[LeftDoubleBracket]", "5", 
              "\[RightDoubleBracket]"}], "+", 
             RowBox[{"TCF", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"DateDifference", "[", 
                 RowBox[{"thisYear", 
                  RowBox[{"(*", "\"\<Jan 1\>\"", "*)"}], ",", 
                  RowBox[{"DateList", "[", "]"}]}], "]"}], 
                "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
               RowBox[{
               "$GeoLocation", "\[LeftDoubleBracket]", "1", 
                "\[RightDoubleBracket]"}], ",", "$TimeZone", ",", "False"}], 
              "]"}]}], ")"}], "]"}], "/", "60"}], ",", "24"}], "]"}]}]}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "155"}]}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"thisYear", ",", "2017", ",", 
     RowBox[{"ControlType", "\[Rule]", " ", "None"}]}], "}"}], ",", 
   "\[IndentingNewLine]", "Delimiter", ",", "\[IndentingNewLine]", 
   RowBox[{"ControlPlacement", "\[Rule]", "Left"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"TrackedSymbols", "\[RuleDelayed]", 
    RowBox[{"{", 
     RowBox[{
     "pd", ",", "pt", ",", "\[Phi]", ",", "date", ",", "time", ",", " ", 
      "thisYear"}], "}"}]}], ",", 
   RowBox[{"SynchronousUpdating", "\[Rule]", "True"}], ",", 
   RowBox[{"AutorunSequencing", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"3", ",", "4", ",", "5", ",", "6", ",", "7"}], "}"}]}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Bookmarks", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\"\<New Moon\>\"", "\[RuleDelayed]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"date", "=", "11.5"}], ",", 
         RowBox[{"pd", "=", "96"}], ",", 
         RowBox[{"pt", "=", "10"}], ",", 
         RowBox[{"time", "=", "19"}], ",", 
         RowBox[{"\[Phi]", "=", 
          RowBox[{"5", " ", "Degree"}]}]}], "}"}]}], ",", 
      RowBox[{"\"\<Full Moon\>\"", "\[RuleDelayed]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"date", "=", "27.75"}], ",", 
         RowBox[{"pd", "=", "96"}], ",", 
         RowBox[{"pt", "=", "10"}], ",", 
         RowBox[{"time", "=", "19.9"}], ",", 
         RowBox[{"\[Phi]", "=", 
          RowBox[{"34", " ", "Degree"}]}]}], "}"}]}]}], "}"}]}], ",", 
   RowBox[{"Initialization", "\[RuleDelayed]", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"latitudes", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"61", " ", "\[Degree]"}], "\[Rule]", "\"\<Anchorage\>\""}], 
         ",", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "37"}], " ", "\[Degree]"}], "\[Rule]", 
          "\"\<Auckland\>\""}], ",", 
         RowBox[{
          RowBox[{"14", " ", "\[Degree]"}], "\[Rule]", "\"\<Bangkok\>\""}], 
         ",", 
         RowBox[{
          RowBox[{"40", " ", "\[Degree]"}], "\[Rule]", "\"\<Beijing\>\""}], 
         ",", 
         RowBox[{
          RowBox[{"5", " ", "\[Degree]"}], "\[Rule]", "\"\<Bogota\>\""}], ",", 
         RowBox[{
          RowBox[{"19", " ", "\[Degree]"}], "\[Rule]", "\"\<Bombay\>\""}], 
         ",", 
         RowBox[{
          RowBox[{"51", " ", "\[Degree]"}], "\[Rule]", "\"\<Brussels\>\""}], 
         ",", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "35"}], " ", "\[Degree]"}], "\[Rule]", 
          "\"\<BuenosAires\>\""}], ",", 
         RowBox[{
          RowBox[{"30", " ", "\[Degree]"}], "\[Rule]", "\"\<Cairo\>\""}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "34"}], " ", "\[Degree]"}], "\[Rule]", 
          "\"\<CapeTown\>\""}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"335", "/", "10"}], " ", "\[Degree]"}], "\[Rule]", 
          "\"\<Casablanca\>\""}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"418", "/", "10"}], " ", "\[Degree]"}], "\[Rule]", 
          "\"\<Chicago\>\""}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"1", "/", "100"}], "\[Degree]"}], "\[Rule]", 
          "\"\<Equator\>\""}], ",", 
         RowBox[{
          RowBox[{"22", " ", "\[Degree]"}], "\[Rule]", "\"\<HongKong\>\""}], 
         ",", 
         RowBox[{
          RowBox[{"41", " ", "\[Degree]"}], "\[Rule]", "\"\<Istanbul\>\""}], 
         ",", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "6"}], " ", "\[Degree]"}], "\[Rule]", 
          "\"\<Jakarta\>\""}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "4"}], " ", "\[Degree]"}], "\[Rule]", 
          "\"\<Kinshasa\>\""}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "12"}], " ", "\[Degree]"}], "\[Rule]", 
          "\"\<Lima\>\""}], ",", 
         RowBox[{
          RowBox[{"52", " ", "\[Degree]"}], "\[Rule]", "\"\<London\>\""}], 
         ",", 
         RowBox[{
          RowBox[{"34", " ", "\[Degree]"}], "\[Rule]", "\"\<LosAngeles\>\""}],
          ",", 
         RowBox[{
          RowBox[{"15", " ", "\[Degree]"}], "\[Rule]", "\"\<Manila\>\""}], 
         ",", 
         RowBox[{
          RowBox[{"26", " ", "\[Degree]"}], "\[Rule]", "\"\<Miami\>\""}], ",", 
         RowBox[{
          RowBox[{"46", " ", "\[Degree]"}], "\[Rule]", "\"\<Montreal\>\""}], 
         ",", 
         RowBox[{
          RowBox[{"56", " ", "\[Degree]"}], "\[Rule]", "\"\<Moscow\>\""}], 
         ",", 
         RowBox[{
          RowBox[{"-", "\[Degree]"}], "\[Rule]", "\"\<Nairobi\>\""}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"423", "/", "10"}], "\[Degree]"}], "\[Rule]", 
          "\"\<NewYork\>\""}], ",", 
         RowBox[{
          RowBox[{"90", " ", "\[Degree]"}], "\[Rule]", "\"\<North Pole\>\""}],
          ",", 
         RowBox[{
          RowBox[{"49", " ", "\[Degree]"}], "\[Rule]", "\"\<Paris\>\""}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"419", "/", "10"}], "\[Degree]"}], "\[Rule]", 
          "\"\<Rome\>\""}], ",", 
         RowBox[{
          RowBox[{"60", " ", "\[Degree]"}], "\[Rule]", 
          "\"\<SaintPetersburg\>\""}], ",", 
         RowBox[{
          RowBox[{"38", " ", "\[Degree]"}], "\[Rule]", 
          "\"\<San Francisco\>\""}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "33"}], " ", "\[Degree]"}], "\[Rule]", 
          "\"\<Santiago\>\""}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "24"}], " ", "\[Degree]"}], "\[Rule]", 
          "\"\<SaoPaulo\>\""}], ",", 
         RowBox[{
          RowBox[{"31", " ", "\[Degree]"}], "\[Rule]", "\"\<Shanghai\>\""}], 
         ",", 
         RowBox[{"\[Degree]", "\[Rule]", "\"\<Singapore\>\""}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "90"}], " ", "\[Degree]"}], "\[Rule]", 
          "\"\<South Pole\>\""}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"-", "338"}], "/", "10"}], " ", "\[Degree]"}], "\[Rule]", 
          "\"\<Sydney\>\""}], ",", 
         RowBox[{
          RowBox[{"36", " ", "\[Degree]"}], "\[Rule]", "\"\<Tokyo\>\""}]}], 
        "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"dial", "=", 
       RowBox[{"{", 
        RowBox[{"(*", "rim", "*)"}], 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"GrayLevel", "[", 
               RowBox[{"(", 
                RowBox[{"1", "-", 
                 SuperscriptBox["#", "2"]}], ")"}], "]"}], ",", "Thick", ",", 
              RowBox[{"Circle", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0", ",", "0"}], "}"}], ",", 
                RowBox[{"3.1", "+", "#"}]}], "]"}]}], "}"}], "&"}], "/@", 
           RowBox[{"Range", "[", 
            RowBox[{"0", ",", "1.05", ",", ".025"}], "]"}]}], "}"}], ",", 
         RowBox[{"(*", "background", "*)"}], 
         RowBox[{"{", 
          RowBox[{"Gray", ",", "Thick", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"Circle", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", "0"}], "}"}], ",", 
               RowBox[{"4.05", "+", "#"}]}], "]"}], "&"}], "/@", 
            RowBox[{"Range", "[", 
             RowBox[{"0", ",", "1.74", ",", ".025"}], "]"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"Thick", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"Line", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"3.1", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Sin", "[", "#", "]"}], ",", 
                   RowBox[{"-", 
                    RowBox[{"Cos", "[", "#", "]"}]}]}], "}"}]}], ",", 
                RowBox[{"3.2", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Sin", "[", "#", "]"}], ",", 
                   RowBox[{"-", 
                    RowBox[{"Cos", "[", "#", "]"}]}]}], "}"}]}]}], "}"}], 
              "]"}], "&"}], "/@", 
            RowBox[{"Range", "[", 
             RowBox[{"0", ",", 
              RowBox[{"2", "\[Pi]"}], ",", 
              RowBox[{"\[Pi]", "/", "12"}]}], "]"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"Text", "[", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{
                RowBox[{"IntegerString", "[", 
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"#", "\[Equal]", "0"}], "\[Or]", 
                    RowBox[{"#", "\[Equal]", "12"}]}], ",", "12", ",", 
                    RowBox[{"Mod", "[", 
                    RowBox[{"#", ",", "12"}], "]"}]}], "]"}], ",", 
                  "\"\<Roman\>\""}], "]"}], ",", "14", ",", "Bold"}], "]"}], 
              ",", 
              RowBox[{"3.5", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Sin", "[", 
                  RowBox[{
                   RowBox[{"#", "/", "12"}], "\[Pi]"}], "]"}], ",", 
                 RowBox[{"Cos", "[", 
                  RowBox[{
                   RowBox[{"#", "/", "12"}], "\[Pi]"}], "]"}]}], "}"}]}]}], 
             "]"}], "&"}], "/@", 
           RowBox[{"Range", "[", 
            RowBox[{"0", ",", "23"}], "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"White", ",", 
               RowBox[{"Text", "[", 
                RowBox[{
                 RowBox[{"Style", "[", 
                  RowBox[{
                   RowBox[{
                   "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", "12", ",", "Bold", ",", 
                   "Italic"}], "]"}], ",", 
                 RowBox[{"3.85", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Sin", "[", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "]"}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Cos", "[", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "]"}]}]}], "}"}]}]}], "]"}]}], 
              "}"}], "&"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"\"\<N\>\"", ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<W\>\"", ",", 
                RowBox[{"\[Pi]", "/", "2"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<S\>\"", ",", "\[Pi]"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<E\>\"", ",", 
                RowBox[{"3", 
                 RowBox[{"\[Pi]", "/", "2"}]}]}], "}"}]}], "}"}]}], "]"}], 
          "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"moon", "[", 
        RowBox[{"m_", ",", 
         RowBox[{"{", 
          RowBox[{"x0_", ",", "y0_"}], "}"}], ",", "r_"}], "]"}], ":=", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Moon", " ", "with", " ", "center", " ", "at", " ", 
          RowBox[{"{", 
           RowBox[{"x0", ",", "y0"}], "}"}]}], ",", " ", 
         RowBox[{
         "radius", " ", "r", " ", "and", " ", "fraction", " ", "m", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "1"}], " ", "to"}], " ", "+", "1"}], ")"}], "of", 
          " ", "white"}]}], "*)"}], 
       RowBox[{
        RowBox[{"Plot", "[", 
         RowBox[{
          RowBox[{"Evaluate", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"y0", "-", 
              RowBox[{"#", " ", 
               RowBox[{"Sqrt", "[", 
                RowBox[{
                 RowBox[{"r", "^", "2"}], "-", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"x0", "-", "x"}], ")"}], "^", "2"}]}], "]"}]}]}], 
             "&"}], "/@", 
            RowBox[{"{", 
             RowBox[{"1", ",", "m", ",", 
              RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", 
            RowBox[{"-", "3.5"}], ",", "3.5"}], "}"}], ",", 
          RowBox[{"PlotStyle", "\[Rule]", 
           RowBox[{"Directive", "[", 
            RowBox[{"Black", ",", "Thin"}], "]"}]}], ",", 
          RowBox[{"Filling", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"1", "\[Rule]", 
              RowBox[{"{", "2", "}"}]}], ",", 
             RowBox[{"3", "\[Rule]", 
              RowBox[{"{", "2", "}"}]}]}], "}"}]}], ",", 
          RowBox[{"FillingStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"Black", ",", "White"}], "}"}]}], ",", 
          RowBox[{"AspectRatio", "\[Rule]", "1"}]}], "]"}], 
        "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"eqT", "[", "day_", "]"}], 
       RowBox[{"(*", 
        RowBox[{
        "equation", " ", "of", " ", "time", " ", "in", " ", "degree", " ", 
         "on", " ", "day", " ", "d", " ", "after", " ", "Jan", " ", "1"}], 
        "*)"}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"b", "=", 
           RowBox[{"2", "\[Pi]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"day", "-", "81"}], ")"}], "/", "365"}]}]}], "}"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"9.87", 
              RowBox[{"Sin", "[", 
               RowBox[{"2", " ", "b"}], "]"}]}], "-", 
             RowBox[{"7.53", 
              RowBox[{"Cos", "[", "b", "]"}]}], "-", 
             RowBox[{"1.5", 
              RowBox[{"Sin", "[", "b", "]"}]}]}], ")"}], "/", "60"}], "*", 
          "15"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"TCF", "[", 
        RowBox[{"day_", ",", "long_", ",", "tz_", ",", "dst_"}], "]"}], 
       RowBox[{"(*", 
        RowBox[{
        "time", " ", "correction", " ", "factor", " ", "in", " ", "minutes"}],
         "*)"}], ":=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "60"}], 
         RowBox[{"(", 
          RowBox[{"tz", "+", 
           RowBox[{"If", "[", 
            RowBox[{"dst", ",", "1", ",", "0"}], "]"}]}], ")"}]}], "+", 
        RowBox[{"4", "long"}], "+", 
        RowBox[{"4", 
         RowBox[{"eqT", "[", "day", "]"}]}]}]}]}], ")"}]}]}], "]"}]], "Input",
 CellChangeTimes->{
  3.542258069046875*^9, {3.542258165609375*^9, 3.542258174484375*^9}, {
   3.54225831803125*^9, 3.542258377328125*^9}, 3.542258473828125*^9, 
   3.5422685303125*^9, {3.5422685661875*^9, 3.54226859596875*^9}, {
   3.542268678953125*^9, 3.54226868321875*^9}, {3.5422688795*^9, 
   3.54226888246875*^9}, 3.542268984734375*^9, {3.542269171296875*^9, 
   3.54226923815625*^9}, {3.542269281234375*^9, 3.542269285734375*^9}, {
   3.542269348046875*^9, 3.54226937421875*^9}, {3.542269464875*^9, 
   3.54226946978125*^9}, {3.542269530296875*^9, 3.542269563*^9}, 
   3.542269676265625*^9, {3.542269775296875*^9, 3.542269805421875*^9}, {
   3.542270299515625*^9, 3.542270314796875*^9}, {3.542270359421875*^9, 
   3.5422703644375*^9}, {3.54227043821875*^9, 3.542270470578125*^9}, {
   3.54227071196875*^9, 3.542270717421875*^9}, {3.542270764703125*^9, 
   3.54227076809375*^9}, {3.542270818796875*^9, 3.542270878390625*^9}, {
   3.542271694765625*^9, 3.54227169909375*^9}, 3.54227182821875*^9, {
   3.542271883953125*^9, 3.542271914859375*^9}, {3.542271984859375*^9, 
   3.542272055921875*^9}, {3.54227210628125*^9, 3.54227216165625*^9}, {
   3.542272259234375*^9, 3.542272296484375*^9}, 3.542272715015625*^9, {
   3.542273321171875*^9, 3.5422733875*^9}, {3.542273713734375*^9, 
   3.542273720640625*^9}, {3.54227380984375*^9, 3.542273822375*^9}, 
   3.542273864484375*^9, {3.542273971078125*^9, 3.5422739985*^9}, {
   3.542274522984375*^9, 3.542274525140625*^9}, {3.542274594578125*^9, 
   3.542274617859375*^9}, {3.54227465440625*^9, 3.54227467659375*^9}, {
   3.54227480778125*^9, 3.54227480903125*^9}, 3.542274842296875*^9, {
   3.542274931140625*^9, 3.5422750085625*^9}, {3.54227504075*^9, 
   3.54227506553125*^9}, {3.542275106953125*^9, 3.542275183578125*^9}, {
   3.54227521975*^9, 3.542275239921875*^9}, {3.54227531646875*^9, 
   3.542275354796875*^9}, {3.542275452703125*^9, 3.542275483484375*^9}, {
   3.54229283125*^9, 3.54229283440625*^9}, {3.54229294575*^9, 
   3.54229296528125*^9}, {3.542293197421875*^9, 3.54229321196875*^9}, {
   3.542293264234375*^9, 3.5422933238125*^9}, 3.5422933545*^9, {
   3.542293396453125*^9, 3.54229345090625*^9}, {3.54229351009375*^9, 
   3.5422935150625*^9}, {3.542294785640625*^9, 3.5422947859375*^9}, {
   3.542294862796875*^9, 3.54229488321875*^9}, {3.54229494325*^9, 
   3.542295027203125*^9}, {3.542295078921875*^9, 3.5422950935*^9}, {
   3.542295127265625*^9, 3.542295128609375*^9}, 3.542295632515625*^9, 
   3.54229566428125*^9, {3.542295748625*^9, 3.54229576471875*^9}, {
   3.54229579534375*^9, 3.5422958693125*^9}, {3.542295978453125*^9, 
   3.54229597896875*^9}, {3.542296011453125*^9, 3.5422960251875*^9}, {
   3.542296111625*^9, 3.542296132921875*^9}, {3.5422961765625*^9, 
   3.54229618228125*^9}, {3.54229645940625*^9, 3.542296489859375*^9}, {
   3.54229668684375*^9, 3.542296691578125*^9}, 3.542296726609375*^9, {
   3.54229681903125*^9, 3.54229684859375*^9}, {3.542296902453125*^9, 
   3.542296936671875*^9}, {3.542297009265625*^9, 3.542297141390625*^9}, 
   3.54229724071875*^9, 3.5422972925625*^9, {3.54229735375*^9, 
   3.542297377921875*^9}, {3.5422980455625*^9, 3.542298053859375*^9}, {
   3.54229808590625*^9, 3.542298111578125*^9}, {3.54229822590625*^9, 
   3.5422982625625*^9}, {3.542298315578125*^9, 3.5422983964375*^9}, {
   3.54229843675*^9, 3.542298511046875*^9}, {3.542298660078125*^9, 
   3.5422986780625*^9}, {3.54229917465625*^9, 3.542299343140625*^9}, {
   3.542337375984375*^9, 3.5423374085625*^9}, 3.54233757084375*^9, {
   3.54233762915625*^9, 3.5423376356875*^9}, {3.54233776615625*^9, 
   3.5423379161875*^9}, {3.542337988890625*^9, 3.54233804078125*^9}, {
   3.5423380761875*^9, 3.5423381436875*^9}, {3.5423381854375*^9, 
   3.5423382910625*^9}, 3.54233833953125*^9, {3.542338380875*^9, 
   3.542338448953125*^9}, {3.542338557546875*^9, 3.542338569859375*^9}, {
   3.54233862053125*^9, 3.542338686125*^9}, {3.542338718375*^9, 
   3.542338735359375*^9}, {3.5423387775*^9, 3.54233883478125*^9}, {
   3.54233890975*^9, 3.5423389166875*^9}, {3.542339423890625*^9, 
   3.5423395315625*^9}, {3.54233959434375*^9, 3.542339628703125*^9}, {
   3.54233967625*^9, 3.54233969275*^9}, {3.542339767109375*^9, 
   3.5423397716875*^9}, {3.542339816328125*^9, 3.54233983215625*^9}, {
   3.54233987021875*^9, 3.542339966*^9}, {3.542340005140625*^9, 
   3.54234003596875*^9}, 3.542340074828125*^9, {3.542340187765625*^9, 
   3.542340195984375*^9}, 3.54234024859375*^9, {3.542340377125*^9, 
   3.54234042665625*^9}, {3.542340473859375*^9, 3.542340490390625*^9}, {
   3.542340745484375*^9, 3.54234077128125*^9}, {3.5423408066875*^9, 
   3.54234088653125*^9}, 3.542340969984375*^9, {3.542341085109375*^9, 
   3.542341100515625*^9}, 3.542341135203125*^9, {3.5423411934375*^9, 
   3.542341264875*^9}, {3.54234134*^9, 3.54234136565625*^9}, {
   3.54234145846875*^9, 3.54234159253125*^9}, {3.542341854640625*^9, 
   3.542341868859375*^9}, {3.542343654796875*^9, 3.542343662921875*^9}, {
   3.542343718171875*^9, 3.5423438256875*^9}, {3.542343897859375*^9, 
   3.54234408834375*^9}, {3.542344127921875*^9, 3.542344214984375*^9}, {
   3.54234426109375*^9, 3.542344323171875*^9}, 3.54234438746875*^9, {
   3.542344435171875*^9, 3.542344516578125*^9}, {3.542344602484375*^9, 
   3.542344625015625*^9}, 3.542344711765625*^9, {3.54234532303125*^9, 
   3.542345406515625*^9}, {3.54234586025*^9, 3.54234590846875*^9}, {
   3.5423460221875*^9, 3.542346033203125*^9}, {3.542346196921875*^9, 
   3.542346229703125*^9}, {3.542356645890625*^9, 3.542356707265625*^9}, 
   3.542356738078125*^9, {3.542356773515625*^9, 3.5423567983125*^9}, {
   3.542356832640625*^9, 3.54235694640625*^9}, {3.542356986859375*^9, 
   3.542357249234375*^9}, {3.54235745328125*^9, 3.54235755096875*^9}, {
   3.542357668109375*^9, 3.542357775746375*^9}, 3.5423578090650578`*^9, {
   3.542357874264657*^9, 3.542357874733494*^9}, {3.5423579475282516`*^9, 
   3.5423580665347104`*^9}, {3.5423581834782863`*^9, 
   3.5423582285335217`*^9}, {3.5423582614146233`*^9, 
   3.5423582642901573`*^9}, {3.5423583635429497`*^9, 
   3.5423583745293636`*^9}, {3.542358483190152*^9, 3.542358548577286*^9}, {
   3.542358588256524*^9, 3.542358618668418*^9}, 3.542358784885192*^9, {
   3.542358846347756*^9, 3.5423588717579083`*^9}, {3.542358914389456*^9, 
   3.5423589225469584`*^9}, {3.5423589808840427`*^9, 3.54235902081205*^9}, {
   3.542359074273385*^9, 3.5423590908384295`*^9}, {3.5423591429558077`*^9, 
   3.542359208168948*^9}, 3.542359249237756*^9, {3.5423592938227277`*^9, 
   3.542359328046734*^9}, {3.542359359114005*^9, 3.5423593826801243`*^9}, 
   3.54236367625277*^9, {3.5423637788068647`*^9, 3.542363780791379*^9}, {
   3.542363859625044*^9, 3.542363867781764*^9}, {3.542363900361765*^9, 
   3.542364028040994*^9}, {3.5423640749968233`*^9, 3.54236417059608*^9}, {
   3.5423642099264703`*^9, 3.542364231240198*^9}, {3.5423643276988783`*^9, 
   3.542364464394252*^9}, {3.5423644956773033`*^9, 3.5423645158972178`*^9}, {
   3.5423645500241833`*^9, 3.542364708064536*^9}, {3.5423647612863517`*^9, 
   3.542364761708251*^9}, {3.5423648104766846`*^9, 3.542364885168463*^9}, 
   3.542364945811805*^9, {3.542364995782793*^9, 3.542365018236924*^9}, {
   3.5423651025532017`*^9, 3.5423651027407103`*^9}, {3.5423651967605467`*^9, 
   3.5423652165739346`*^9}, 3.5423652539037313`*^9, {3.5423653007183285`*^9, 
   3.5423653093749666`*^9}, {3.542365349267379*^9, 3.5423653530800495`*^9}, {
   3.5423653884878855`*^9, 3.542365397910183*^9}, {3.542365463022475*^9, 
   3.542365471866621*^9}, {3.5423655201187825`*^9, 3.5423655234783077`*^9}, {
   3.542365597887892*^9, 3.542365647249478*^9}, {3.5423656857668285`*^9, 
   3.5423657135024457`*^9}, 3.542365803725238*^9, {3.5423659086518073`*^9, 
   3.5423659140582647`*^9}, {3.5423659691228795`*^9, 3.542365983014038*^9}, {
   3.542366031922166*^9, 3.5423660493134584`*^9}, {3.5423660858617373`*^9, 
   3.5423660997685213`*^9}, {3.5423661486141467`*^9, 3.542366225445222*^9}, {
   3.542366292119657*^9, 3.542366404483347*^9}, {3.5423664670638742`*^9, 
   3.5423665250348506`*^9}, {3.542367101774661*^9, 3.5423671058372917`*^9}, {
   3.542367198871518*^9, 3.542367241326002*^9}, 3.542367310875102*^9, {
   3.5423673591891484`*^9, 3.542367362970519*^9}, {3.5423675309758954`*^9, 
   3.5423675504452686`*^9}, 3.5423675920403495`*^9, {3.542367652417281*^9, 
   3.542367704340818*^9}, {3.5423678522361755`*^9, 3.5423678552362714`*^9}, {
   3.5423679821151686`*^9, 3.542367996896797*^9}, 3.542368245387533*^9, 
   3.542368371047*^9, 3.54236861130315*^9, {3.5423690015942607`*^9, 
   3.5423690208446302`*^9}, 3.54236912626853*^9, {3.542370927000331*^9, 
   3.542370938500478*^9}, {3.5423712394418297`*^9, 3.5423712409730997`*^9}, {
   3.542376603581683*^9, 3.542376640456919*^9}, {3.542380580451285*^9, 
   3.542380711701285*^9}, 3.54238078790441*^9, {3.542380886076285*^9, 
   3.54238095384191*^9}, 3.542381031045035*^9, {3.54238107231066*^9, 
   3.542381080763785*^9}, {3.542381151732535*^9, 3.542381182670035*^9}, 
   3.542381258138785*^9, {3.542381327638785*^9, 3.54238133771691*^9}, {
   3.54238139149816*^9, 3.54238143109191*^9}, {3.54238146787316*^9, 
   3.542381496138785*^9}, {3.54238168540441*^9, 3.542381693013785*^9}, {
   3.542381779388785*^9, 3.54238186252941*^9}, {3.54238190309191*^9, 
   3.54238193518566*^9}, {3.542382017826285*^9, 3.542382043170035*^9}, 
   3.542382111420035*^9, {3.542382173263785*^9, 3.542382230513785*^9}, {
   3.542382261982535*^9, 3.54238233884191*^9}, {3.542382376638785*^9, 
   3.542382421795035*^9}, 3.54238248118566*^9, {3.542382528451285*^9, 
   3.54238257084191*^9}, {3.54238263602941*^9, 3.542382662326285*^9}, {
   3.542382702326285*^9, 3.54238277431066*^9}, {3.542382812763785*^9, 
   3.542382835763785*^9}, {3.542382952732535*^9, 3.54238295871691*^9}, {
   3.542383140201285*^9, 3.54238314115441*^9}, 3.542383263951285*^9, {
   3.54238336618566*^9, 3.542383443107535*^9}, {3.542383474513785*^9, 
   3.54238351024816*^9}, {3.54238354796691*^9, 3.54238356734191*^9}, {
   3.54238361059191*^9, 3.54238364671691*^9}, {3.54238367881066*^9, 
   3.54238370012316*^9}, {3.542383757513785*^9, 3.542383783232535*^9}, {
   3.542383817951285*^9, 3.542383832857535*^9}, {3.542383864951285*^9, 
   3.542383878545035*^9}, {3.54238392193566*^9, 3.54238392637316*^9}, {
   3.54238397543566*^9, 3.542383979420035*^9}, {3.54238402918566*^9, 
   3.542384064326285*^9}, {3.54238435093566*^9, 3.542384404795035*^9}, {
   3.54238451956066*^9, 3.542384542482535*^9}, {3.542384575263785*^9, 
   3.542384636670035*^9}, {3.54238466877941*^9, 3.54238474927941*^9}, {
   3.54238478234191*^9, 3.54238489831066*^9}, {3.54238493140441*^9, 
   3.542384980451285*^9}, {3.542385059451285*^9, 3.54238505981066*^9}, {
   3.542385114107535*^9, 3.542385123326285*^9}, {3.54243268909375*^9, 
   3.542432757703125*^9}, 3.54244324359375*^9, {3.542443440703125*^9, 
   3.54244344390625*^9}, {3.542443539203125*^9, 3.5424435398125*^9}, {
   3.542443590328125*^9, 3.54244359996875*^9}, {3.542443635125*^9, 
   3.542443637109375*^9}, {3.54244377953125*^9, 3.5424438048125*^9}, {
   3.5424440086875*^9, 3.54244403915625*^9}, 3.54244409753125*^9, {
   3.542449663390625*^9, 3.5424496735625*^9}, {3.542449713546875*^9, 
   3.542449734296875*^9}, {3.542450105046875*^9, 3.5424501139375*^9}, {
   3.542450518109375*^9, 3.54245053171875*^9}, {3.54245065253125*^9, 
   3.542450673265625*^9}, {3.5424507115625*^9, 3.542450741109375*^9}, {
   3.542450847109375*^9, 3.54245087828125*^9}, 3.54245098115625*^9, {
   3.542451148625*^9, 3.542451176109375*^9}, {3.54245130690625*^9, 
   3.54245133496875*^9}, {3.542451400625*^9, 3.542451420375*^9}, 
   3.542451455078125*^9, 3.54245164884375*^9, {3.542451773484375*^9, 
   3.54245178221875*^9}, {3.5424520096875*^9, 3.5424520139375*^9}, {
   3.54245229015625*^9, 3.5424522905*^9}, {3.542452585453125*^9, 
   3.542452592078125*^9}, {3.542452748359375*^9, 3.542452777875*^9}, {
   3.542453098734375*^9, 3.542453125859375*^9}, {3.542453217625*^9, 
   3.542453219515625*^9}, {3.542453259734375*^9, 3.542453287875*^9}, {
   3.5424534285625*^9, 3.5424534475*^9}, {3.54245362853125*^9, 
   3.54245363209375*^9}, {3.542454252046875*^9, 3.542454276515625*^9}, {
   3.5424543286875*^9, 3.542454334953125*^9}, {3.54245438909375*^9, 
   3.54245443203125*^9}, 3.542454467828125*^9, 3.5424545501875*^9, {
   3.542457957609375*^9, 3.542457986046875*^9}, 3.542458018234375*^9, {
   3.5424581236875*^9, 3.542458135875*^9}, {3.54245816825*^9, 
   3.542458207140625*^9}, {3.542458239*^9, 3.54245829584375*^9}, {
   3.542459807515625*^9, 3.54245981425*^9}, {3.54245987603125*^9, 
   3.542459887984375*^9}, {3.542459935234375*^9, 3.542459935421875*^9}, {
   3.54245996703125*^9, 3.542460031234375*^9}, {3.542467154875*^9, 
   3.54246725175*^9}, {3.5424678115625*^9, 3.54246787721875*^9}, {
   3.542467918515625*^9, 3.54246794628125*^9}, 3.5424681459375*^9, {
   3.542468392578125*^9, 3.542468437375*^9}, {3.542468547640625*^9, 
   3.542468550390625*^9}, {3.542468582203125*^9, 3.542468600765625*^9}, {
   3.542468654140625*^9, 3.54246882796875*^9}, 3.5424688981875*^9, 
   3.542468976953125*^9, {3.542469238671875*^9, 3.542469286921875*^9}, {
   3.5424693231875*^9, 3.542469353421875*^9}, {3.542469401078125*^9, 
   3.5424694254375*^9}, {3.542469556453125*^9, 3.54246956003125*^9}, {
   3.54246974209375*^9, 3.542469747*^9}, 3.54246984565625*^9, {
   3.5424698990625*^9, 3.5424699063125*^9}, {3.542469976234375*^9, 
   3.54247007415625*^9}, {3.542470184890625*^9, 3.542470196578125*^9}, {
   3.542470365140625*^9, 3.542470389296875*^9}, {3.542470459984375*^9, 
   3.542470463875*^9}, 3.5424715709375*^9, {3.54247160275*^9, 
   3.54247160334375*^9}, 3.542471651984375*^9, {3.542471695953125*^9, 
   3.542471702328125*^9}, {3.54250951828125*^9, 3.542509519078125*^9}, {
   3.542509592*^9, 3.54250961115625*^9}, {3.542509769484375*^9, 
   3.54250981428125*^9}, {3.542509866171875*^9, 3.54250990353125*^9}, {
   3.542509933703125*^9, 3.54250993434375*^9}, 3.54251003028125*^9, {
   3.54251009309375*^9, 3.5425100968125*^9}, 3.542510129890625*^9, 
   3.542510215203125*^9, {3.54251026234375*^9, 3.54251034409375*^9}, {
   3.54251037515625*^9, 3.542510459203125*^9}, {3.54251052646875*^9, 
   3.542510553765625*^9}, {3.542510652625*^9, 3.542510684296875*^9}, {
   3.5425107269375*^9, 3.54251072721875*^9}, {3.542511281890625*^9, 
   3.54251128503125*^9}, {3.542511374390625*^9, 3.542511392609375*^9}, {
   3.542511485421875*^9, 3.542511536046875*^9}, {3.542511570390625*^9, 
   3.542511575375*^9}, {3.542511631*^9, 3.542511665859375*^9}, {
   3.54251174628125*^9, 3.542511843859375*^9}, {3.5425118870625*^9, 
   3.54251189040625*^9}, {3.5425122601875*^9, 3.5425123101875*^9}, 
   3.542512449953125*^9, 3.5425124871875*^9, {3.542512519171875*^9, 
   3.54251265678125*^9}, {3.542512738546875*^9, 3.542512772609375*^9}, {
   3.5425131454375*^9, 3.542513174171875*^9}, {3.5425132041875*^9, 
   3.542513225625*^9}, {3.542513266734375*^9, 3.542513292890625*^9}, {
   3.54251332525*^9, 3.54251339440625*^9}, {3.542513437109375*^9, 
   3.542513471125*^9}, {3.542513519640625*^9, 3.542513526875*^9}, {
   3.5425135835*^9, 3.542513584109375*^9}, 3.542513624296875*^9, 
   3.54251369875*^9, 3.54251445559375*^9, {3.54251453790625*^9, 
   3.54251453840625*^9}, {3.542514724796875*^9, 3.542514731390625*^9}, 
   3.54251486509375*^9, {3.54251491096875*^9, 3.5425150054375*^9}, 
   3.542515087703125*^9, {3.542515154578125*^9, 3.542515186921875*^9}, 
   3.5425153688125*^9, {3.542516067140625*^9, 3.542516092359375*^9}, {
   3.542520034703125*^9, 3.542520077578125*^9}, {3.542520134421875*^9, 
   3.542520138328125*^9}, {3.54252021121875*^9, 3.542520216734375*^9}, {
   3.542520267203125*^9, 3.5425202783125*^9}, {3.542520327109375*^9, 
   3.54252033178125*^9}, {3.542520379546875*^9, 3.54252038665625*^9}, {
   3.542520419609375*^9, 3.542520423828125*^9}, {3.542520467125*^9, 
   3.54252050196875*^9}, {3.54252055278125*^9, 3.54252057584375*^9}, {
   3.54252064065625*^9, 3.5425206428125*^9}, 3.542527955140625*^9, 
   3.542527986015625*^9, {3.542528025328125*^9, 3.542528035359375*^9}, {
   3.5425283055625*^9, 3.542528311453125*^9}, 3.5425285599375*^9, {
   3.542528703015625*^9, 3.542528727484375*^9}, {3.542528781765625*^9, 
   3.54252880515625*^9}, {3.54252887846875*^9, 3.54252888478125*^9}, 
   3.542528921359375*^9, {3.542529024703125*^9, 3.542529149640625*^9}, 
   3.542529237296875*^9, 3.54252932134375*^9, {3.54252940796875*^9, 
   3.542529532328125*^9}, {3.54252962715625*^9, 3.542529651734375*^9}, {
   3.54252990653125*^9, 3.54252993125*^9}, {3.542530042984375*^9, 
   3.54253004728125*^9}, {3.5425302031875*^9, 3.54253024459375*^9}, {
   3.5425302783125*^9, 3.5425304193125*^9}, {3.54253050984375*^9, 
   3.54253054175*^9}, {3.5425306008125*^9, 3.542530606453125*^9}, {
   3.542530681109375*^9, 3.54253072059375*^9}, {3.542530784859375*^9, 
   3.542530789140625*^9}, 3.542536262*^9, {3.542536293890625*^9, 
   3.542536295875*^9}, {3.5425363308125*^9, 3.5425363606875*^9}, {
   3.54253640540625*^9, 3.542536418234375*^9}, 3.542536968578125*^9, {
   3.5425371508125*^9, 3.542537167875*^9}, 3.542537237078125*^9, 
   3.5425373244375*^9, {3.542537400421875*^9, 3.542537405421875*^9}, {
   3.542537446203125*^9, 3.542537460421875*^9}, {3.542537511671875*^9, 
   3.542537516875*^9}, 3.542537550859375*^9, {3.542537638046875*^9, 
   3.5425376978125*^9}, {3.5425377371875*^9, 3.54253776309375*^9}, {
   3.542537821015625*^9, 3.542537827328125*^9}, {3.542537859859375*^9, 
   3.54253786553125*^9}, {3.542537902515625*^9, 3.542537918515625*^9}, {
   3.542537989953125*^9, 3.54253799809375*^9}, {3.542538079671875*^9, 
   3.54253808346875*^9}, {3.542538277296875*^9, 3.542538311078125*^9}, {
   3.54253835521875*^9, 3.542538517578125*^9}, 3.5425385644375*^9, {
   3.542539351234375*^9, 3.54253939846875*^9}, {3.542539440671875*^9, 
   3.542539509859375*^9}, {3.542539566125*^9, 3.54253967940625*^9}, {
   3.542543834640625*^9, 3.54254385225*^9}, {3.54254389709375*^9, 
   3.542543956265625*^9}, {3.542544003390625*^9, 3.5425440551875*^9}, {
   3.542544088875*^9, 3.54254409978125*^9}, {3.542544130875*^9, 
   3.542544132234375*^9}, {3.542544191828125*^9, 3.5425442018125*^9}, {
   3.542550772546875*^9, 3.542550782984375*^9}, {3.542551096859375*^9, 
   3.542551100828125*^9}, 3.54255124059375*^9, {3.5425522731875*^9, 
   3.542552358171875*^9}, 3.542552408109375*^9, {3.54255244065625*^9, 
   3.542552465328125*^9}, 3.5425525018125*^9, {3.542552544375*^9, 
   3.54255259478125*^9}, {3.542552636578125*^9, 3.54255265821875*^9}, {
   3.542552725890625*^9, 3.54255272678125*^9}, {3.542552772375*^9, 
   3.542552783234375*^9}, {3.54255283628125*^9, 3.54255283746875*^9}, 
   3.542552933984375*^9, {3.5425529885*^9, 3.542553042234375*^9}, {
   3.54255627225*^9, 3.54255627421875*^9}, {3.542556334984375*^9, 
   3.54255634790625*^9}, {3.54255637915625*^9, 3.542556379984375*^9}, {
   3.54255660925*^9, 3.54255661103125*^9}, {3.542556655109375*^9, 
   3.542556677875*^9}, {3.542556718*^9, 3.54255673021875*^9}, 
   3.542556899453125*^9, {3.54255693509375*^9, 3.54255693546875*^9}, 
   3.54255697546875*^9, {3.542557007*^9, 3.542557040859375*^9}, {
   3.54255707153125*^9, 3.542557079328125*^9}, {3.542557115625*^9, 
   3.542557135703125*^9}, {3.5425572020625*^9, 3.542557202703125*^9}, {
   3.542557273828125*^9, 3.542557275015625*^9}, {3.54255732371875*^9, 
   3.54255734021875*^9}, {3.542557372203125*^9, 3.542557403953125*^9}, {
   3.54255747646875*^9, 3.54255747915625*^9}, {3.542557621328125*^9, 
   3.542557624671875*^9}, {3.54255769009375*^9, 3.542557691703125*^9}, {
   3.54255777440625*^9, 3.542557874484375*^9}, {3.54255793496875*^9, 
   3.54255796859375*^9}, {3.5425580083125*^9, 3.54255807696875*^9}, {
   3.54255811375*^9, 3.542558122953125*^9}, 3.5425581560625*^9, 
   3.542558267734375*^9, 3.54255834440625*^9, {3.54255858609375*^9, 
   3.542558642703125*^9}, {3.542558691140625*^9, 3.54255871825*^9}, {
   3.54255880615625*^9, 3.54255884421875*^9}, {3.542558907671875*^9, 
   3.542558932328125*^9}, {3.542558983046875*^9, 3.54255898803125*^9}, {
   3.542559051640625*^9, 3.542559086375*^9}, 3.542559143640625*^9, {
   3.54255919653125*^9, 3.542559204515625*^9}, {3.542597207484375*^9, 
   3.542597256578125*^9}, {3.54259728690625*^9, 3.54259728834375*^9}, {
   3.542597383609375*^9, 3.54259742440625*^9}, {3.54259746528125*^9, 
   3.542597522953125*^9}, {3.542597591046875*^9, 3.54259760728125*^9}, {
   3.5425985155*^9, 3.54259854240625*^9}, {3.542598583390625*^9, 
   3.54259863265625*^9}, {3.54259868715625*^9, 3.54259870725*^9}, {
   3.54259883615625*^9, 3.542598837734375*^9}, {3.54259912471875*^9, 
   3.5425991785*^9}, 3.542599224359375*^9, 3.542599266171875*^9, {
   3.542599344015625*^9, 3.542599346671875*^9}, {3.5425995074375*^9, 
   3.542599559296875*^9}, {3.542599651671875*^9, 3.542599676890625*^9}, {
   3.542599747671875*^9, 3.54259976084375*^9}, {3.5425997946875*^9, 
   3.542599804859375*^9}, {3.542605557140625*^9, 3.542605587546875*^9}, {
   3.542605704890625*^9, 3.542605708453125*^9}, {3.54260584559375*^9, 
   3.54260584634375*^9}, {3.542605902609375*^9, 3.542605904015625*^9}, {
   3.54260616078125*^9, 3.542606225953125*^9}, {3.54260630125*^9, 
   3.54260633915625*^9}, {3.542606373453125*^9, 3.542606375421875*^9}, {
   3.5426064421875*^9, 3.54260645509375*^9}, {3.54260650921875*^9, 
   3.542606510375*^9}, {3.5426066601875*^9, 3.54260669640625*^9}, {
   3.542606733375*^9, 3.542606802515625*^9}, {3.542606885390625*^9, 
   3.542606910203125*^9}, {3.542606991078125*^9, 3.542607011015625*^9}, {
   3.54260705215625*^9, 3.54260705484375*^9}, {3.5426071168125*^9, 
   3.542607182671875*^9}, {3.542614299953125*^9, 3.542614382703125*^9}, {
   3.542614427375*^9, 3.542614438859375*^9}, 3.54261448965625*^9, {
   3.54261452715625*^9, 3.5426145600625*^9}, {3.542614765828125*^9, 
   3.54261476840625*^9}, {3.542614895796875*^9, 3.542614902859375*^9}, {
   3.542614937203125*^9, 3.54261493921875*^9}, {3.542614993890625*^9, 
   3.542615023578125*^9}, 3.542615948109375*^9, {3.54261603909375*^9, 
   3.54261613771875*^9}, {3.542616173890625*^9, 3.542616192203125*^9}, {
   3.542616222546875*^9, 3.54261633378125*^9}, {3.5426163648125*^9, 
   3.542616518546875*^9}, {3.5426165603125*^9, 3.542616580484375*^9}, {
   3.5426166609375*^9, 3.542616731296875*^9}, {3.542616778609375*^9, 
   3.542616901171875*^9}, {3.5426169499375*^9, 3.542616951828125*^9}, {
   3.542616993515625*^9, 3.542617039453125*^9}, 3.5426171115625*^9, {
   3.542617190578125*^9, 3.54261724125*^9}, {3.542617709*^9, 
   3.542617784421875*^9}, {3.542617820375*^9, 3.54261782103125*^9}, {
   3.54261786040625*^9, 3.542617871640625*^9}, {3.5426179159375*^9, 
   3.5426179184375*^9}, {3.542617975515625*^9, 3.542618085984375*^9}, {
   3.542618123515625*^9, 3.542618125921875*^9}, 3.542618255703125*^9, 
   3.542618686546875*^9, 3.5426189040625*^9, {3.542618938609375*^9, 
   3.542619050140625*^9}, 3.542619791375*^9, {3.542619824515625*^9, 
   3.542619824921875*^9}, 3.542619882421875*^9, 3.542619919453125*^9, 
   3.54261995346875*^9, 3.54262001959375*^9, 3.542620058421875*^9, 
   3.542620092859375*^9, {3.542620158328125*^9, 3.542620159046875*^9}, 
   3.542620242078125*^9, {3.542620283515625*^9, 3.54262028375*^9}, {
   3.54262032071875*^9, 3.542620344484375*^9}, {3.542620423859375*^9, 
   3.542620424125*^9}, 3.542620455578125*^9, 3.542620489875*^9, {
   3.542620520046875*^9, 3.542620548296875*^9}, 3.542626733890625*^9, {
   3.542626800203125*^9, 3.542626813484375*^9}, {3.54262798115625*^9, 
   3.542627984796875*^9}, {3.5426449438125*^9, 3.5426449489375*^9}, {
   3.5426450024375*^9, 3.542645030078125*^9}, 3.542690129078125*^9, {
   3.542690181171875*^9, 3.54269022278125*^9}, {3.5426902866875*^9, 
   3.542690289140625*^9}, {3.54270586253125*^9, 3.542705878234375*^9}, {
   3.54270592840625*^9, 3.5427059289375*^9}, {3.542710506953125*^9, 
   3.54271053196875*^9}, {3.54271063515625*^9, 3.54271074115625*^9}, {
   3.542710783171875*^9, 3.542710783828125*^9}, {3.542710829*^9, 
   3.542710850171875*^9}, 3.542710967125*^9, {3.542711036609375*^9, 
   3.542711042984375*^9}, {3.54271112003125*^9, 3.542711120703125*^9}, {
   3.54271116465625*^9, 3.5427112495*^9}, {3.542712389890625*^9, 
   3.542712399296875*^9}, {3.54271243540625*^9, 3.542712453828125*^9}, {
   3.542714049078125*^9, 3.54271405459375*^9}, {3.54271415128125*^9, 
   3.542714152*^9}, {3.542714195171875*^9, 3.542714210921875*^9}, 
   3.542714499828125*^9, {3.542775522203125*^9, 3.542775574484375*^9}, 
   3.5427756705625*^9, {3.54277578028125*^9, 3.542775817859375*^9}, {
   3.54277588775*^9, 3.542775946296875*^9}, 3.54277601825*^9, {
   3.542776050390625*^9, 3.54277612153125*^9}, {3.542776177296875*^9, 
   3.542776282734375*^9}, {3.54277632675*^9, 3.5427763274375*^9}, {
   3.5427781839375*^9, 3.542778220984375*^9}, {3.5427783215*^9, 
   3.54277835978125*^9}, {3.542778527765625*^9, 3.54277855425*^9}, {
   3.542779459875*^9, 3.542779491515625*^9}, {3.5427795384375*^9, 
   3.542779552078125*^9}, {3.54277961625*^9, 3.542779662234375*^9}, {
   3.542779728171875*^9, 3.54277976325*^9}, {3.54277980078125*^9, 
   3.542779804265625*^9}, {3.542789376234375*^9, 3.5427893836875*^9}, 
   3.54279372690625*^9, {3.542793767828125*^9, 3.54279382084375*^9}, 
   3.5427939643125*^9, {3.542793997421875*^9, 3.5427939979375*^9}, 
   3.542857975875*^9, 3.542858029625*^9, {3.54285806003125*^9, 
   3.54285808565625*^9}, {3.542858121828125*^9, 3.542858176109375*^9}, 
   3.54286196365625*^9, {3.54286202553125*^9, 3.542862026375*^9}, 
   3.54286234465625*^9, {3.542862379203125*^9, 3.542862380140625*^9}, 
   3.5428635131875*^9, {3.542866056625*^9, 3.54286610428125*^9}, {
   3.542866143*^9, 3.542866143828125*^9}, {3.542892704359375*^9, 
   3.54289273021875*^9}, {3.542892960796875*^9, 3.542892962234375*^9}, 
   3.542892993421875*^9, {3.54289303621875*^9, 3.542893106890625*^9}, 
   3.542893196125*^9, {3.542894027703125*^9, 3.54289407446875*^9}, {
   3.542894266125*^9, 3.54289429284375*^9}, {3.542894540234375*^9, 
   3.542894543578125*^9}, {3.54289581*^9, 3.54289581540625*^9}, {
   3.542897059296875*^9, 3.54289708021875*^9}, {3.542897141296875*^9, 
   3.542897199484375*^9}, 3.54289780096875*^9, 3.5428978631875*^9, 
   3.542897912921875*^9, 3.542897987515625*^9, {3.54289806003125*^9, 
   3.54289806471875*^9}, 3.54289810559375*^9, {3.5428981504375*^9, 
   3.5428981866875*^9}, {3.542898233375*^9, 3.542898238203125*^9}, {
   3.54289826890625*^9, 3.542898275828125*^9}, {3.54289837065625*^9, 
   3.542898378515625*^9}, {3.542898440859375*^9, 3.5428985238125*^9}, {
   3.5428985789375*^9, 3.542898613*^9}, 3.54289889853125*^9, {
   3.542898939796875*^9, 3.54289902009375*^9}, 3.542899061546875*^9, 
   3.542899101328125*^9, 3.54289915109375*^9, 3.5428992516875*^9, {
   3.54289953228125*^9, 3.542899536890625*^9}, 3.542899595*^9, 
   3.542899630328125*^9, {3.542899703875*^9, 3.542899705046875*^9}, 
   3.5428999505*^9, {3.54289998234375*^9, 3.542900007796875*^9}, {
   3.54294178021875*^9, 3.54294182275*^9}, {3.542941862265625*^9, 
   3.542941865640625*^9}, {3.54294191078125*^9, 3.542941997453125*^9}, 
   3.54294203203125*^9, 3.542942069109375*^9, 3.5429421038125*^9, 
   3.542942149375*^9, {3.542942641125*^9, 3.542942701484375*^9}, {
   3.54294309259375*^9, 3.542943092921875*^9}, {3.542943291328125*^9, 
   3.542943317953125*^9}, {3.542943374671875*^9, 3.542943394953125*^9}, {
   3.5429434253125*^9, 3.542943428828125*^9}, {3.542943658734375*^9, 
   3.542943706390625*^9}, {3.54294374571875*^9, 3.542943751015625*^9}, {
   3.542943802984375*^9, 3.542943846953125*^9}, 3.542944050296875*^9, {
   3.54294442453125*^9, 3.54294443359375*^9}, {3.5429461555625*^9, 
   3.54294616125*^9}, {3.54294624990625*^9, 3.54294637740625*^9}, {
   3.54294641190625*^9, 3.54294641546875*^9}, {3.54294649103125*^9, 
   3.54294649546875*^9}, 3.54294655228125*^9, {3.54294663015625*^9, 
   3.5429466625*^9}, {3.542946742703125*^9, 3.5429467438125*^9}, {
   3.542946887234375*^9, 3.542946895875*^9}, {3.54294692653125*^9, 
   3.54294696678125*^9}, {3.542947004109375*^9, 3.542947011265625*^9}, {
   3.54294911653125*^9, 3.54294913015625*^9}, {3.5429491803125*^9, 
   3.54294929275*^9}, {3.54294987475*^9, 3.542949879609375*^9}, {
   3.5429501171875*^9, 3.54295013575*^9}, {3.542950172953125*^9, 
   3.542950189046875*^9}, {3.54295023996875*^9, 3.54295026025*^9}, {
   3.542950347265625*^9, 3.542950408375*^9}, {3.542950444828125*^9, 
   3.542950534984375*^9}, {3.542950610234375*^9, 3.542950612640625*^9}, {
   3.542950684625*^9, 3.542950786296875*^9}, {3.542950836609375*^9, 
   3.542950846296875*^9}, {3.5429509019375*^9, 3.542950902875*^9}, {
   3.542950941703125*^9, 3.542951000578125*^9}, 3.542951158546875*^9, 
   3.542951195625*^9, {3.542951245*^9, 3.542951261328125*^9}, {3.542951298*^9,
    3.542951301078125*^9}, {3.542951429296875*^9, 3.542951469875*^9}, {
   3.5429515153125*^9, 3.54295154365625*^9}, {3.5429516721875*^9, 
   3.542951681171875*^9}, {3.5429596253125*^9, 3.542959636734375*^9}, 
   3.542959749421875*^9, {3.542959852484375*^9, 3.542959855984375*^9}, {
   3.542959903734375*^9, 3.542959908265625*^9}, {3.5429599685625*^9, 
   3.542960010546875*^9}, {3.542960054328125*^9, 3.5429600815*^9}, {
   3.542960289078125*^9, 3.542960319328125*^9}, {3.542960449890625*^9, 
   3.5429604814375*^9}, {3.5429605225*^9, 3.54296052578125*^9}, {
   3.542960569546875*^9, 3.542960614953125*^9}, {3.542960780046875*^9, 
   3.542960830875*^9}, {3.542960877109375*^9, 3.54296092871875*^9}, {
   3.54296103971875*^9, 3.542961081875*^9}, {3.5429611119375*^9, 
   3.542961115125*^9}, {3.5429611506875*^9, 3.54296118228125*^9}, {
   3.54296130575*^9, 3.542961381046875*^9}, 3.542961415421875*^9, {
   3.54296149521875*^9, 3.5429614961875*^9}, {3.542961562171875*^9, 
   3.542961611078125*^9}, {3.542961740171875*^9, 3.542961799296875*^9}, {
   3.542961829453125*^9, 3.5429618605*^9}, {3.542962170171875*^9, 
   3.54296217153125*^9}, {3.54296220271875*^9, 3.542962223859375*^9}, {
   3.54296226696875*^9, 3.5429622815*^9}, {3.542962366546875*^9, 
   3.542962374140625*^9}, 3.542962529088688*^9, {3.542962640963688*^9, 
   3.542962680541813*^9}, {3.542962732198063*^9, 3.542962742979313*^9}, {
   3.542962781510563*^9, 3.542962983979313*^9}, {3.542963146369938*^9, 
   3.542963170869938*^9}, {3.542963204260563*^9, 3.542963205166813*^9}, {
   3.542963251526188*^9, 3.542963296010563*^9}, {3.542963327526188*^9, 
   3.542963362682438*^9}, {3.542963495744938*^9, 3.542963499229313*^9}, {
   3.542963576573063*^9, 3.542963590151188*^9}, {3.542964369026188*^9, 
   3.542964373854313*^9}, {3.542965525119938*^9, 3.542965551979313*^9}, {
   3.542965771963688*^9, 3.542965773901188*^9}, {3.542965811651188*^9, 
   3.542965813323063*^9}, {3.542965871291813*^9, 3.542965942557438*^9}, {
   3.542966302213688*^9, 3.542966320588688*^9}, 3.542966374213688*^9, {
   3.542966559244938*^9, 3.542966593041813*^9}, 3.542966656963688*^9, {
   3.542973367401188*^9, 3.542973407838688*^9}, {3.542973464369938*^9, 
   3.542973468385563*^9}, {3.542973509604313*^9, 3.542973518994938*^9}, {
   3.542974801260563*^9, 3.542974808619938*^9}, 3.5430322924375*^9, 
   3.543032339140625*^9, {3.543032398984375*^9, 3.543032407546875*^9}, {
   3.543032446640625*^9, 3.543032446953125*^9}, {3.543032516359375*^9, 
   3.543032573140625*^9}, {3.5430326146875*^9, 3.54303265471875*^9}, {
   3.543033054609375*^9, 3.5430330603125*^9}, {3.543033090921875*^9, 
   3.543033116734375*^9}, {3.5430356405*^9, 3.543035653328125*^9}, {
   3.54303569009375*^9, 3.54303570746875*^9}, {3.543035746421875*^9, 
   3.54303575*^9}, {3.54303910953125*^9, 3.543039110078125*^9}, {
   3.543039147515625*^9, 3.5430391478125*^9}, {3.54304245671875*^9, 
   3.54304246565625*^9}, {3.543042530703125*^9, 3.543042540125*^9}, {
   3.543042596046875*^9, 3.543042600296875*^9}, {3.54304266259375*^9, 
   3.5430427034375*^9}, {3.543042750453125*^9, 3.543042757734375*^9}, 
   3.543042807875*^9, {3.5430428458125*^9, 3.543042855921875*^9}, {
   3.54304291525*^9, 3.543042932015625*^9}, {3.5430446204375*^9, 
   3.5430446565*^9}, {3.543044839421875*^9, 3.543044857328125*^9}, {
   3.543045062453125*^9, 3.543045089671875*^9}, {3.5430451331875*^9, 
   3.543045164078125*^9}, 3.54304521921875*^9, {3.5430455085*^9, 
   3.543045515359375*^9}, 3.543045620828125*^9, 3.543045698828125*^9, {
   3.5430479730625*^9, 3.543047984765625*^9}, {3.543048069765625*^9, 
   3.543048172609375*^9}, {3.543048288515625*^9, 3.54304833325*^9}, {
   3.5430483840625*^9, 3.54304838459375*^9}, {3.543048494703125*^9, 
   3.5430484955625*^9}, 3.543048552734375*^9, 3.543060978375*^9, 
   3.5430611285*^9, 3.54306116525*^9, 3.54306120409375*^9, 
   3.543061235890625*^9, {3.543061961390625*^9, 3.543061963078125*^9}, 
   3.54306199559375*^9, 3.54306205453125*^9, 3.5430621246875*^9, 
   3.5430621576875*^9, 3.54306233275*^9, {3.54306240871875*^9, 
   3.543062418921875*^9}, 3.5430624953125*^9, {3.54306263871875*^9, 
   3.543062700234375*^9}, 3.54307234296875*^9, {3.5430724361875*^9, 
   3.54307246778125*^9}, {3.5430725009375*^9, 3.543072597828125*^9}, {
   3.54307264684375*^9, 3.54307265425*^9}, {3.543072718546875*^9, 
   3.5430727780625*^9}, {3.54307283128125*^9, 3.543072972765625*^9}, {
   3.54307301575*^9, 3.543073054328125*^9}, {3.543073125953125*^9, 
   3.543073165203125*^9}, {3.543073205578125*^9, 3.54307334478125*^9}, 
   3.543073427625*^9, {3.543073476859375*^9, 3.543073520796875*^9}, {
   3.543114955625*^9, 3.543114983734375*^9}, {3.543115409328125*^9, 
   3.54311542203125*^9}, {3.543115457453125*^9, 3.543115491828125*^9}, {
   3.54313097775*^9, 3.54313099684375*^9}, {3.54313103190625*^9, 
   3.543131062359375*^9}, {3.543134538125*^9, 3.543134543234375*^9}, 
   3.54313461815625*^9, {3.54313739496875*^9, 3.543137462875*^9}, {
   3.543137709296875*^9, 3.54313771690625*^9}, {3.543137769953125*^9, 
   3.5431378126875*^9}, 3.5431378635625*^9, {3.54313790309375*^9, 
   3.543137928875*^9}, 3.543137966796875*^9, {3.54313800434375*^9, 
   3.54313803003125*^9}, 3.543138061*^9, 3.54313809534375*^9, {
   3.543138158109375*^9, 3.543138225734375*^9}, 3.543139993578125*^9, 
   3.5431400375*^9, {3.54314006990625*^9, 3.543140116640625*^9}, {
   3.543140153078125*^9, 3.54314018121875*^9}, {3.54314022240625*^9, 
   3.543140242296875*^9}, {3.543140610609375*^9, 3.543140673390625*^9}, {
   3.543141259546875*^9, 3.543141265109375*^9}, {3.543141650765625*^9, 
   3.543141729390625*^9}, 3.543141902203125*^9, 3.5431420043125*^9, 
   3.543142170921875*^9, {3.54314231196875*^9, 3.54314232528125*^9}, 
   3.54314237146875*^9, {3.5431433296875*^9, 3.543143346359375*^9}, {
   3.543143391609375*^9, 3.543143413078125*^9}, 3.543143513140625*^9, {
   3.54315694146875*^9, 3.543156948171875*^9}, {3.5431608833125*^9, 
   3.54316092078125*^9}, {3.543160954578125*^9, 3.54316097434375*^9}, {
   3.543161045765625*^9, 3.54316110690625*^9}, {3.543161170453125*^9, 
   3.543161182828125*^9}, {3.543161251296875*^9, 3.543161320140625*^9}, {
   3.5431613951875*^9, 3.543161426078125*^9}, {3.543161766390625*^9, 
   3.543161773265625*^9}, {3.5431618124375*^9, 3.54316183109375*^9}, {
   3.543161945*^9, 3.5431619483125*^9}, {3.54316203090625*^9, 
   3.543162033609375*^9}, {3.54316209053125*^9, 3.543162109234375*^9}, 
   3.54316219746875*^9, {3.543162343859375*^9, 3.543162347890625*^9}, {
   3.54316272915625*^9, 3.54316273090625*^9}, 3.543162768625*^9, {
   3.54320127046875*^9, 3.543201344546875*^9}, {3.54320138071875*^9, 
   3.543201402296875*^9}, {3.5432022678125*^9, 3.543202314625*^9}, 
   3.54320351115625*^9, 3.5432038133125*^9, {3.54320404753125*^9, 
   3.54320407359375*^9}, 3.54320413984375*^9, {3.543204290953125*^9, 
   3.543204293953125*^9}, {3.543204338609375*^9, 3.5432043485*^9}, {
   3.54320438240625*^9, 3.543204393203125*^9}, {3.54320442434375*^9, 
   3.543204454*^9}, {3.543204505296875*^9, 3.543204508125*^9}, {
   3.543204547625*^9, 3.543204560375*^9}, 3.543204622453125*^9, 
   3.54320467578125*^9, {3.543204805171875*^9, 3.543204811703125*^9}, {
   3.543205106734375*^9, 3.543205172484375*^9}, 3.543205456140625*^9, {
   3.5432061235*^9, 3.543206133984375*^9}, {3.543209205578125*^9, 
   3.543209221203125*^9}, {3.54320934175*^9, 3.543209345546875*^9}, 
   3.5432094079375*^9, {3.543209478796875*^9, 3.543209514875*^9}, {
   3.543209575640625*^9, 3.54320959671875*^9}, {3.54321083525*^9, 
   3.543210858328125*^9}, {3.5432196909375*^9, 3.54321971903125*^9}, {
   3.543219802078125*^9, 3.543219805265625*^9}, {3.543223089859375*^9, 
   3.543223170515625*^9}, {3.54322321865625*^9, 3.543223219796875*^9}, {
   3.543223257828125*^9, 3.54322328721875*^9}, {3.543224033671875*^9, 
   3.5432240365*^9}, 3.543224298890625*^9, {3.543224355578125*^9, 
   3.543224380984375*^9}, {3.543224781578125*^9, 3.543224849484375*^9}, {
   3.54322489915625*^9, 3.54322490209375*^9}, {3.543224999296875*^9, 
   3.543225077078125*^9}, {3.543225117984375*^9, 3.54322517725*^9}, {
   3.543225228125*^9, 3.543225255296875*^9}, {3.54322530715625*^9, 
   3.543225408859375*^9}, {3.543227197046875*^9, 3.543227232984375*^9}, {
   3.54322743984375*^9, 3.543227440546875*^9}, 3.54329805096875*^9, 
   3.543298124484375*^9, {3.543395696734375*^9, 3.543395698421875*^9}, {
   3.543395731796875*^9, 3.543395782875*^9}, 3.544273996210044*^9, {
   3.544384229050889*^9, 3.544384325112576*^9}, 3.563224273461176*^9, {
   3.5632243964714756`*^9, 3.5632244073305616`*^9}, 3.563224953653188*^9, {
   3.685251280580216*^9, 3.685251305906536*^9}, {3.685251917613179*^9, 
   3.6852519396829853`*^9}, {3.685252010666298*^9, 3.685252099011628*^9}, {
   3.685252366855137*^9, 3.6852524063783073`*^9}, {3.68525244406665*^9, 
   3.685252472979101*^9}, 3.6852528126898127`*^9, {3.685253006914816*^9, 
   3.685253017039351*^9}, {3.685264331412074*^9, 3.685264338633072*^9}, {
   3.685264482637807*^9, 3.6852644895554953`*^9}, {3.6852645869402027`*^9, 
   3.6852645872009697`*^9}, {3.685264673010008*^9, 3.685264689548581*^9}, {
   3.6852687805941763`*^9, 3.685268848307184*^9}, 3.685268934769084*^9, {
   3.68526899777094*^9, 3.685269000077086*^9}, {3.685269046752489*^9, 
   3.685269062979274*^9}, {3.685269378316165*^9, 3.685269409585981*^9}, {
   3.68526957626017*^9, 3.685269583201021*^9}, 3.685269623512651*^9, {
   3.685270094233192*^9, 3.685270100623296*^9}, {3.685270585837759*^9, 
   3.685270591237362*^9}, {3.6852707032057943`*^9, 3.685270703691066*^9}, {
   3.6852709520893517`*^9, 3.685270968483102*^9}, {3.6852710160085373`*^9, 
   3.685271017079731*^9}, 3.6852711127389174`*^9, {3.685271244679335*^9, 
   3.6852712461273212`*^9}, {3.6852713974619827`*^9, 
   3.6852714007675533`*^9}, {3.685271476354941*^9, 3.685271519995638*^9}, {
   3.685271577555542*^9, 3.6852715959087267`*^9}, {3.685271637024201*^9, 
   3.685271641276479*^9}, {3.685333582557452*^9, 3.6853335867832727`*^9}, {
   3.685346860209957*^9, 3.685346865070798*^9}, {3.68534702085286*^9, 
   3.685347063595203*^9}, {3.715966978724676*^9, 3.7159670098224545`*^9}, 
   3.715967970917426*^9, 3.7159682650162477`*^9, {3.715968341064597*^9, 
   3.7159683415476246`*^9}}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`date$$ = 0, $CellContext`pd$$ = Dynamic[
     Quiet[
      DateDifference[{$CellContext`thisYear$$, 1, 1}, 
       DateList[]]]], $CellContext`pt$$ = 
    16.416666666666668`, $CellContext`thisYear$$ = 2017, $CellContext`time$$ =
     0, $CellContext`\[Phi]$$ = 51 Degree, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {
    "\"New Moon\"" :> {$CellContext`date$$ = 11.5, $CellContext`pd$$ = 
       96, $CellContext`pt$$ = 10, $CellContext`time$$ = 
       19, $CellContext`\[Phi]$$ = 5 Degree}, 
     "\"Full Moon\"" :> {$CellContext`date$$ = 27.75, $CellContext`pd$$ = 
       96, $CellContext`pt$$ = 10, $CellContext`time$$ = 
       19.9, $CellContext`\[Phi]$$ = 34 Degree}}, Typeset`bookmarkMode$$ = 
    "Menu", Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`pd$$], 
       Dynamic[
        Quiet[
         DateDifference[{$CellContext`thisYear$$, 1, 1}, 
          DateList[]]]]}}, {{
       Hold[$CellContext`pt$$], 16.416666666666668`}}, {
      Hold["observer's latitude"], Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`\[Phi]$$], 51 Degree, ""}, (-90) Degree, 90 Degree, 
      Degree}, {
      Hold["city"], Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`\[Phi]$$], 51 Degree, ""}, {
      61 Degree -> "Anchorage", (-37) Degree -> "Auckland", 14 Degree -> 
       "Bangkok", 40 Degree -> "Beijing", 5 Degree -> "Bogota", 19 Degree -> 
       "Bombay", 51 Degree -> "Brussels", (-35) Degree -> "BuenosAires", 
       30 Degree -> "Cairo", (-34) Degree -> "CapeTown", 
       Rational[67, 2] Degree -> "Casablanca", Rational[209, 5] Degree -> 
       "Chicago", Rational[1, 100] Degree -> "Equator", 22 Degree -> 
       "HongKong", 41 Degree -> "Istanbul", (-6) Degree -> 
       "Jakarta", (-4) Degree -> "Kinshasa", (-12) Degree -> "Lima", 
       52 Degree -> "London", 34 Degree -> "LosAngeles", 15 Degree -> 
       "Manila", 26 Degree -> "Miami", 46 Degree -> "Montreal", 56 Degree -> 
       "Moscow", -Degree -> "Nairobi", Rational[423, 10] Degree -> "NewYork", 
       90 Degree -> "North Pole", 49 Degree -> "Paris", 
       Rational[419, 10] Degree -> "Rome", 60 Degree -> "SaintPetersburg", 
       38 Degree -> "San Francisco", (-33) Degree -> "Santiago", (-24) Degree -> 
       "SaoPaulo", 31 Degree -> "Shanghai", Degree -> 
       "Singapore", (-90) Degree -> "South Pole", Rational[-169, 5] Degree -> 
       "Sydney", 36 Degree -> "Tokyo"}}, {
      Hold["date"], Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`date$$], 0, ""}, 0, 1460, 1}, {
      Hold[
       Row[{
         Manipulate`Place[1], 
         Spacer[4], 
         Dynamic[
          DateString[
           DatePlus[{$CellContext`thisYear$$, 1, 1}, $CellContext`date$$], {
           "Day", " ", "MonthNameShort", " ", "YearShort"}]]}]], 
      Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`date$$], 0, ""}, {
      80.5 -> "Mar 21", 172 -> "Jun 21", 265 -> "Sep 22", 355 -> "Dec 21"}}, {
      Hold["apparent solar time"], Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`time$$], 0, ""}, 0, 24, 0.016666666666666666`}, {
      Hold[
       Row[{
         Manipulate`Place[2], 
         Spacer[4], 
         Dynamic[
          DateString[{$CellContext`thisYear$$, 1, 1, 
            Mod[$CellContext`time$$, 12]}, {"Hour", ":", "Minute"}]]}]], 
      Manipulate`Dump`ThisIsNotAControl}, {
      Hold[
       Button[
       "at your location now", $CellContext`\[Phi]$$ = 
         First[Round[Part[$GeoLocation, 1] 10] (Degree/
            10.)]; $CellContext`date$$ = Part[
           DateDifference[{$CellContext`thisYear$$, 1, 1}, 
            DateList[]], 1]; $CellContext`time$$ = Mod[First[Part[
                DateList[], 4] 60 + Part[
               DateList[], 5] + $CellContext`TCF[
               Part[
                DateDifference[$CellContext`thisYear$$, 
                 DateList[]], 1], 
               Part[$GeoLocation, 1], $TimeZone, False]]/60, 24], ImageSize -> 
        155]], Manipulate`Dump`ThisIsNotAControl}, {
      Hold[$CellContext`thisYear$$], 2017}}, Typeset`size$$ = {
    400., {198., 202.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = False, $CellContext`\[Phi]$52305$$ = 
    0, $CellContext`date$52306$$ = 0, $CellContext`time$52307$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     2, StandardForm, 
      "Variables" :> {$CellContext`date$$ = 0, $CellContext`pd$$ = Dynamic[
          Quiet[
           DateDifference[{$CellContext`thisYear$$, 1, 1}, 
            DateList[]]]], $CellContext`pt$$ = 
        16.416666666666668`, $CellContext`thisYear$$ = 
        2017, $CellContext`time$$ = 0, $CellContext`\[Phi]$$ = 51 Degree}, 
      "ControllerVariables" :> {
        Hold[$CellContext`\[Phi]$$, $CellContext`\[Phi]$52305$$, 0], 
        Hold[$CellContext`date$$, $CellContext`date$52306$$, 0], 
        Hold[$CellContext`time$$, $CellContext`time$52307$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> Quiet[
        Module[{$CellContext`\[Epsilon]$ = 
          23.45 Degree, $CellContext`d$, $CellContext`m$, $CellContext`t$, \
$CellContext`sp$, $CellContext`mp$, $CellContext`ep$}, 
         If[$CellContext`\[Phi]$$ == 0, $CellContext`\[Phi]$$ = 
           0.001]; $CellContext`thisYear$$ = First[
            DateList[Today]]; $CellContext`d$ = 2 Pi ((Mod[
               
               If[$CellContext`\[Phi]$$ >= 
                0, $CellContext`date$$, $CellContext`date$$ - 182.5], 365] + 
             10)/365); $CellContext`m$ = (-12.36) 2 
            Pi (($CellContext`date$$ + 10)/365) + 
           0.7; $CellContext`t$ = (Pi/12) (30 - $CellContext`time$$ + 
            If[$CellContext`\[Phi]$$ >= 0, 0, 12]); $CellContext`sp$ = 
          2 Sec[$CellContext`\[Epsilon]$] ((-Cos[$CellContext`d$]) 
             Tan[$CellContext`\[Epsilon]$] + 
            Sqrt[1 - Sin[$CellContext`d$]^2 
              Tan[$CellContext`\[Epsilon]$]^2]) {-Cos[$CellContext`t$], -
             Sin[$CellContext`t$]}; $CellContext`mp$ = 
          2 Sec[$CellContext`\[Epsilon]$] ((-
              Cos[$CellContext`d$ - $CellContext`m$]) 
             Tan[$CellContext`\[Epsilon]$] + 
            Sqrt[1 - Sin[$CellContext`d$ - $CellContext`m$]^2 
              Tan[$CellContext`\[Epsilon]$]^2]) {-
             Cos[$CellContext`t$ - $CellContext`m$], -
             Sin[$CellContext`t$ - $CellContext`m$]}; $CellContext`ep$ = 
          2 Tan[$CellContext`\[Epsilon]$] {
             Cos[$CellContext`d$ - $CellContext`t$], -
             Sin[$CellContext`d$ - $CellContext`t$]}; Graphics[{{Gray, 
             Line[{{-3, 0}, {3, 0}}], 
             Line[{{0, -3}, {0, 3}}]}, {Gray, 
             If[$CellContext`\[Phi]$$ >= 0, 
              
              Disk[{0, -Cot[(Pi + 10 $CellContext`\[Phi]$$)/20] - 
                Tan[(Pi - 10 $CellContext`\[Phi]$$)/20]}, 
               Abs[
               Cot[(Pi + 10 $CellContext`\[Phi]$$)/20] - 
                Tan[(Pi - 10 $CellContext`\[Phi]$$)/20]]], 
              
              Disk[{0, Cot[(Pi - 10 $CellContext`\[Phi]$$)/20] + 
                Tan[(Pi + 10 $CellContext`\[Phi]$$)/20]}, 
               Abs[
               Cot[(Pi - 10 $CellContext`\[Phi]$$)/20] - 
                Tan[(Pi + 10 $CellContext`\[Phi]$$)/20]]]]}, {
             Lighter[Red, 0.75], 
             Table[
              If[$CellContext`\[Phi]$$ >= 0, 
               
               Circle[{
                0, (-Cos[$CellContext`\[Phi]$$]) 
                 Csc[($CellContext`\[Alpha] + $CellContext`\[Phi]$$)/2] 
                 Sec[($CellContext`\[Alpha] - $CellContext`\[Phi]$$)/2]}, 
                Abs[
                Cos[$CellContext`\[Alpha]] 
                 Csc[($CellContext`\[Alpha] + $CellContext`\[Phi]$$)/2] 
                 Sec[($CellContext`\[Alpha] - $CellContext`\[Phi]$$)/2]]], 
               
               Circle[{
                0, Cos[$CellContext`\[Phi]$$] 
                 Csc[($CellContext`\[Alpha] - $CellContext`\[Phi]$$)/2] 
                 Sec[($CellContext`\[Alpha] + $CellContext`\[Phi]$$)/2]}, 
                Abs[
                Cos[$CellContext`\[Alpha]] 
                 Csc[($CellContext`\[Alpha] - $CellContext`\[Phi]$$)/2] 
                 Sec[($CellContext`\[Alpha] + $CellContext`\[Phi]$$)/
                   2]]]], {$CellContext`\[Alpha], (-89.999) Degree, 90 Degree,
                9. Degree}]}, {{
              Lighter[Gray, 0.5], 
              Opacity[0.5], 
              
              Disk[{0, -Cot[$CellContext`\[Phi]$$/2] + 
                Tan[$CellContext`\[Phi]$$/2]}, 2 Abs[
                 Csc[$CellContext`\[Phi]$$]]]}, 
             Directive[Red, 
              AbsoluteThickness[3]], 
             
             Circle[{0, -Cot[$CellContext`\[Phi]$$/2] + 
               Tan[$CellContext`\[Phi]$$/2]}, 2 Abs[
                Csc[$CellContext`\[Phi]$$]]]}, {Red, 
             AbsoluteThickness[2], 
             Circle[
              
              If[$CellContext`\[Phi]$$ >= 0, {
               0, (-2) Cot[(Pi + 2 $CellContext`\[Phi]$$)/4]}, {
               0, 2 Tan[(Pi + 2 $CellContext`\[Phi]$$)/4]}], 0.05]}, {Gray, 
             Circle[{0, 0}, 2]}, {Gray, Dashed, 
             
             Circle[{0, 0}, 
              2 (Cos[$CellContext`\[Epsilon]$]/(1 + 
               Sin[$CellContext`\[Epsilon]$]))]}, {
             AbsoluteThickness[5], Black, 
             
             Circle[{0, 0}, 
              2 (Cos[$CellContext`\[Epsilon]$]/(1 - 
               Sin[$CellContext`\[Epsilon]$]))]}, 
            Text[
             Style["Tempus Fugit", 15, Italic, Bold], {0, -2.5}], {
             AbsoluteThickness[3], Blue, 
             Map[
             Circle[$CellContext`ep$, # Sec[$CellContext`\[Epsilon]$]]& , {
              1.95, 1.68}], 
             AbsoluteThickness[2], 
             Line[1.6 {{
                 Sin[$CellContext`d$ - $CellContext`t$], 
                 Cos[$CellContext`d$ - $CellContext`t$]}, {-
                 Sin[$CellContext`d$ - $CellContext`t$], -
                 Cos[$CellContext`d$ - $CellContext`t$]}}], 
             Line[{0.97 {-Cos[$CellContext`d$ - $CellContext`t$], 
                 Sin[$CellContext`d$ - $CellContext`t$]}, 2.7 {
                 Cos[$CellContext`d$ - $CellContext`t$], -
                 Sin[$CellContext`d$ - $CellContext`t$]}}], 
             Map[Line, 
              Transpose[
               Table[
                Part[{
                  
                  Map[((-2) Cos[# + 0.35] Tan[$CellContext`\[Epsilon]$] + 
                    Sqrt[$CellContext`i^2 Sec[$CellContext`\[Epsilon]$]^2 - 4 
                    Sin[# + 0.35]^2 Tan[$CellContext`\[Epsilon]$]^2]) {-
                    Cos[# + 0.35 + $CellContext`d$ - $CellContext`t$], 
                    Sin[# + 0.35 + $CellContext`d$ - $CellContext`t$]}& , 
                   Range[Pi/6, 2 Pi, Pi/6]]}, 1], {$CellContext`i, {1.95, 
                 1.68}}]]]}, {Purple, 
             AbsolutePointSize[7], 
             Point[$CellContext`ep$], 
             AbsoluteThickness[1], 
             Line[{$CellContext`ep$, $CellContext`sp$}], 
             Line[{$CellContext`ep$, $CellContext`mp$}]}, $CellContext`dial, {
             AbsoluteThickness[3], 
             Arrow[{0.35 {
                 Cos[$CellContext`t$], 
                 Sin[$CellContext`t$]}, (-3.45) {
                 Cos[$CellContext`t$], 
                 Sin[$CellContext`t$]}}]}, {Yellow, 
             Disk[$CellContext`sp$, 0.195], Red, 
             Circle[$CellContext`sp$, 0.198]}, {
             AbsoluteThickness[2], Gray, 
             Line[{0.35 {
                 Cos[$CellContext`t$ - $CellContext`m$], 
                 Sin[$CellContext`t$ - $CellContext`m$]}, (-3.2) {
                 Cos[$CellContext`t$ - $CellContext`m$], 
                 Sin[$CellContext`t$ - $CellContext`m$]}}]}, 
            $CellContext`moon[
             Rescale[
              MoonPhase[
               DatePlus[{
                 First[
                  DateList[Today]], 0, 0}, $CellContext`date$$]], {0, 1}, {-1,
               1}], $CellContext`mp$, 0.185], {
             Disk[{0, 0}, 0.1]}}, PlotRange -> 4.1, ImageSize -> 400]]], 
      "Specifications" :> {{{$CellContext`pd$$, 
          Dynamic[
           Quiet[
            DateDifference[{$CellContext`thisYear$$, 1, 1}, 
             DateList[]]]]}, ControlType -> 
         None}, {{$CellContext`pt$$, 16.416666666666668`}, ControlType -> 
         None}, "observer's latitude", {{$CellContext`\[Phi]$$, 51 Degree, 
          ""}, (-90) Degree, 90 Degree, Degree, ImageSize -> Tiny, Appearance -> 
         "Labeled", 
         AppearanceElements -> {
          "InputField", "StepLeftButton", "PlayPauseButton", 
           "StepRightButton"}}, 
        "city", {{$CellContext`\[Phi]$$, 51 Degree, ""}, {
         61 Degree -> "Anchorage", (-37) Degree -> "Auckland", 14 Degree -> 
          "Bangkok", 40 Degree -> "Beijing", 5 Degree -> "Bogota", 19 Degree -> 
          "Bombay", 51 Degree -> "Brussels", (-35) Degree -> "BuenosAires", 
          30 Degree -> "Cairo", (-34) Degree -> "CapeTown", 
          Rational[67, 2] Degree -> "Casablanca", Rational[209, 5] Degree -> 
          "Chicago", Rational[1, 100] Degree -> "Equator", 22 Degree -> 
          "HongKong", 41 Degree -> "Istanbul", (-6) Degree -> 
          "Jakarta", (-4) Degree -> "Kinshasa", (-12) Degree -> "Lima", 
          52 Degree -> "London", 34 Degree -> "LosAngeles", 15 Degree -> 
          "Manila", 26 Degree -> "Miami", 46 Degree -> "Montreal", 56 Degree -> 
          "Moscow", -Degree -> "Nairobi", Rational[423, 10] Degree -> 
          "NewYork", 90 Degree -> "North Pole", 49 Degree -> "Paris", 
          Rational[419, 10] Degree -> "Rome", 60 Degree -> "SaintPetersburg", 
          38 Degree -> "San Francisco", (-33) Degree -> 
          "Santiago", (-24) Degree -> "SaoPaulo", 31 Degree -> "Shanghai", 
          Degree -> "Singapore", (-90) Degree -> "South Pole", 
          Rational[-169, 5] Degree -> "Sydney", 36 Degree -> "Tokyo"}}, 
        Delimiter, 
        "date", {{$CellContext`date$$, 0, ""}, 0, 1460, 1, ImageSize -> Tiny, 
         AppearanceElements -> {
          "InputField", "StepLeftButton", "PlayPauseButton", 
           "StepRightButton", "FasterSlowerButtons"}, ControlPlacement -> 1}, 
        Row[{
          Manipulate`Place[1], 
          Spacer[4], 
          Dynamic[
           DateString[
            DatePlus[{$CellContext`thisYear$$, 1, 1}, $CellContext`date$$], {
            "Day", " ", "MonthNameShort", " ", 
             "YearShort"}]]}], {{$CellContext`date$$, 0, ""}, {
         80.5 -> "Mar 21", 172 -> "Jun 21", 265 -> "Sep 22", 355 -> 
          "Dec 21"}}, Delimiter, 
        "apparent solar time", {{$CellContext`time$$, 0, ""}, 0, 24, 
         0.016666666666666666`, ImageSize -> Tiny, 
         AppearanceElements -> {
          "InputField", "StepLeftButton", "PlayPauseButton", 
           "StepRightButton", "FasterSlowerButtons"}, ControlPlacement -> 2}, 
        Row[{
          Manipulate`Place[2], 
          Spacer[4], 
          Dynamic[
           DateString[{$CellContext`thisYear$$, 1, 1, 
             Mod[$CellContext`time$$, 12]}, {"Hour", ":", "Minute"}]]}], 
        Delimiter, 
        Button[
        "at your location now", $CellContext`\[Phi]$$ = 
          First[Round[Part[$GeoLocation, 1] 10] (Degree/
             10.)]; $CellContext`date$$ = Part[
            DateDifference[{$CellContext`thisYear$$, 1, 1}, 
             DateList[]], 1]; $CellContext`time$$ = Mod[First[Part[
                 DateList[], 4] 60 + Part[
                DateList[], 5] + $CellContext`TCF[
                Part[
                 DateDifference[$CellContext`thisYear$$, 
                  DateList[]], 1], 
                Part[$GeoLocation, 1], $TimeZone, False]]/60, 24], ImageSize -> 
         155], {$CellContext`thisYear$$, 2017, ControlType -> None}, 
        Delimiter}, 
      "Options" :> {
       ControlPlacement -> Left, 
        TrackedSymbols :> {$CellContext`pd$$, $CellContext`pt$$, \
$CellContext`\[Phi]$$, $CellContext`date$$, $CellContext`time$$, \
$CellContext`thisYear$$}, SynchronousUpdating -> True, 
        AutorunSequencing -> {3, 4, 5, 6, 7}}, 
      "DefaultOptions" :> {ControllerLinking -> True}],
     ImageSizeCache->{610., {225., 232.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    Initialization:>(($CellContext`latitudes = {
        61 Degree -> "Anchorage", (-37) Degree -> "Auckland", 14 Degree -> 
         "Bangkok", 40 Degree -> "Beijing", 5 Degree -> "Bogota", 19 Degree -> 
         "Bombay", 51 Degree -> "Brussels", (-35) Degree -> "BuenosAires", 
         30 Degree -> "Cairo", (-34) Degree -> "CapeTown", (335/10) Degree -> 
         "Casablanca", (418/10) Degree -> "Chicago", (1/100) Degree -> 
         "Equator", 22 Degree -> "HongKong", 41 Degree -> 
         "Istanbul", (-6) Degree -> "Jakarta", (-4) Degree -> 
         "Kinshasa", (-12) Degree -> "Lima", 52 Degree -> "London", 34 Degree -> 
         "LosAngeles", 15 Degree -> "Manila", 26 Degree -> "Miami", 46 Degree -> 
         "Montreal", 56 Degree -> "Moscow", -Degree -> 
         "Nairobi", (423/10) Degree -> "NewYork", 90 Degree -> "North Pole", 
         49 Degree -> "Paris", (419/10) Degree -> "Rome", 60 Degree -> 
         "SaintPetersburg", 38 Degree -> "San Francisco", (-33) Degree -> 
         "Santiago", (-24) Degree -> "SaoPaulo", 31 Degree -> "Shanghai", 
         Degree -> "Singapore", (-90) Degree -> 
         "South Pole", ((-338)/10) Degree -> "Sydney", 36 Degree -> 
         "Tokyo"}; $CellContext`dial = {{
          Map[{
            GrayLevel[1 - #^2], Thick, 
            Circle[{0, 0}, 3.1 + #]}& , 
           Range[0, 1.05, 0.025]]}, {Gray, Thick, 
          Map[Circle[{0, 0}, 4.05 + #]& , 
           Range[0, 1.74, 0.025]]}, {Thick, 
          Map[Line[{3.1 {
               Sin[#], -Cos[#]}, 3.2 {
               Sin[#], -Cos[#]}}]& , 
           Range[0, 2 Pi, Pi/12]]}, {
          Map[Text[
            Style[
             IntegerString[
              If[
               Or[# == 0, # == 12], 12, 
               Mod[#, 12]], "Roman"], 14, Bold], 3.5 {
              Sin[(#/12) Pi], 
              Cos[(#/12) Pi]}]& , 
           Range[0, 23]]}, {
          Map[{White, 
            Text[
             Style[
              Part[#, 1], 12, Bold, Italic], 3.85 {
               Sin[
                Part[#, 2]], -Cos[
                 Part[#, 2]]}]}& , {{"N", 0}, {"W", Pi/2}, {"S", Pi}, {
            "E", 3 (Pi/2)}}]}}; $CellContext`moon[
         Pattern[$CellContext`m, 
          Blank[]], {
          Pattern[$CellContext`x0, 
           Blank[]], 
          Pattern[$CellContext`y0, 
           Blank[]]}, 
         Pattern[$CellContext`r, 
          Blank[]]] := Part[
         Plot[
          Evaluate[
           
           Map[$CellContext`y0 - # 
            Sqrt[$CellContext`r^2 - ($CellContext`x0 - $CellContext`x)^2]& , {
            1, $CellContext`m, -1}]], {$CellContext`x, -3.5, 3.5}, PlotStyle -> 
          Directive[Black, Thin], Filling -> {1 -> {2}, 3 -> {2}}, 
          FillingStyle -> {Black, White}, AspectRatio -> 1], 
         1]; $CellContext`eqT[
         Pattern[$CellContext`day, 
          Blank[]]] := 
       Module[{$CellContext`b = 
          2 Pi (($CellContext`day - 81)/365)}, ((9.87 Sin[2 $CellContext`b] - 
           7.53 Cos[$CellContext`b] - 1.5 Sin[$CellContext`b])/60) 
         15]; $CellContext`TCF[
         Pattern[$CellContext`day, 
          Blank[]], 
         Pattern[$CellContext`long, 
          Blank[]], 
         Pattern[$CellContext`tz, 
          Blank[]], 
         Pattern[$CellContext`dst, 
          Blank[]]] := (-60) ($CellContext`tz + If[$CellContext`dst, 1, 0]) + 
        4 $CellContext`long + 4 $CellContext`eqT[$CellContext`day]); 
     Typeset`initDone$$ = True),
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellID->199510402]
}, {2}]]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "ManipulateCaptionSection"],

Cell["\<\
This Demonstration illustrates the working of an astronomical clock.\
\>", "ManipulateCaption",
 CellChangeTimes->{{3.543117258171875*^9, 3.543117261125*^9}, 
   3.5442406430059624`*^9, 3.5442726353659735`*^9},
 CellID->11173229],

Cell["\<\
To visualize the movement of the Sun and Moon on the celestial sphere, \
astronomical clocks use stereographic projection. The Earth's projection is \
at the center of the clock, surrounded by the concentric circles of the \
Equator and the tropics. The blue ring is the projection of the ecliptic with \
the Sun and the Moon. The ecliptic ring is divided into sectors defining the \
four seasons and the 12 months of the year. The red circle is the projection \
of the horizon dividing the celestial sphere into day and night.\
\>", "ManipulateCaption",
 CellChangeTimes->{{3.542703049109375*^9, 3.54270318759375*^9}, {
   3.542703460640625*^9, 3.542703524796875*^9}, {3.542964484932438*^9, 
   3.542964531401188*^9}, 3.542964616479313*^9, {3.542983093182438*^9, 
   3.542983103635563*^9}, {3.542983207151188*^9, 3.542983221526188*^9}, {
   3.542983255744938*^9, 3.542983352401188*^9}, {3.542983482776188*^9, 
   3.542983492963688*^9}, 3.542983531276188*^9, {3.542983588776188*^9, 
   3.542983596713688*^9}, {3.542983728510563*^9, 3.542983767666813*^9}, {
   3.543029698671875*^9, 3.543029753890625*^9}, {3.543029807453125*^9, 
   3.543029913171875*^9}, {3.5430300040625*^9, 3.543030004515625*^9}, {
   3.543030459140625*^9, 3.543030745765625*^9}, {3.543030804546875*^9, 
   3.543030989046875*^9}, {3.54303119925*^9, 3.54303123053125*^9}, 
   3.543045980859375*^9, {3.543073616359375*^9, 3.543073619421875*^9}, {
   3.543073741453125*^9, 3.54307376725*^9}, {3.543117439203125*^9, 
   3.543117449203125*^9}, {3.54311748615625*^9, 3.543117487953125*^9}, {
   3.543117549203125*^9, 3.54311759246875*^9}, {3.543132742359375*^9, 
   3.54313278878125*^9}, {3.5431329150625*^9, 3.543132982671875*^9}, {
   3.54313310934375*^9, 3.54313312515625*^9}, {3.543405142046875*^9, 
   3.543405181109375*^9}, {3.5442407504122124`*^9, 3.5442407532090874`*^9}, {
   3.544382427066243*^9, 3.544382437738635*^9}, {3.544382499485837*^9, 
   3.544382526461143*^9}, {3.544534237184518*^9, 3.544534253582038*^9}},
 CellID->114066697],

Cell["\<\
Change the date to show the position of the Sun and the position and phase of \
the Moon for that day. Change the time to move the ecliptic to its \
corresponding position around the Earth. Setting the observer's latitude \
moves the horizon and defines the times when the Sun and Moon will rise or \
set.\
\>", "ManipulateCaption",
 CellChangeTimes->{{3.542703049109375*^9, 3.54270318759375*^9}, {
   3.542703460640625*^9, 3.542703524796875*^9}, {3.542964484932438*^9, 
   3.542964531401188*^9}, 3.542964616479313*^9, {3.542983093182438*^9, 
   3.542983103635563*^9}, {3.542983207151188*^9, 3.542983221526188*^9}, {
   3.542983255744938*^9, 3.542983352401188*^9}, {3.542983482776188*^9, 
   3.542983492963688*^9}, 3.542983531276188*^9, {3.542983588776188*^9, 
   3.542983596713688*^9}, {3.542983728510563*^9, 3.542983767666813*^9}, {
   3.543029698671875*^9, 3.543029753890625*^9}, {3.543029807453125*^9, 
   3.543029913171875*^9}, {3.5430300040625*^9, 3.543030004515625*^9}, {
   3.543030459140625*^9, 3.543030745765625*^9}, {3.543030804546875*^9, 
   3.543030890828125*^9}, {3.543031018625*^9, 3.543031080609375*^9}, {
   3.543031155859375*^9, 3.54303117290625*^9}, {3.543046032015625*^9, 
   3.543046059671875*^9}, {3.543046098125*^9, 3.543046116625*^9}, {
   3.543046194328125*^9, 3.543046256203125*^9}, {3.543073641390625*^9, 
   3.543073685765625*^9}, {3.543073812953125*^9, 3.5430738710625*^9}, {
   3.543117407453125*^9, 3.543117418046875*^9}, {3.54313283084375*^9, 
   3.54313284203125*^9}, 3.543132949265625*^9, {3.543132997828125*^9, 
   3.543133030484375*^9}, {3.5434053535625*^9, 3.543405355203125*^9}, {
   3.5442397191153374`*^9, 3.5442397234434624`*^9}, {3.544382462059623*^9, 
   3.544382495053056*^9}, {3.544382537315867*^9, 3.5443825829074163`*^9}, 
   3.544384297322007*^9, 3.544384340680539*^9},
 CellID->169231355]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "ThumbnailSection"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`date$$ = 
    104.73382649739584`, $CellContext`pd$$ = 
    102.63668565538194`, $CellContext`pt$$ = 
    15.266666666666667`, $CellContext`thisYear$$ = 2017, $CellContext`time$$ =
     15.812846738848076`, $CellContext`\[Phi]$$ = 34 Degree, Typeset`show$$ = 
    True, Typeset`bookmarkList$$ = {
    "\"New Moon\"" :> {$CellContext`date$$ = 11.5, $CellContext`pd$$ = 
       96, $CellContext`pt$$ = 10, $CellContext`time$$ = 
       19, $CellContext`\[Phi]$$ = 5 Degree}, 
     "\"Full Moon\"" :> {$CellContext`date$$ = 27.75, $CellContext`pd$$ = 
       96, $CellContext`pt$$ = 10, $CellContext`time$$ = 
       19.9, $CellContext`\[Phi]$$ = 34 Degree}}, Typeset`bookmarkMode$$ = 
    "Menu", Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`pd$$], 102.63668565538194`}}, {{
       Hold[$CellContext`pt$$], 15.266666666666667`}}, {
      Hold["observer's latitude"], Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`\[Phi]$$], 34 Degree, ""}, (-90) Degree, 90 Degree, 
      Degree}, {
      Hold["city"], Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`\[Phi]$$], 34 Degree, ""}, {
      61 Degree -> "Anchorage", (-37) Degree -> "Auckland", 14 Degree -> 
       "Bangkok", 40 Degree -> "Beijing", 5 Degree -> "Bogota", 19 Degree -> 
       "Bombay", 51 Degree -> "Brussels", (-35) Degree -> "BuenosAires", 
       30 Degree -> "Cairo", (-34) Degree -> "CapeTown", 
       Rational[67, 2] Degree -> "Casablanca", Rational[209, 5] Degree -> 
       "Chicago", Rational[1, 100] Degree -> "Equator", 22 Degree -> 
       "HongKong", 41 Degree -> "Istanbul", (-6) Degree -> 
       "Jakarta", (-4) Degree -> "Kinshasa", (-12) Degree -> "Lima", 
       52 Degree -> "London", 34 Degree -> "LosAngeles", 15 Degree -> 
       "Manila", 26 Degree -> "Miami", 46 Degree -> "Montreal", 56 Degree -> 
       "Moscow", -Degree -> "Nairobi", Rational[423, 10] Degree -> "NewYork", 
       90 Degree -> "North Pole", 49 Degree -> "Paris", 
       Rational[419, 10] Degree -> "Rome", 60 Degree -> "SaintPetersburg", 
       38 Degree -> "San Francisco", (-33) Degree -> "Santiago", (-24) Degree -> 
       "SaoPaulo", 31 Degree -> "Shanghai", Degree -> 
       "Singapore", (-90) Degree -> "South Pole", Rational[-169, 5] Degree -> 
       "Sydney", 36 Degree -> "Tokyo"}}, {
      Hold["date"], Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`date$$], 104.73382649739584`, ""}, 0, 1460, 1}, {
      Hold[
       Row[{
         Manipulate`Place[1], 
         Spacer[4], 
         Dynamic[
          DateString[
           DatePlus[{$CellContext`thisYear$$, 1, 1}, $CellContext`date$$], {
           "Day", " ", "MonthNameShort", " ", "YearShort"}]]}]], 
      Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`date$$], 104.73382649739584`, ""}, {
      80.5 -> "Mar 21", 172 -> "Jun 21", 265 -> "Sep 22", 355 -> "Dec 21"}}, {
      Hold["apparent solar time"], Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`time$$], 15.812846738848076`, ""}, 0, 24, 
      0.016666666666666666`}, {
      Hold[
       Row[{
         Manipulate`Place[2], 
         Spacer[4], 
         Dynamic[
          DateString[{$CellContext`thisYear$$, 1, 1, 
            Mod[$CellContext`time$$, 12]}, {"Hour", ":", "Minute"}]]}]], 
      Manipulate`Dump`ThisIsNotAControl}, {
      Hold[
       Button[
       "at your location now", $CellContext`\[Phi]$$ = 
         First[Round[Part[$GeoLocation, 1] 10] (Degree/
            10.)]; $CellContext`date$$ = Part[
           DateDifference[{$CellContext`thisYear$$, 1, 1}, 
            DateList[]], 1]; $CellContext`time$$ = Mod[First[Part[
                DateList[], 4] 60 + Part[
               DateList[], 5] + $CellContext`TCF[
               Part[
                DateDifference[$CellContext`thisYear$$, 
                 DateList[]], 1], 
               Part[$GeoLocation, 1], $TimeZone, False]]/60, 24], ImageSize -> 
        155]], Manipulate`Dump`ThisIsNotAControl}, {
      Hold[$CellContext`thisYear$$], 2017}}, Typeset`size$$ = {
    400., {198., 202.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = False, $CellContext`\[Phi]$52376$$ = 
    0, $CellContext`date$52377$$ = 0, $CellContext`time$52378$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     2, StandardForm, 
      "Variables" :> {$CellContext`date$$ = 
        104.73382649739584`, $CellContext`pd$$ = 
        102.63668565538194`, $CellContext`pt$$ = 
        15.266666666666667`, $CellContext`thisYear$$ = 
        2017, $CellContext`time$$ = 
        15.812846738848076`, $CellContext`\[Phi]$$ = 34 Degree}, 
      "ControllerVariables" :> {
        Hold[$CellContext`\[Phi]$$, $CellContext`\[Phi]$52376$$, 0], 
        Hold[$CellContext`date$$, $CellContext`date$52377$$, 0], 
        Hold[$CellContext`time$$, $CellContext`time$52378$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> Quiet[
        Module[{$CellContext`\[Epsilon]$ = 
          23.45 Degree, $CellContext`d$, $CellContext`m$, $CellContext`t$, \
$CellContext`sp$, $CellContext`mp$, $CellContext`ep$}, 
         If[$CellContext`\[Phi]$$ == 0, $CellContext`\[Phi]$$ = 
           0.001]; $CellContext`thisYear$$ = First[
            DateList[Today]]; $CellContext`d$ = 2 Pi ((Mod[
               
               If[$CellContext`\[Phi]$$ >= 
                0, $CellContext`date$$, $CellContext`date$$ - 182.5], 365] + 
             10)/365); $CellContext`m$ = (-12.36) 2 
            Pi (($CellContext`date$$ + 10)/365) + 
           0.7; $CellContext`t$ = (Pi/12) (30 - $CellContext`time$$ + 
            If[$CellContext`\[Phi]$$ >= 0, 0, 12]); $CellContext`sp$ = 
          2 Sec[$CellContext`\[Epsilon]$] ((-Cos[$CellContext`d$]) 
             Tan[$CellContext`\[Epsilon]$] + 
            Sqrt[
             1 - Sin[$CellContext`d$]^2 Tan[$CellContext`\[Epsilon]$]^2]) {-
             Cos[$CellContext`t$], -Sin[$CellContext`t$]}; $CellContext`mp$ = 
          2 Sec[$CellContext`\[Epsilon]$] ((-
              Cos[$CellContext`d$ - $CellContext`m$]) 
             Tan[$CellContext`\[Epsilon]$] + 
            Sqrt[1 - Sin[$CellContext`d$ - $CellContext`m$]^2 
              Tan[$CellContext`\[Epsilon]$]^2]) {-
             Cos[$CellContext`t$ - $CellContext`m$], -
             Sin[$CellContext`t$ - $CellContext`m$]}; $CellContext`ep$ = 
          2 Tan[$CellContext`\[Epsilon]$] {
             Cos[$CellContext`d$ - $CellContext`t$], -
             Sin[$CellContext`d$ - $CellContext`t$]}; Graphics[{{Gray, 
             Line[{{-3, 0}, {3, 0}}], 
             Line[{{0, -3}, {0, 3}}]}, {Gray, 
             If[$CellContext`\[Phi]$$ >= 0, 
              
              Disk[{0, -Cot[(Pi + 10 $CellContext`\[Phi]$$)/20] - 
                Tan[(Pi - 10 $CellContext`\[Phi]$$)/20]}, 
               Abs[
               Cot[(Pi + 10 $CellContext`\[Phi]$$)/20] - 
                Tan[(Pi - 10 $CellContext`\[Phi]$$)/20]]], 
              
              Disk[{0, Cot[(Pi - 10 $CellContext`\[Phi]$$)/20] + 
                Tan[(Pi + 10 $CellContext`\[Phi]$$)/20]}, 
               Abs[
               Cot[(Pi - 10 $CellContext`\[Phi]$$)/20] - 
                Tan[(Pi + 10 $CellContext`\[Phi]$$)/20]]]]}, {
             Lighter[Red, 0.75], 
             Table[
              If[$CellContext`\[Phi]$$ >= 0, 
               
               Circle[{
                0, (-Cos[$CellContext`\[Phi]$$]) 
                 Csc[($CellContext`\[Alpha] + $CellContext`\[Phi]$$)/2] 
                 Sec[($CellContext`\[Alpha] - $CellContext`\[Phi]$$)/2]}, 
                Abs[
                Cos[$CellContext`\[Alpha]] 
                 Csc[($CellContext`\[Alpha] + $CellContext`\[Phi]$$)/2] 
                 Sec[($CellContext`\[Alpha] - $CellContext`\[Phi]$$)/2]]], 
               
               Circle[{
                0, Cos[$CellContext`\[Phi]$$] 
                 Csc[($CellContext`\[Alpha] - $CellContext`\[Phi]$$)/2] 
                 Sec[($CellContext`\[Alpha] + $CellContext`\[Phi]$$)/2]}, 
                Abs[
                Cos[$CellContext`\[Alpha]] 
                 Csc[($CellContext`\[Alpha] - $CellContext`\[Phi]$$)/2] 
                 Sec[($CellContext`\[Alpha] + $CellContext`\[Phi]$$)/
                   2]]]], {$CellContext`\[Alpha], (-89.999) Degree, 90 Degree,
                9. Degree}]}, {{
              Lighter[Gray, 0.5], 
              Opacity[0.5], 
              
              Disk[{0, -Cot[$CellContext`\[Phi]$$/2] + 
                Tan[$CellContext`\[Phi]$$/2]}, 2 Abs[
                 Csc[$CellContext`\[Phi]$$]]]}, 
             Directive[Red, 
              AbsoluteThickness[3]], 
             
             Circle[{0, -Cot[$CellContext`\[Phi]$$/2] + 
               Tan[$CellContext`\[Phi]$$/2]}, 2 Abs[
                Csc[$CellContext`\[Phi]$$]]]}, {Red, 
             AbsoluteThickness[2], 
             Circle[
              
              If[$CellContext`\[Phi]$$ >= 0, {
               0, (-2) Cot[(Pi + 2 $CellContext`\[Phi]$$)/4]}, {
               0, 2 Tan[(Pi + 2 $CellContext`\[Phi]$$)/4]}], 0.05]}, {Gray, 
             Circle[{0, 0}, 2]}, {Gray, Dashed, 
             
             Circle[{0, 0}, 
              2 (Cos[$CellContext`\[Epsilon]$]/(1 + 
               Sin[$CellContext`\[Epsilon]$]))]}, {
             AbsoluteThickness[5], Black, 
             
             Circle[{0, 0}, 
              2 (Cos[$CellContext`\[Epsilon]$]/(1 - 
               Sin[$CellContext`\[Epsilon]$]))]}, 
            Text[
             Style["Tempus Fugit", 15, Italic, Bold], {0, -2.5}], {
             AbsoluteThickness[3], Blue, 
             Map[
             Circle[$CellContext`ep$, # Sec[$CellContext`\[Epsilon]$]]& , {
              1.95, 1.68}], 
             AbsoluteThickness[2], 
             Line[1.6 {{
                 Sin[$CellContext`d$ - $CellContext`t$], 
                 Cos[$CellContext`d$ - $CellContext`t$]}, {-
                 Sin[$CellContext`d$ - $CellContext`t$], -
                 Cos[$CellContext`d$ - $CellContext`t$]}}], 
             Line[{0.97 {-Cos[$CellContext`d$ - $CellContext`t$], 
                 Sin[$CellContext`d$ - $CellContext`t$]}, 2.7 {
                 Cos[$CellContext`d$ - $CellContext`t$], -
                 Sin[$CellContext`d$ - $CellContext`t$]}}], 
             Map[Line, 
              Transpose[
               Table[
                Part[{
                  
                  Map[((-2) Cos[# + 0.35] Tan[$CellContext`\[Epsilon]$] + 
                    Sqrt[$CellContext`i^2 Sec[$CellContext`\[Epsilon]$]^2 - 4 
                    Sin[# + 0.35]^2 Tan[$CellContext`\[Epsilon]$]^2]) {-
                    Cos[# + 0.35 + $CellContext`d$ - $CellContext`t$], 
                    Sin[# + 0.35 + $CellContext`d$ - $CellContext`t$]}& , 
                   Range[Pi/6, 2 Pi, Pi/6]]}, 1], {$CellContext`i, {1.95, 
                 1.68}}]]]}, {Purple, 
             AbsolutePointSize[7], 
             Point[$CellContext`ep$], 
             AbsoluteThickness[1], 
             Line[{$CellContext`ep$, $CellContext`sp$}], 
             Line[{$CellContext`ep$, $CellContext`mp$}]}, $CellContext`dial, {
             AbsoluteThickness[3], 
             Arrow[{0.35 {
                 Cos[$CellContext`t$], 
                 Sin[$CellContext`t$]}, (-3.45) {
                 Cos[$CellContext`t$], 
                 Sin[$CellContext`t$]}}]}, {Yellow, 
             Disk[$CellContext`sp$, 0.195], Red, 
             Circle[$CellContext`sp$, 0.198]}, {
             AbsoluteThickness[2], Gray, 
             Line[{0.35 {
                 Cos[$CellContext`t$ - $CellContext`m$], 
                 Sin[$CellContext`t$ - $CellContext`m$]}, (-3.2) {
                 Cos[$CellContext`t$ - $CellContext`m$], 
                 Sin[$CellContext`t$ - $CellContext`m$]}}]}, 
            $CellContext`moon[
             Rescale[
              MoonPhase[
               DatePlus[{
                 First[
                  DateList[Today]], 0, 0}, $CellContext`date$$]], {0, 1}, {-1,
               1}], $CellContext`mp$, 0.185], {
             Disk[{0, 0}, 0.1]}}, PlotRange -> 4.1, ImageSize -> 400]]], 
      "Specifications" :> {{{$CellContext`pd$$, 102.63668565538194`}, 
         ControlType -> None}, {{$CellContext`pt$$, 15.266666666666667`}, 
         ControlType -> None}, 
        "observer's latitude", {{$CellContext`\[Phi]$$, 34 Degree, ""}, (-90) 
         Degree, 90 Degree, Degree, ImageSize -> Tiny, Appearance -> 
         "Labeled", 
         AppearanceElements -> {
          "InputField", "StepLeftButton", "PlayPauseButton", 
           "StepRightButton"}}, 
        "city", {{$CellContext`\[Phi]$$, 34 Degree, ""}, {
         61 Degree -> "Anchorage", (-37) Degree -> "Auckland", 14 Degree -> 
          "Bangkok", 40 Degree -> "Beijing", 5 Degree -> "Bogota", 19 Degree -> 
          "Bombay", 51 Degree -> "Brussels", (-35) Degree -> "BuenosAires", 
          30 Degree -> "Cairo", (-34) Degree -> "CapeTown", 
          Rational[67, 2] Degree -> "Casablanca", Rational[209, 5] Degree -> 
          "Chicago", Rational[1, 100] Degree -> "Equator", 22 Degree -> 
          "HongKong", 41 Degree -> "Istanbul", (-6) Degree -> 
          "Jakarta", (-4) Degree -> "Kinshasa", (-12) Degree -> "Lima", 
          52 Degree -> "London", 34 Degree -> "LosAngeles", 15 Degree -> 
          "Manila", 26 Degree -> "Miami", 46 Degree -> "Montreal", 56 Degree -> 
          "Moscow", -Degree -> "Nairobi", Rational[423, 10] Degree -> 
          "NewYork", 90 Degree -> "North Pole", 49 Degree -> "Paris", 
          Rational[419, 10] Degree -> "Rome", 60 Degree -> "SaintPetersburg", 
          38 Degree -> "San Francisco", (-33) Degree -> 
          "Santiago", (-24) Degree -> "SaoPaulo", 31 Degree -> "Shanghai", 
          Degree -> "Singapore", (-90) Degree -> "South Pole", 
          Rational[-169, 5] Degree -> "Sydney", 36 Degree -> "Tokyo"}}, 
        Delimiter, 
        "date", {{$CellContext`date$$, 104.73382649739584`, ""}, 0, 1460, 1, 
         ImageSize -> Tiny, 
         AppearanceElements -> {
          "InputField", "StepLeftButton", "PlayPauseButton", 
           "StepRightButton", "FasterSlowerButtons"}, ControlPlacement -> 1}, 
        Row[{
          Manipulate`Place[1], 
          Spacer[4], 
          Dynamic[
           DateString[
            DatePlus[{$CellContext`thisYear$$, 1, 1}, $CellContext`date$$], {
            "Day", " ", "MonthNameShort", " ", 
             "YearShort"}]]}], {{$CellContext`date$$, 104.73382649739584`, 
          ""}, {80.5 -> "Mar 21", 172 -> "Jun 21", 265 -> "Sep 22", 355 -> 
          "Dec 21"}}, Delimiter, 
        "apparent solar time", {{$CellContext`time$$, 15.812846738848076`, 
          ""}, 0, 24, 0.016666666666666666`, ImageSize -> Tiny, 
         AppearanceElements -> {
          "InputField", "StepLeftButton", "PlayPauseButton", 
           "StepRightButton", "FasterSlowerButtons"}, ControlPlacement -> 2}, 
        Row[{
          Manipulate`Place[2], 
          Spacer[4], 
          Dynamic[
           DateString[{$CellContext`thisYear$$, 1, 1, 
             Mod[$CellContext`time$$, 12]}, {"Hour", ":", "Minute"}]]}], 
        Delimiter, 
        Button[
        "at your location now", $CellContext`\[Phi]$$ = 
          First[Round[Part[$GeoLocation, 1] 10] (Degree/
             10.)]; $CellContext`date$$ = Part[
            DateDifference[{$CellContext`thisYear$$, 1, 1}, 
             DateList[]], 1]; $CellContext`time$$ = Mod[First[Part[
                 DateList[], 4] 60 + Part[
                DateList[], 5] + $CellContext`TCF[
                Part[
                 DateDifference[$CellContext`thisYear$$, 
                  DateList[]], 1], 
                Part[$GeoLocation, 1], $TimeZone, False]]/60, 24], ImageSize -> 
         155], {$CellContext`thisYear$$, 2017, ControlType -> None}, 
        Delimiter}, 
      "Options" :> {
       ControlPlacement -> Left, 
        TrackedSymbols :> {$CellContext`pd$$, $CellContext`pt$$, \
$CellContext`\[Phi]$$, $CellContext`date$$, $CellContext`time$$, \
$CellContext`thisYear$$}, SynchronousUpdating -> True, 
        AutorunSequencing -> {3, 4, 5, 6, 7}}, 
      "DefaultOptions" :> {ControllerLinking -> True}],
     ImageSizeCache->{610., {225., 232.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    Initialization:>(($CellContext`latitudes = {
        61 Degree -> "Anchorage", (-37) Degree -> "Auckland", 14 Degree -> 
         "Bangkok", 40 Degree -> "Beijing", 5 Degree -> "Bogota", 19 Degree -> 
         "Bombay", 51 Degree -> "Brussels", (-35) Degree -> "BuenosAires", 
         30 Degree -> "Cairo", (-34) Degree -> "CapeTown", (335/10) Degree -> 
         "Casablanca", (418/10) Degree -> "Chicago", (1/100) Degree -> 
         "Equator", 22 Degree -> "HongKong", 41 Degree -> 
         "Istanbul", (-6) Degree -> "Jakarta", (-4) Degree -> 
         "Kinshasa", (-12) Degree -> "Lima", 52 Degree -> "London", 34 Degree -> 
         "LosAngeles", 15 Degree -> "Manila", 26 Degree -> "Miami", 46 Degree -> 
         "Montreal", 56 Degree -> "Moscow", -Degree -> 
         "Nairobi", (423/10) Degree -> "NewYork", 90 Degree -> "North Pole", 
         49 Degree -> "Paris", (419/10) Degree -> "Rome", 60 Degree -> 
         "SaintPetersburg", 38 Degree -> "San Francisco", (-33) Degree -> 
         "Santiago", (-24) Degree -> "SaoPaulo", 31 Degree -> "Shanghai", 
         Degree -> "Singapore", (-90) Degree -> 
         "South Pole", ((-338)/10) Degree -> "Sydney", 36 Degree -> 
         "Tokyo"}; $CellContext`dial = {{
          Map[{
            GrayLevel[1 - #^2], Thick, 
            Circle[{0, 0}, 3.1 + #]}& , 
           Range[0, 1.05, 0.025]]}, {Gray, Thick, 
          Map[Circle[{0, 0}, 4.05 + #]& , 
           Range[0, 1.74, 0.025]]}, {Thick, 
          Map[Line[{3.1 {
               Sin[#], -Cos[#]}, 3.2 {
               Sin[#], -Cos[#]}}]& , 
           Range[0, 2 Pi, Pi/12]]}, {
          Map[Text[
            Style[
             IntegerString[
              If[
               Or[# == 0, # == 12], 12, 
               Mod[#, 12]], "Roman"], 14, Bold], 3.5 {
              Sin[(#/12) Pi], 
              Cos[(#/12) Pi]}]& , 
           Range[0, 23]]}, {
          Map[{White, 
            Text[
             Style[
              Part[#, 1], 12, Bold, Italic], 3.85 {
               Sin[
                Part[#, 2]], -Cos[
                 Part[#, 2]]}]}& , {{"N", 0}, {"W", Pi/2}, {"S", Pi}, {
            "E", 3 (Pi/2)}}]}}; $CellContext`moon[
         Pattern[$CellContext`m, 
          Blank[]], {
          Pattern[$CellContext`x0, 
           Blank[]], 
          Pattern[$CellContext`y0, 
           Blank[]]}, 
         Pattern[$CellContext`r, 
          Blank[]]] := Part[
         Plot[
          Evaluate[
           
           Map[$CellContext`y0 - # 
            Sqrt[$CellContext`r^2 - ($CellContext`x0 - $CellContext`x)^2]& , {
            1, $CellContext`m, -1}]], {$CellContext`x, -3.5, 3.5}, PlotStyle -> 
          Directive[Black, Thin], Filling -> {1 -> {2}, 3 -> {2}}, 
          FillingStyle -> {Black, White}, AspectRatio -> 1], 
         1]; $CellContext`eqT[
         Pattern[$CellContext`day, 
          Blank[]]] := 
       Module[{$CellContext`b = 
          2 Pi (($CellContext`day - 81)/365)}, ((9.87 Sin[2 $CellContext`b] - 
           7.53 Cos[$CellContext`b] - 1.5 Sin[$CellContext`b])/60) 
         15]; $CellContext`TCF[
         Pattern[$CellContext`day, 
          Blank[]], 
         Pattern[$CellContext`long, 
          Blank[]], 
         Pattern[$CellContext`tz, 
          Blank[]], 
         Pattern[$CellContext`dst, 
          Blank[]]] := (-60) ($CellContext`tz + If[$CellContext`dst, 1, 0]) + 
        4 $CellContext`long + 4 $CellContext`eqT[$CellContext`day]); 
     Typeset`initDone$$ = True),
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellID->282373083]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "SnapshotsSection"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`date$$ = 355, $CellContext`pd$$ = 
    102.63668565538194`, $CellContext`pt$$ = 
    15.266666666666667`, $CellContext`thisYear$$ = 2017, $CellContext`time$$ =
     8.45, $CellContext`\[Phi]$$ = (-6) Degree, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {
    "\"New Moon\"" :> {$CellContext`date$$ = 11.5, $CellContext`pd$$ = 
       96, $CellContext`pt$$ = 10, $CellContext`time$$ = 
       19, $CellContext`\[Phi]$$ = 5 Degree}, 
     "\"Full Moon\"" :> {$CellContext`date$$ = 27.75, $CellContext`pd$$ = 
       96, $CellContext`pt$$ = 10, $CellContext`time$$ = 
       19.9, $CellContext`\[Phi]$$ = 34 Degree}}, Typeset`bookmarkMode$$ = 
    "Menu", Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`pd$$], 102.63668565538194`}}, {{
       Hold[$CellContext`pt$$], 15.266666666666667`}}, {
      Hold["observer's latitude"], Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`\[Phi]$$], (-6) Degree, ""}, (-90) Degree, 90 Degree,
       Degree}, {
      Hold["city"], Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`\[Phi]$$], (-6) Degree, ""}, {
      61 Degree -> "Anchorage", (-37) Degree -> "Auckland", 14 Degree -> 
       "Bangkok", 40 Degree -> "Beijing", 5 Degree -> "Bogota", 19 Degree -> 
       "Bombay", 51 Degree -> "Brussels", (-35) Degree -> "BuenosAires", 
       30 Degree -> "Cairo", (-34) Degree -> "CapeTown", 
       Rational[67, 2] Degree -> "Casablanca", Rational[209, 5] Degree -> 
       "Chicago", Rational[1, 100] Degree -> "Equator", 22 Degree -> 
       "HongKong", 41 Degree -> "Istanbul", (-6) Degree -> 
       "Jakarta", (-4) Degree -> "Kinshasa", (-12) Degree -> "Lima", 
       52 Degree -> "London", 34 Degree -> "LosAngeles", 15 Degree -> 
       "Manila", 26 Degree -> "Miami", 46 Degree -> "Montreal", 56 Degree -> 
       "Moscow", -Degree -> "Nairobi", Rational[423, 10] Degree -> "NewYork", 
       90 Degree -> "North Pole", 49 Degree -> "Paris", 
       Rational[419, 10] Degree -> "Rome", 60 Degree -> "SaintPetersburg", 
       38 Degree -> "San Francisco", (-33) Degree -> "Santiago", (-24) Degree -> 
       "SaoPaulo", 31 Degree -> "Shanghai", Degree -> 
       "Singapore", (-90) Degree -> "South Pole", Rational[-169, 5] Degree -> 
       "Sydney", 36 Degree -> "Tokyo"}}, {
      Hold["date"], Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`date$$], 355, ""}, 0, 1460, 1}, {
      Hold[
       Row[{
         Manipulate`Place[1], 
         Spacer[4], 
         Dynamic[
          DateString[
           DatePlus[{$CellContext`thisYear$$, 1, 1}, $CellContext`date$$], {
           "Day", " ", "MonthNameShort", " ", "YearShort"}]]}]], 
      Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`date$$], 355, ""}, {
      80.5 -> "Mar 21", 172 -> "Jun 21", 265 -> "Sep 22", 355 -> "Dec 21"}}, {
      Hold["apparent solar time"], Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`time$$], 8.45, ""}, 0, 24, 0.016666666666666666`}, {
      Hold[
       Row[{
         Manipulate`Place[2], 
         Spacer[4], 
         Dynamic[
          DateString[{$CellContext`thisYear$$, 1, 1, 
            Mod[$CellContext`time$$, 12]}, {"Hour", ":", "Minute"}]]}]], 
      Manipulate`Dump`ThisIsNotAControl}, {
      Hold[
       Button[
       "at your location now", $CellContext`\[Phi]$$ = 
         First[Round[Part[$GeoLocation, 1] 10] (Degree/
            10.)]; $CellContext`date$$ = Part[
           DateDifference[{$CellContext`thisYear$$, 1, 1}, 
            DateList[]], 1]; $CellContext`time$$ = Mod[First[Part[
                DateList[], 4] 60 + Part[
               DateList[], 5] + $CellContext`TCF[
               Part[
                DateDifference[$CellContext`thisYear$$, 
                 DateList[]], 1], 
               Part[$GeoLocation, 1], $TimeZone, False]]/60, 24], ImageSize -> 
        155]], Manipulate`Dump`ThisIsNotAControl}, {
      Hold[$CellContext`thisYear$$], 2017}}, Typeset`size$$ = {
    400., {198., 202.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = False, $CellContext`\[Phi]$52447$$ = 
    0, $CellContext`date$52448$$ = 0, $CellContext`time$52449$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     2, StandardForm, 
      "Variables" :> {$CellContext`date$$ = 355, $CellContext`pd$$ = 
        102.63668565538194`, $CellContext`pt$$ = 
        15.266666666666667`, $CellContext`thisYear$$ = 
        2017, $CellContext`time$$ = 
        8.45, $CellContext`\[Phi]$$ = (-6) Degree}, "ControllerVariables" :> {
        Hold[$CellContext`\[Phi]$$, $CellContext`\[Phi]$52447$$, 0], 
        Hold[$CellContext`date$$, $CellContext`date$52448$$, 0], 
        Hold[$CellContext`time$$, $CellContext`time$52449$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> Quiet[
        Module[{$CellContext`\[Epsilon]$ = 
          23.45 Degree, $CellContext`d$, $CellContext`m$, $CellContext`t$, \
$CellContext`sp$, $CellContext`mp$, $CellContext`ep$}, 
         If[$CellContext`\[Phi]$$ == 0, $CellContext`\[Phi]$$ = 
           0.001]; $CellContext`thisYear$$ = First[
            DateList[Today]]; $CellContext`d$ = 2 Pi ((Mod[
               
               If[$CellContext`\[Phi]$$ >= 
                0, $CellContext`date$$, $CellContext`date$$ - 182.5], 365] + 
             10)/365); $CellContext`m$ = (-12.36) 2 
            Pi (($CellContext`date$$ + 10)/365) + 
           0.7; $CellContext`t$ = (Pi/12) (30 - $CellContext`time$$ + 
            If[$CellContext`\[Phi]$$ >= 0, 0, 12]); $CellContext`sp$ = 
          2 Sec[$CellContext`\[Epsilon]$] ((-Cos[$CellContext`d$]) 
             Tan[$CellContext`\[Epsilon]$] + 
            Sqrt[1 - Sin[$CellContext`d$]^2 
              Tan[$CellContext`\[Epsilon]$]^2]) {-Cos[$CellContext`t$], -
             Sin[$CellContext`t$]}; $CellContext`mp$ = 
          2 Sec[$CellContext`\[Epsilon]$] ((-
              Cos[$CellContext`d$ - $CellContext`m$]) 
             Tan[$CellContext`\[Epsilon]$] + 
            Sqrt[1 - Sin[$CellContext`d$ - $CellContext`m$]^2 
              Tan[$CellContext`\[Epsilon]$]^2]) {-
             Cos[$CellContext`t$ - $CellContext`m$], -
             Sin[$CellContext`t$ - $CellContext`m$]}; $CellContext`ep$ = 
          2 Tan[$CellContext`\[Epsilon]$] {
             Cos[$CellContext`d$ - $CellContext`t$], -
             Sin[$CellContext`d$ - $CellContext`t$]}; Graphics[{{Gray, 
             Line[{{-3, 0}, {3, 0}}], 
             Line[{{0, -3}, {0, 3}}]}, {Gray, 
             If[$CellContext`\[Phi]$$ >= 0, 
              
              Disk[{0, -Cot[(Pi + 10 $CellContext`\[Phi]$$)/20] - 
                Tan[(Pi - 10 $CellContext`\[Phi]$$)/20]}, 
               Abs[
               Cot[(Pi + 10 $CellContext`\[Phi]$$)/20] - 
                Tan[(Pi - 10 $CellContext`\[Phi]$$)/20]]], 
              
              Disk[{0, Cot[(Pi - 10 $CellContext`\[Phi]$$)/20] + 
                Tan[(Pi + 10 $CellContext`\[Phi]$$)/20]}, 
               Abs[
               Cot[(Pi - 10 $CellContext`\[Phi]$$)/20] - 
                Tan[(Pi + 10 $CellContext`\[Phi]$$)/20]]]]}, {
             Lighter[Red, 0.75], 
             Table[
              If[$CellContext`\[Phi]$$ >= 0, 
               
               Circle[{
                0, (-Cos[$CellContext`\[Phi]$$]) 
                 Csc[($CellContext`\[Alpha] + $CellContext`\[Phi]$$)/2] 
                 Sec[($CellContext`\[Alpha] - $CellContext`\[Phi]$$)/2]}, 
                Abs[
                Cos[$CellContext`\[Alpha]] 
                 Csc[($CellContext`\[Alpha] + $CellContext`\[Phi]$$)/2] 
                 Sec[($CellContext`\[Alpha] - $CellContext`\[Phi]$$)/2]]], 
               
               Circle[{
                0, Cos[$CellContext`\[Phi]$$] 
                 Csc[($CellContext`\[Alpha] - $CellContext`\[Phi]$$)/2] 
                 Sec[($CellContext`\[Alpha] + $CellContext`\[Phi]$$)/2]}, 
                Abs[
                Cos[$CellContext`\[Alpha]] 
                 Csc[($CellContext`\[Alpha] - $CellContext`\[Phi]$$)/2] 
                 Sec[($CellContext`\[Alpha] + $CellContext`\[Phi]$$)/
                   2]]]], {$CellContext`\[Alpha], (-89.999) Degree, 90 Degree,
                9. Degree}]}, {{
              Lighter[Gray, 0.5], 
              Opacity[0.5], 
              
              Disk[{0, -Cot[$CellContext`\[Phi]$$/2] + 
                Tan[$CellContext`\[Phi]$$/2]}, 2 Abs[
                 Csc[$CellContext`\[Phi]$$]]]}, 
             Directive[Red, 
              AbsoluteThickness[3]], 
             
             Circle[{0, -Cot[$CellContext`\[Phi]$$/2] + 
               Tan[$CellContext`\[Phi]$$/2]}, 2 Abs[
                Csc[$CellContext`\[Phi]$$]]]}, {Red, 
             AbsoluteThickness[2], 
             Circle[
              
              If[$CellContext`\[Phi]$$ >= 0, {
               0, (-2) Cot[(Pi + 2 $CellContext`\[Phi]$$)/4]}, {
               0, 2 Tan[(Pi + 2 $CellContext`\[Phi]$$)/4]}], 0.05]}, {Gray, 
             Circle[{0, 0}, 2]}, {Gray, Dashed, 
             
             Circle[{0, 0}, 
              2 (Cos[$CellContext`\[Epsilon]$]/(1 + 
               Sin[$CellContext`\[Epsilon]$]))]}, {
             AbsoluteThickness[5], Black, 
             
             Circle[{0, 0}, 
              2 (Cos[$CellContext`\[Epsilon]$]/(1 - 
               Sin[$CellContext`\[Epsilon]$]))]}, 
            Text[
             Style["Tempus Fugit", 15, Italic, Bold], {0, -2.5}], {
             AbsoluteThickness[3], Blue, 
             Map[
             Circle[$CellContext`ep$, # Sec[$CellContext`\[Epsilon]$]]& , {
              1.95, 1.68}], 
             AbsoluteThickness[2], 
             Line[1.6 {{
                 Sin[$CellContext`d$ - $CellContext`t$], 
                 Cos[$CellContext`d$ - $CellContext`t$]}, {-
                 Sin[$CellContext`d$ - $CellContext`t$], -
                 Cos[$CellContext`d$ - $CellContext`t$]}}], 
             Line[{0.97 {-Cos[$CellContext`d$ - $CellContext`t$], 
                 Sin[$CellContext`d$ - $CellContext`t$]}, 2.7 {
                 Cos[$CellContext`d$ - $CellContext`t$], -
                 Sin[$CellContext`d$ - $CellContext`t$]}}], 
             Map[Line, 
              Transpose[
               Table[
                Part[{
                  
                  Map[((-2) Cos[# + 0.35] Tan[$CellContext`\[Epsilon]$] + 
                    Sqrt[$CellContext`i^2 Sec[$CellContext`\[Epsilon]$]^2 - 4 
                    Sin[# + 0.35]^2 Tan[$CellContext`\[Epsilon]$]^2]) {-
                    Cos[# + 0.35 + $CellContext`d$ - $CellContext`t$], 
                    Sin[# + 0.35 + $CellContext`d$ - $CellContext`t$]}& , 
                   Range[Pi/6, 2 Pi, Pi/6]]}, 1], {$CellContext`i, {1.95, 
                 1.68}}]]]}, {Purple, 
             AbsolutePointSize[7], 
             Point[$CellContext`ep$], 
             AbsoluteThickness[1], 
             Line[{$CellContext`ep$, $CellContext`sp$}], 
             Line[{$CellContext`ep$, $CellContext`mp$}]}, $CellContext`dial, {
             AbsoluteThickness[3], 
             Arrow[{0.35 {
                 Cos[$CellContext`t$], 
                 Sin[$CellContext`t$]}, (-3.45) {
                 Cos[$CellContext`t$], 
                 Sin[$CellContext`t$]}}]}, {Yellow, 
             Disk[$CellContext`sp$, 0.195], Red, 
             Circle[$CellContext`sp$, 0.198]}, {
             AbsoluteThickness[2], Gray, 
             Line[{0.35 {
                 Cos[$CellContext`t$ - $CellContext`m$], 
                 Sin[$CellContext`t$ - $CellContext`m$]}, (-3.2) {
                 Cos[$CellContext`t$ - $CellContext`m$], 
                 Sin[$CellContext`t$ - $CellContext`m$]}}]}, 
            $CellContext`moon[
             Rescale[
              MoonPhase[
               DatePlus[{
                 First[
                  DateList[Today]], 0, 0}, $CellContext`date$$]], {0, 1}, {-1,
               1}], $CellContext`mp$, 0.185], {
             Disk[{0, 0}, 0.1]}}, PlotRange -> 4.1, ImageSize -> 400]]], 
      "Specifications" :> {{{$CellContext`pd$$, 102.63668565538194`}, 
         ControlType -> None}, {{$CellContext`pt$$, 15.266666666666667`}, 
         ControlType -> None}, 
        "observer's latitude", {{$CellContext`\[Phi]$$, (-6) Degree, 
          ""}, (-90) Degree, 90 Degree, Degree, ImageSize -> Tiny, Appearance -> 
         "Labeled", 
         AppearanceElements -> {
          "InputField", "StepLeftButton", "PlayPauseButton", 
           "StepRightButton"}}, 
        "city", {{$CellContext`\[Phi]$$, (-6) Degree, ""}, {
         61 Degree -> "Anchorage", (-37) Degree -> "Auckland", 14 Degree -> 
          "Bangkok", 40 Degree -> "Beijing", 5 Degree -> "Bogota", 19 Degree -> 
          "Bombay", 51 Degree -> "Brussels", (-35) Degree -> "BuenosAires", 
          30 Degree -> "Cairo", (-34) Degree -> "CapeTown", 
          Rational[67, 2] Degree -> "Casablanca", Rational[209, 5] Degree -> 
          "Chicago", Rational[1, 100] Degree -> "Equator", 22 Degree -> 
          "HongKong", 41 Degree -> "Istanbul", (-6) Degree -> 
          "Jakarta", (-4) Degree -> "Kinshasa", (-12) Degree -> "Lima", 
          52 Degree -> "London", 34 Degree -> "LosAngeles", 15 Degree -> 
          "Manila", 26 Degree -> "Miami", 46 Degree -> "Montreal", 56 Degree -> 
          "Moscow", -Degree -> "Nairobi", Rational[423, 10] Degree -> 
          "NewYork", 90 Degree -> "North Pole", 49 Degree -> "Paris", 
          Rational[419, 10] Degree -> "Rome", 60 Degree -> "SaintPetersburg", 
          38 Degree -> "San Francisco", (-33) Degree -> 
          "Santiago", (-24) Degree -> "SaoPaulo", 31 Degree -> "Shanghai", 
          Degree -> "Singapore", (-90) Degree -> "South Pole", 
          Rational[-169, 5] Degree -> "Sydney", 36 Degree -> "Tokyo"}}, 
        Delimiter, 
        "date", {{$CellContext`date$$, 355, ""}, 0, 1460, 1, ImageSize -> 
         Tiny, AppearanceElements -> {
          "InputField", "StepLeftButton", "PlayPauseButton", 
           "StepRightButton", "FasterSlowerButtons"}, ControlPlacement -> 1}, 
        Row[{
          Manipulate`Place[1], 
          Spacer[4], 
          Dynamic[
           DateString[
            DatePlus[{$CellContext`thisYear$$, 1, 1}, $CellContext`date$$], {
            "Day", " ", "MonthNameShort", " ", 
             "YearShort"}]]}], {{$CellContext`date$$, 355, ""}, {
         80.5 -> "Mar 21", 172 -> "Jun 21", 265 -> "Sep 22", 355 -> 
          "Dec 21"}}, Delimiter, 
        "apparent solar time", {{$CellContext`time$$, 8.45, ""}, 0, 24, 
         0.016666666666666666`, ImageSize -> Tiny, 
         AppearanceElements -> {
          "InputField", "StepLeftButton", "PlayPauseButton", 
           "StepRightButton", "FasterSlowerButtons"}, ControlPlacement -> 2}, 
        Row[{
          Manipulate`Place[2], 
          Spacer[4], 
          Dynamic[
           DateString[{$CellContext`thisYear$$, 1, 1, 
             Mod[$CellContext`time$$, 12]}, {"Hour", ":", "Minute"}]]}], 
        Delimiter, 
        Button[
        "at your location now", $CellContext`\[Phi]$$ = 
          First[Round[Part[$GeoLocation, 1] 10] (Degree/
             10.)]; $CellContext`date$$ = Part[
            DateDifference[{$CellContext`thisYear$$, 1, 1}, 
             DateList[]], 1]; $CellContext`time$$ = Mod[First[Part[
                 DateList[], 4] 60 + Part[
                DateList[], 5] + $CellContext`TCF[
                Part[
                 DateDifference[$CellContext`thisYear$$, 
                  DateList[]], 1], 
                Part[$GeoLocation, 1], $TimeZone, False]]/60, 24], ImageSize -> 
         155], {$CellContext`thisYear$$, 2017, ControlType -> None}, 
        Delimiter}, 
      "Options" :> {
       ControlPlacement -> Left, 
        TrackedSymbols :> {$CellContext`pd$$, $CellContext`pt$$, \
$CellContext`\[Phi]$$, $CellContext`date$$, $CellContext`time$$, \
$CellContext`thisYear$$}, SynchronousUpdating -> True, 
        AutorunSequencing -> {3, 4, 5, 6, 7}}, 
      "DefaultOptions" :> {ControllerLinking -> True}],
     ImageSizeCache->{610., {225., 232.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    Initialization:>(($CellContext`latitudes = {
        61 Degree -> "Anchorage", (-37) Degree -> "Auckland", 14 Degree -> 
         "Bangkok", 40 Degree -> "Beijing", 5 Degree -> "Bogota", 19 Degree -> 
         "Bombay", 51 Degree -> "Brussels", (-35) Degree -> "BuenosAires", 
         30 Degree -> "Cairo", (-34) Degree -> "CapeTown", (335/10) Degree -> 
         "Casablanca", (418/10) Degree -> "Chicago", (1/100) Degree -> 
         "Equator", 22 Degree -> "HongKong", 41 Degree -> 
         "Istanbul", (-6) Degree -> "Jakarta", (-4) Degree -> 
         "Kinshasa", (-12) Degree -> "Lima", 52 Degree -> "London", 34 Degree -> 
         "LosAngeles", 15 Degree -> "Manila", 26 Degree -> "Miami", 46 Degree -> 
         "Montreal", 56 Degree -> "Moscow", -Degree -> 
         "Nairobi", (423/10) Degree -> "NewYork", 90 Degree -> "North Pole", 
         49 Degree -> "Paris", (419/10) Degree -> "Rome", 60 Degree -> 
         "SaintPetersburg", 38 Degree -> "San Francisco", (-33) Degree -> 
         "Santiago", (-24) Degree -> "SaoPaulo", 31 Degree -> "Shanghai", 
         Degree -> "Singapore", (-90) Degree -> 
         "South Pole", ((-338)/10) Degree -> "Sydney", 36 Degree -> 
         "Tokyo"}; $CellContext`dial = {{
          Map[{
            GrayLevel[1 - #^2], Thick, 
            Circle[{0, 0}, 3.1 + #]}& , 
           Range[0, 1.05, 0.025]]}, {Gray, Thick, 
          Map[Circle[{0, 0}, 4.05 + #]& , 
           Range[0, 1.74, 0.025]]}, {Thick, 
          Map[Line[{3.1 {
               Sin[#], -Cos[#]}, 3.2 {
               Sin[#], -Cos[#]}}]& , 
           Range[0, 2 Pi, Pi/12]]}, {
          Map[Text[
            Style[
             IntegerString[
              If[
               Or[# == 0, # == 12], 12, 
               Mod[#, 12]], "Roman"], 14, Bold], 3.5 {
              Sin[(#/12) Pi], 
              Cos[(#/12) Pi]}]& , 
           Range[0, 23]]}, {
          Map[{White, 
            Text[
             Style[
              Part[#, 1], 12, Bold, Italic], 3.85 {
               Sin[
                Part[#, 2]], -Cos[
                 Part[#, 2]]}]}& , {{"N", 0}, {"W", Pi/2}, {"S", Pi}, {
            "E", 3 (Pi/2)}}]}}; $CellContext`moon[
         Pattern[$CellContext`m, 
          Blank[]], {
          Pattern[$CellContext`x0, 
           Blank[]], 
          Pattern[$CellContext`y0, 
           Blank[]]}, 
         Pattern[$CellContext`r, 
          Blank[]]] := Part[
         Plot[
          Evaluate[
           
           Map[$CellContext`y0 - # 
            Sqrt[$CellContext`r^2 - ($CellContext`x0 - $CellContext`x)^2]& , {
            1, $CellContext`m, -1}]], {$CellContext`x, -3.5, 3.5}, PlotStyle -> 
          Directive[Black, Thin], Filling -> {1 -> {2}, 3 -> {2}}, 
          FillingStyle -> {Black, White}, AspectRatio -> 1], 
         1]; $CellContext`eqT[
         Pattern[$CellContext`day, 
          Blank[]]] := 
       Module[{$CellContext`b = 
          2 Pi (($CellContext`day - 81)/365)}, ((9.87 Sin[2 $CellContext`b] - 
           7.53 Cos[$CellContext`b] - 1.5 Sin[$CellContext`b])/60) 
         15]; $CellContext`TCF[
         Pattern[$CellContext`day, 
          Blank[]], 
         Pattern[$CellContext`long, 
          Blank[]], 
         Pattern[$CellContext`tz, 
          Blank[]], 
         Pattern[$CellContext`dst, 
          Blank[]]] := (-60) ($CellContext`tz + If[$CellContext`dst, 1, 0]) + 
        4 $CellContext`long + 4 $CellContext`eqT[$CellContext`day]); 
     Typeset`initDone$$ = True),
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellID->446967361],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`date$$ = 355, $CellContext`pd$$ = 
    102.63668565538194`, $CellContext`pt$$ = 
    15.266666666666667`, $CellContext`thisYear$$ = 2017, $CellContext`time$$ =
     12.616666666666667`, $CellContext`\[Phi]$$ = 90 Degree, Typeset`show$$ = 
    True, Typeset`bookmarkList$$ = {
    "\"New Moon\"" :> {$CellContext`date$$ = 11.5, $CellContext`pd$$ = 
       96, $CellContext`pt$$ = 10, $CellContext`time$$ = 
       19, $CellContext`\[Phi]$$ = 5 Degree}, 
     "\"Full Moon\"" :> {$CellContext`date$$ = 27.75, $CellContext`pd$$ = 
       96, $CellContext`pt$$ = 10, $CellContext`time$$ = 
       19.9, $CellContext`\[Phi]$$ = 34 Degree}}, Typeset`bookmarkMode$$ = 
    "Menu", Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`pd$$], 102.63668565538194`}}, {{
       Hold[$CellContext`pt$$], 15.266666666666667`}}, {
      Hold["observer's latitude"], Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`\[Phi]$$], 90 Degree, ""}, (-90) Degree, 90 Degree, 
      Degree}, {
      Hold["city"], Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`\[Phi]$$], 90 Degree, ""}, {
      61 Degree -> "Anchorage", (-37) Degree -> "Auckland", 14 Degree -> 
       "Bangkok", 40 Degree -> "Beijing", 5 Degree -> "Bogota", 19 Degree -> 
       "Bombay", 51 Degree -> "Brussels", (-35) Degree -> "BuenosAires", 
       30 Degree -> "Cairo", (-34) Degree -> "CapeTown", 
       Rational[67, 2] Degree -> "Casablanca", Rational[209, 5] Degree -> 
       "Chicago", Rational[1, 100] Degree -> "Equator", 22 Degree -> 
       "HongKong", 41 Degree -> "Istanbul", (-6) Degree -> 
       "Jakarta", (-4) Degree -> "Kinshasa", (-12) Degree -> "Lima", 
       52 Degree -> "London", 34 Degree -> "LosAngeles", 15 Degree -> 
       "Manila", 26 Degree -> "Miami", 46 Degree -> "Montreal", 56 Degree -> 
       "Moscow", -Degree -> "Nairobi", Rational[423, 10] Degree -> "NewYork", 
       90 Degree -> "North Pole", 49 Degree -> "Paris", 
       Rational[419, 10] Degree -> "Rome", 60 Degree -> "SaintPetersburg", 
       38 Degree -> "San Francisco", (-33) Degree -> "Santiago", (-24) Degree -> 
       "SaoPaulo", 31 Degree -> "Shanghai", Degree -> 
       "Singapore", (-90) Degree -> "South Pole", Rational[-169, 5] Degree -> 
       "Sydney", 36 Degree -> "Tokyo"}}, {
      Hold["date"], Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`date$$], 355, ""}, 0, 1460, 1}, {
      Hold[
       Row[{
         Manipulate`Place[1], 
         Spacer[4], 
         Dynamic[
          DateString[
           DatePlus[{$CellContext`thisYear$$, 1, 1}, $CellContext`date$$], {
           "Day", " ", "MonthNameShort", " ", "YearShort"}]]}]], 
      Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`date$$], 355, ""}, {
      80.5 -> "Mar 21", 172 -> "Jun 21", 265 -> "Sep 22", 355 -> "Dec 21"}}, {
      Hold["apparent solar time"], Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`time$$], 12.616666666666667`, ""}, 0, 24, 
      0.016666666666666666`}, {
      Hold[
       Row[{
         Manipulate`Place[2], 
         Spacer[4], 
         Dynamic[
          DateString[{$CellContext`thisYear$$, 1, 1, 
            Mod[$CellContext`time$$, 12]}, {"Hour", ":", "Minute"}]]}]], 
      Manipulate`Dump`ThisIsNotAControl}, {
      Hold[
       Button[
       "at your location now", $CellContext`\[Phi]$$ = 
         First[Round[Part[$GeoLocation, 1] 10] (Degree/
            10.)]; $CellContext`date$$ = Part[
           DateDifference[{$CellContext`thisYear$$, 1, 1}, 
            DateList[]], 1]; $CellContext`time$$ = Mod[First[Part[
                DateList[], 4] 60 + Part[
               DateList[], 5] + $CellContext`TCF[
               Part[
                DateDifference[$CellContext`thisYear$$, 
                 DateList[]], 1], 
               Part[$GeoLocation, 1], $TimeZone, False]]/60, 24], ImageSize -> 
        155]], Manipulate`Dump`ThisIsNotAControl}, {
      Hold[$CellContext`thisYear$$], 2017}}, Typeset`size$$ = {
    400., {198., 202.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = False, $CellContext`\[Phi]$52518$$ = 
    0, $CellContext`date$52519$$ = 0, $CellContext`time$52520$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     2, StandardForm, 
      "Variables" :> {$CellContext`date$$ = 355, $CellContext`pd$$ = 
        102.63668565538194`, $CellContext`pt$$ = 
        15.266666666666667`, $CellContext`thisYear$$ = 
        2017, $CellContext`time$$ = 
        12.616666666666667`, $CellContext`\[Phi]$$ = 90 Degree}, 
      "ControllerVariables" :> {
        Hold[$CellContext`\[Phi]$$, $CellContext`\[Phi]$52518$$, 0], 
        Hold[$CellContext`date$$, $CellContext`date$52519$$, 0], 
        Hold[$CellContext`time$$, $CellContext`time$52520$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> Quiet[
        Module[{$CellContext`\[Epsilon]$ = 
          23.45 Degree, $CellContext`d$, $CellContext`m$, $CellContext`t$, \
$CellContext`sp$, $CellContext`mp$, $CellContext`ep$}, 
         If[$CellContext`\[Phi]$$ == 0, $CellContext`\[Phi]$$ = 
           0.001]; $CellContext`thisYear$$ = First[
            DateList[Today]]; $CellContext`d$ = 2 Pi ((Mod[
               
               If[$CellContext`\[Phi]$$ >= 
                0, $CellContext`date$$, $CellContext`date$$ - 182.5], 365] + 
             10)/365); $CellContext`m$ = (-12.36) 2 
            Pi (($CellContext`date$$ + 10)/365) + 
           0.7; $CellContext`t$ = (Pi/12) (30 - $CellContext`time$$ + 
            If[$CellContext`\[Phi]$$ >= 0, 0, 12]); $CellContext`sp$ = 
          2 Sec[$CellContext`\[Epsilon]$] ((-Cos[$CellContext`d$]) 
             Tan[$CellContext`\[Epsilon]$] + 
            Sqrt[1 - Sin[$CellContext`d$]^2 
              Tan[$CellContext`\[Epsilon]$]^2]) {-Cos[$CellContext`t$], -
             Sin[$CellContext`t$]}; $CellContext`mp$ = 
          2 Sec[$CellContext`\[Epsilon]$] ((-
              Cos[$CellContext`d$ - $CellContext`m$]) 
             Tan[$CellContext`\[Epsilon]$] + 
            Sqrt[1 - Sin[$CellContext`d$ - $CellContext`m$]^2 
              Tan[$CellContext`\[Epsilon]$]^2]) {-
             Cos[$CellContext`t$ - $CellContext`m$], -
             Sin[$CellContext`t$ - $CellContext`m$]}; $CellContext`ep$ = 
          2 Tan[$CellContext`\[Epsilon]$] {
             Cos[$CellContext`d$ - $CellContext`t$], -
             Sin[$CellContext`d$ - $CellContext`t$]}; Graphics[{{Gray, 
             Line[{{-3, 0}, {3, 0}}], 
             Line[{{0, -3}, {0, 3}}]}, {Gray, 
             If[$CellContext`\[Phi]$$ >= 0, 
              
              Disk[{0, -Cot[(Pi + 10 $CellContext`\[Phi]$$)/20] - 
                Tan[(Pi - 10 $CellContext`\[Phi]$$)/20]}, 
               Abs[
               Cot[(Pi + 10 $CellContext`\[Phi]$$)/20] - 
                Tan[(Pi - 10 $CellContext`\[Phi]$$)/20]]], 
              
              Disk[{0, Cot[(Pi - 10 $CellContext`\[Phi]$$)/20] + 
                Tan[(Pi + 10 $CellContext`\[Phi]$$)/20]}, 
               Abs[
               Cot[(Pi - 10 $CellContext`\[Phi]$$)/20] - 
                Tan[(Pi + 10 $CellContext`\[Phi]$$)/20]]]]}, {
             Lighter[Red, 0.75], 
             Table[
              If[$CellContext`\[Phi]$$ >= 0, 
               
               Circle[{
                0, (-Cos[$CellContext`\[Phi]$$]) 
                 Csc[($CellContext`\[Alpha] + $CellContext`\[Phi]$$)/2] 
                 Sec[($CellContext`\[Alpha] - $CellContext`\[Phi]$$)/2]}, 
                Abs[
                Cos[$CellContext`\[Alpha]] 
                 Csc[($CellContext`\[Alpha] + $CellContext`\[Phi]$$)/2] 
                 Sec[($CellContext`\[Alpha] - $CellContext`\[Phi]$$)/2]]], 
               
               Circle[{
                0, Cos[$CellContext`\[Phi]$$] 
                 Csc[($CellContext`\[Alpha] - $CellContext`\[Phi]$$)/2] 
                 Sec[($CellContext`\[Alpha] + $CellContext`\[Phi]$$)/2]}, 
                Abs[
                Cos[$CellContext`\[Alpha]] 
                 Csc[($CellContext`\[Alpha] - $CellContext`\[Phi]$$)/2] 
                 Sec[($CellContext`\[Alpha] + $CellContext`\[Phi]$$)/
                   2]]]], {$CellContext`\[Alpha], (-89.999) Degree, 90 Degree,
                9. Degree}]}, {{
              Lighter[Gray, 0.5], 
              Opacity[0.5], 
              
              Disk[{0, -Cot[$CellContext`\[Phi]$$/2] + 
                Tan[$CellContext`\[Phi]$$/2]}, 2 Abs[
                 Csc[$CellContext`\[Phi]$$]]]}, 
             Directive[Red, 
              AbsoluteThickness[3]], 
             
             Circle[{0, -Cot[$CellContext`\[Phi]$$/2] + 
               Tan[$CellContext`\[Phi]$$/2]}, 2 Abs[
                Csc[$CellContext`\[Phi]$$]]]}, {Red, 
             AbsoluteThickness[2], 
             Circle[
              
              If[$CellContext`\[Phi]$$ >= 0, {
               0, (-2) Cot[(Pi + 2 $CellContext`\[Phi]$$)/4]}, {
               0, 2 Tan[(Pi + 2 $CellContext`\[Phi]$$)/4]}], 0.05]}, {Gray, 
             Circle[{0, 0}, 2]}, {Gray, Dashed, 
             
             Circle[{0, 0}, 
              2 (Cos[$CellContext`\[Epsilon]$]/(1 + 
               Sin[$CellContext`\[Epsilon]$]))]}, {
             AbsoluteThickness[5], Black, 
             
             Circle[{0, 0}, 
              2 (Cos[$CellContext`\[Epsilon]$]/(1 - 
               Sin[$CellContext`\[Epsilon]$]))]}, 
            Text[
             Style["Tempus Fugit", 15, Italic, Bold], {0, -2.5}], {
             AbsoluteThickness[3], Blue, 
             Map[
             Circle[$CellContext`ep$, # Sec[$CellContext`\[Epsilon]$]]& , {
              1.95, 1.68}], 
             AbsoluteThickness[2], 
             Line[1.6 {{
                 Sin[$CellContext`d$ - $CellContext`t$], 
                 Cos[$CellContext`d$ - $CellContext`t$]}, {-
                 Sin[$CellContext`d$ - $CellContext`t$], -
                 Cos[$CellContext`d$ - $CellContext`t$]}}], 
             Line[{0.97 {-Cos[$CellContext`d$ - $CellContext`t$], 
                 Sin[$CellContext`d$ - $CellContext`t$]}, 2.7 {
                 Cos[$CellContext`d$ - $CellContext`t$], -
                 Sin[$CellContext`d$ - $CellContext`t$]}}], 
             Map[Line, 
              Transpose[
               Table[
                Part[{
                  
                  Map[((-2) Cos[# + 0.35] Tan[$CellContext`\[Epsilon]$] + 
                    Sqrt[$CellContext`i^2 Sec[$CellContext`\[Epsilon]$]^2 - 4 
                    Sin[# + 0.35]^2 Tan[$CellContext`\[Epsilon]$]^2]) {-
                    Cos[# + 0.35 + $CellContext`d$ - $CellContext`t$], 
                    Sin[# + 0.35 + $CellContext`d$ - $CellContext`t$]}& , 
                   Range[Pi/6, 2 Pi, Pi/6]]}, 1], {$CellContext`i, {1.95, 
                 1.68}}]]]}, {Purple, 
             AbsolutePointSize[7], 
             Point[$CellContext`ep$], 
             AbsoluteThickness[1], 
             Line[{$CellContext`ep$, $CellContext`sp$}], 
             Line[{$CellContext`ep$, $CellContext`mp$}]}, $CellContext`dial, {
             AbsoluteThickness[3], 
             Arrow[{0.35 {
                 Cos[$CellContext`t$], 
                 Sin[$CellContext`t$]}, (-3.45) {
                 Cos[$CellContext`t$], 
                 Sin[$CellContext`t$]}}]}, {Yellow, 
             Disk[$CellContext`sp$, 0.195], Red, 
             Circle[$CellContext`sp$, 0.198]}, {
             AbsoluteThickness[2], Gray, 
             Line[{0.35 {
                 Cos[$CellContext`t$ - $CellContext`m$], 
                 Sin[$CellContext`t$ - $CellContext`m$]}, (-3.2) {
                 Cos[$CellContext`t$ - $CellContext`m$], 
                 Sin[$CellContext`t$ - $CellContext`m$]}}]}, 
            $CellContext`moon[
             Rescale[
              MoonPhase[
               DatePlus[{
                 First[
                  DateList[Today]], 0, 0}, $CellContext`date$$]], {0, 1}, {-1,
               1}], $CellContext`mp$, 0.185], {
             Disk[{0, 0}, 0.1]}}, PlotRange -> 4.1, ImageSize -> 400]]], 
      "Specifications" :> {{{$CellContext`pd$$, 102.63668565538194`}, 
         ControlType -> None}, {{$CellContext`pt$$, 15.266666666666667`}, 
         ControlType -> None}, 
        "observer's latitude", {{$CellContext`\[Phi]$$, 90 Degree, ""}, (-90) 
         Degree, 90 Degree, Degree, ImageSize -> Tiny, Appearance -> 
         "Labeled", 
         AppearanceElements -> {
          "InputField", "StepLeftButton", "PlayPauseButton", 
           "StepRightButton"}}, 
        "city", {{$CellContext`\[Phi]$$, 90 Degree, ""}, {
         61 Degree -> "Anchorage", (-37) Degree -> "Auckland", 14 Degree -> 
          "Bangkok", 40 Degree -> "Beijing", 5 Degree -> "Bogota", 19 Degree -> 
          "Bombay", 51 Degree -> "Brussels", (-35) Degree -> "BuenosAires", 
          30 Degree -> "Cairo", (-34) Degree -> "CapeTown", 
          Rational[67, 2] Degree -> "Casablanca", Rational[209, 5] Degree -> 
          "Chicago", Rational[1, 100] Degree -> "Equator", 22 Degree -> 
          "HongKong", 41 Degree -> "Istanbul", (-6) Degree -> 
          "Jakarta", (-4) Degree -> "Kinshasa", (-12) Degree -> "Lima", 
          52 Degree -> "London", 34 Degree -> "LosAngeles", 15 Degree -> 
          "Manila", 26 Degree -> "Miami", 46 Degree -> "Montreal", 56 Degree -> 
          "Moscow", -Degree -> "Nairobi", Rational[423, 10] Degree -> 
          "NewYork", 90 Degree -> "North Pole", 49 Degree -> "Paris", 
          Rational[419, 10] Degree -> "Rome", 60 Degree -> "SaintPetersburg", 
          38 Degree -> "San Francisco", (-33) Degree -> 
          "Santiago", (-24) Degree -> "SaoPaulo", 31 Degree -> "Shanghai", 
          Degree -> "Singapore", (-90) Degree -> "South Pole", 
          Rational[-169, 5] Degree -> "Sydney", 36 Degree -> "Tokyo"}}, 
        Delimiter, 
        "date", {{$CellContext`date$$, 355, ""}, 0, 1460, 1, ImageSize -> 
         Tiny, AppearanceElements -> {
          "InputField", "StepLeftButton", "PlayPauseButton", 
           "StepRightButton", "FasterSlowerButtons"}, ControlPlacement -> 1}, 
        Row[{
          Manipulate`Place[1], 
          Spacer[4], 
          Dynamic[
           DateString[
            DatePlus[{$CellContext`thisYear$$, 1, 1}, $CellContext`date$$], {
            "Day", " ", "MonthNameShort", " ", 
             "YearShort"}]]}], {{$CellContext`date$$, 355, ""}, {
         80.5 -> "Mar 21", 172 -> "Jun 21", 265 -> "Sep 22", 355 -> 
          "Dec 21"}}, Delimiter, 
        "apparent solar time", {{$CellContext`time$$, 12.616666666666667`, 
          ""}, 0, 24, 0.016666666666666666`, ImageSize -> Tiny, 
         AppearanceElements -> {
          "InputField", "StepLeftButton", "PlayPauseButton", 
           "StepRightButton", "FasterSlowerButtons"}, ControlPlacement -> 2}, 
        Row[{
          Manipulate`Place[2], 
          Spacer[4], 
          Dynamic[
           DateString[{$CellContext`thisYear$$, 1, 1, 
             Mod[$CellContext`time$$, 12]}, {"Hour", ":", "Minute"}]]}], 
        Delimiter, 
        Button[
        "at your location now", $CellContext`\[Phi]$$ = 
          First[Round[Part[$GeoLocation, 1] 10] (Degree/
             10.)]; $CellContext`date$$ = Part[
            DateDifference[{$CellContext`thisYear$$, 1, 1}, 
             DateList[]], 1]; $CellContext`time$$ = Mod[First[Part[
                 DateList[], 4] 60 + Part[
                DateList[], 5] + $CellContext`TCF[
                Part[
                 DateDifference[$CellContext`thisYear$$, 
                  DateList[]], 1], 
                Part[$GeoLocation, 1], $TimeZone, False]]/60, 24], ImageSize -> 
         155], {$CellContext`thisYear$$, 2017, ControlType -> None}, 
        Delimiter}, 
      "Options" :> {
       ControlPlacement -> Left, 
        TrackedSymbols :> {$CellContext`pd$$, $CellContext`pt$$, \
$CellContext`\[Phi]$$, $CellContext`date$$, $CellContext`time$$, \
$CellContext`thisYear$$}, SynchronousUpdating -> True, 
        AutorunSequencing -> {3, 4, 5, 6, 7}}, 
      "DefaultOptions" :> {ControllerLinking -> True}],
     ImageSizeCache->{610., {225., 232.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    Initialization:>(($CellContext`latitudes = {
        61 Degree -> "Anchorage", (-37) Degree -> "Auckland", 14 Degree -> 
         "Bangkok", 40 Degree -> "Beijing", 5 Degree -> "Bogota", 19 Degree -> 
         "Bombay", 51 Degree -> "Brussels", (-35) Degree -> "BuenosAires", 
         30 Degree -> "Cairo", (-34) Degree -> "CapeTown", (335/10) Degree -> 
         "Casablanca", (418/10) Degree -> "Chicago", (1/100) Degree -> 
         "Equator", 22 Degree -> "HongKong", 41 Degree -> 
         "Istanbul", (-6) Degree -> "Jakarta", (-4) Degree -> 
         "Kinshasa", (-12) Degree -> "Lima", 52 Degree -> "London", 34 Degree -> 
         "LosAngeles", 15 Degree -> "Manila", 26 Degree -> "Miami", 46 Degree -> 
         "Montreal", 56 Degree -> "Moscow", -Degree -> 
         "Nairobi", (423/10) Degree -> "NewYork", 90 Degree -> "North Pole", 
         49 Degree -> "Paris", (419/10) Degree -> "Rome", 60 Degree -> 
         "SaintPetersburg", 38 Degree -> "San Francisco", (-33) Degree -> 
         "Santiago", (-24) Degree -> "SaoPaulo", 31 Degree -> "Shanghai", 
         Degree -> "Singapore", (-90) Degree -> 
         "South Pole", ((-338)/10) Degree -> "Sydney", 36 Degree -> 
         "Tokyo"}; $CellContext`dial = {{
          Map[{
            GrayLevel[1 - #^2], Thick, 
            Circle[{0, 0}, 3.1 + #]}& , 
           Range[0, 1.05, 0.025]]}, {Gray, Thick, 
          Map[Circle[{0, 0}, 4.05 + #]& , 
           Range[0, 1.74, 0.025]]}, {Thick, 
          Map[Line[{3.1 {
               Sin[#], -Cos[#]}, 3.2 {
               Sin[#], -Cos[#]}}]& , 
           Range[0, 2 Pi, Pi/12]]}, {
          Map[Text[
            Style[
             IntegerString[
              If[
               Or[# == 0, # == 12], 12, 
               Mod[#, 12]], "Roman"], 14, Bold], 3.5 {
              Sin[(#/12) Pi], 
              Cos[(#/12) Pi]}]& , 
           Range[0, 23]]}, {
          Map[{White, 
            Text[
             Style[
              Part[#, 1], 12, Bold, Italic], 3.85 {
               Sin[
                Part[#, 2]], -Cos[
                 Part[#, 2]]}]}& , {{"N", 0}, {"W", Pi/2}, {"S", Pi}, {
            "E", 3 (Pi/2)}}]}}; $CellContext`moon[
         Pattern[$CellContext`m, 
          Blank[]], {
          Pattern[$CellContext`x0, 
           Blank[]], 
          Pattern[$CellContext`y0, 
           Blank[]]}, 
         Pattern[$CellContext`r, 
          Blank[]]] := Part[
         Plot[
          Evaluate[
           
           Map[$CellContext`y0 - # 
            Sqrt[$CellContext`r^2 - ($CellContext`x0 - $CellContext`x)^2]& , {
            1, $CellContext`m, -1}]], {$CellContext`x, -3.5, 3.5}, PlotStyle -> 
          Directive[Black, Thin], Filling -> {1 -> {2}, 3 -> {2}}, 
          FillingStyle -> {Black, White}, AspectRatio -> 1], 
         1]; $CellContext`eqT[
         Pattern[$CellContext`day, 
          Blank[]]] := 
       Module[{$CellContext`b = 
          2 Pi (($CellContext`day - 81)/365)}, ((9.87 Sin[2 $CellContext`b] - 
           7.53 Cos[$CellContext`b] - 1.5 Sin[$CellContext`b])/60) 
         15]; $CellContext`TCF[
         Pattern[$CellContext`day, 
          Blank[]], 
         Pattern[$CellContext`long, 
          Blank[]], 
         Pattern[$CellContext`tz, 
          Blank[]], 
         Pattern[$CellContext`dst, 
          Blank[]]] := (-60) ($CellContext`tz + If[$CellContext`dst, 1, 0]) + 
        4 $CellContext`long + 4 $CellContext`eqT[$CellContext`day]); 
     Typeset`initDone$$ = True),
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellID->193695706],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`date$$ = 355, $CellContext`pd$$ = 
    104.60867024739584`, $CellContext`pt$$ = 14.6, $CellContext`thisYear$$ = 
    2017, $CellContext`time$$ = 11.983333333333338`, $CellContext`\[Phi]$$ = 
    61 Degree, Typeset`show$$ = True, Typeset`bookmarkList$$ = {
    "\"New Moon\"" :> {$CellContext`date$$ = 11.5, $CellContext`pd$$ = 
       96, $CellContext`pt$$ = 10, $CellContext`time$$ = 
       19, $CellContext`\[Phi]$$ = 5 Degree}, 
     "\"Full Moon\"" :> {$CellContext`date$$ = 27.75, $CellContext`pd$$ = 
       96, $CellContext`pt$$ = 10, $CellContext`time$$ = 
       19.9, $CellContext`\[Phi]$$ = 34 Degree}}, Typeset`bookmarkMode$$ = 
    "Menu", Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`pd$$], 104.60867024739584`}}, {{
       Hold[$CellContext`pt$$], 14.6}}, {
      Hold["observer's latitude"], Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`\[Phi]$$], 61 Degree, ""}, (-90) Degree, 90 Degree, 
      Degree}, {
      Hold["city"], Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`\[Phi]$$], 61 Degree, ""}, {
      61 Degree -> "Anchorage", (-37) Degree -> "Auckland", 14 Degree -> 
       "Bangkok", 40 Degree -> "Beijing", 5 Degree -> "Bogota", 19 Degree -> 
       "Bombay", 51 Degree -> "Brussels", (-35) Degree -> "BuenosAires", 
       30 Degree -> "Cairo", (-34) Degree -> "CapeTown", 
       Rational[67, 2] Degree -> "Casablanca", Rational[209, 5] Degree -> 
       "Chicago", Rational[1, 100] Degree -> "Equator", 22 Degree -> 
       "HongKong", 41 Degree -> "Istanbul", (-6) Degree -> 
       "Jakarta", (-4) Degree -> "Kinshasa", (-12) Degree -> "Lima", 
       52 Degree -> "London", 34 Degree -> "LosAngeles", 15 Degree -> 
       "Manila", 26 Degree -> "Miami", 46 Degree -> "Montreal", 56 Degree -> 
       "Moscow", -Degree -> "Nairobi", Rational[423, 10] Degree -> "NewYork", 
       90 Degree -> "North Pole", 49 Degree -> "Paris", 
       Rational[419, 10] Degree -> "Rome", 60 Degree -> "SaintPetersburg", 
       38 Degree -> "San Francisco", (-33) Degree -> "Santiago", (-24) Degree -> 
       "SaoPaulo", 31 Degree -> "Shanghai", Degree -> 
       "Singapore", (-90) Degree -> "South Pole", Rational[-169, 5] Degree -> 
       "Sydney", 36 Degree -> "Tokyo"}}, {
      Hold["date"], Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`date$$], 355, ""}, 0, 1460, 1}, {
      Hold[
       Row[{
         Manipulate`Place[1], 
         Spacer[4], 
         Dynamic[
          DateString[
           DatePlus[{$CellContext`thisYear$$, 1, 1}, $CellContext`date$$], {
           "Day", " ", "MonthNameShort", " ", "YearShort"}]]}]], 
      Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`date$$], 355, ""}, {
      80.5 -> "Mar 21", 172 -> "Jun 21", 265 -> "Sep 22", 355 -> "Dec 21"}}, {
      Hold["apparent solar time"], Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`time$$], 11.983333333333338`, ""}, 0, 24, 
      0.016666666666666666`}, {
      Hold[
       Row[{
         Manipulate`Place[2], 
         Spacer[4], 
         Dynamic[
          DateString[{$CellContext`thisYear$$, 1, 1, 
            Mod[$CellContext`time$$, 12]}, {"Hour", ":", "Minute"}]]}]], 
      Manipulate`Dump`ThisIsNotAControl}, {
      Hold[
       Button[
       "at your location now", $CellContext`\[Phi]$$ = 
         First[Round[Part[$GeoLocation, 1] 10] (Degree/
            10.)]; $CellContext`date$$ = Part[
           DateDifference[{$CellContext`thisYear$$, 1, 1}, 
            DateList[]], 1]; $CellContext`time$$ = Mod[First[Part[
                DateList[], 4] 60 + Part[
               DateList[], 5] + $CellContext`TCF[
               Part[
                DateDifference[$CellContext`thisYear$$, 
                 DateList[]], 1], 
               Part[$GeoLocation, 1], $TimeZone, False]]/60, 24], ImageSize -> 
        155]], Manipulate`Dump`ThisIsNotAControl}, {
      Hold[$CellContext`thisYear$$], 2017}}, Typeset`size$$ = {
    400., {198., 202.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = False, $CellContext`\[Phi]$52589$$ = 
    0, $CellContext`date$52590$$ = 0, $CellContext`time$52591$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     2, StandardForm, 
      "Variables" :> {$CellContext`date$$ = 355, $CellContext`pd$$ = 
        104.60867024739584`, $CellContext`pt$$ = 
        14.6, $CellContext`thisYear$$ = 2017, $CellContext`time$$ = 
        11.983333333333338`, $CellContext`\[Phi]$$ = 61 Degree}, 
      "ControllerVariables" :> {
        Hold[$CellContext`\[Phi]$$, $CellContext`\[Phi]$52589$$, 0], 
        Hold[$CellContext`date$$, $CellContext`date$52590$$, 0], 
        Hold[$CellContext`time$$, $CellContext`time$52591$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> Quiet[
        Module[{$CellContext`\[Epsilon]$ = 
          23.45 Degree, $CellContext`d$, $CellContext`m$, $CellContext`t$, \
$CellContext`sp$, $CellContext`mp$, $CellContext`ep$}, 
         If[$CellContext`\[Phi]$$ == 0, $CellContext`\[Phi]$$ = 
           0.001]; $CellContext`thisYear$$ = First[
            DateList[Today]]; $CellContext`d$ = 2 Pi ((Mod[
               
               If[$CellContext`\[Phi]$$ >= 
                0, $CellContext`date$$, $CellContext`date$$ - 182.5], 365] + 
             10)/365); $CellContext`m$ = (-12.36) 2 
            Pi (($CellContext`date$$ + 10)/365) + 
           0.7; $CellContext`t$ = (Pi/12) (30 - $CellContext`time$$ + 
            If[$CellContext`\[Phi]$$ >= 0, 0, 12]); $CellContext`sp$ = 
          2 Sec[$CellContext`\[Epsilon]$] ((-Cos[$CellContext`d$]) 
             Tan[$CellContext`\[Epsilon]$] + 
            Sqrt[1 - Sin[$CellContext`d$]^2 
              Tan[$CellContext`\[Epsilon]$]^2]) {-Cos[$CellContext`t$], -
             Sin[$CellContext`t$]}; $CellContext`mp$ = 
          2 Sec[$CellContext`\[Epsilon]$] ((-
              Cos[$CellContext`d$ - $CellContext`m$]) 
             Tan[$CellContext`\[Epsilon]$] + 
            Sqrt[1 - Sin[$CellContext`d$ - $CellContext`m$]^2 
              Tan[$CellContext`\[Epsilon]$]^2]) {-
             Cos[$CellContext`t$ - $CellContext`m$], -
             Sin[$CellContext`t$ - $CellContext`m$]}; $CellContext`ep$ = 
          2 Tan[$CellContext`\[Epsilon]$] {
             Cos[$CellContext`d$ - $CellContext`t$], -
             Sin[$CellContext`d$ - $CellContext`t$]}; Graphics[{{Gray, 
             Line[{{-3, 0}, {3, 0}}], 
             Line[{{0, -3}, {0, 3}}]}, {Gray, 
             If[$CellContext`\[Phi]$$ >= 0, 
              
              Disk[{0, -Cot[(Pi + 10 $CellContext`\[Phi]$$)/20] - 
                Tan[(Pi - 10 $CellContext`\[Phi]$$)/20]}, 
               Abs[
               Cot[(Pi + 10 $CellContext`\[Phi]$$)/20] - 
                Tan[(Pi - 10 $CellContext`\[Phi]$$)/20]]], 
              
              Disk[{0, Cot[(Pi - 10 $CellContext`\[Phi]$$)/20] + 
                Tan[(Pi + 10 $CellContext`\[Phi]$$)/20]}, 
               Abs[
               Cot[(Pi - 10 $CellContext`\[Phi]$$)/20] - 
                Tan[(Pi + 10 $CellContext`\[Phi]$$)/20]]]]}, {
             Lighter[Red, 0.75], 
             Table[
              If[$CellContext`\[Phi]$$ >= 0, 
               
               Circle[{
                0, (-Cos[$CellContext`\[Phi]$$]) 
                 Csc[($CellContext`\[Alpha] + $CellContext`\[Phi]$$)/2] 
                 Sec[($CellContext`\[Alpha] - $CellContext`\[Phi]$$)/2]}, 
                Abs[
                Cos[$CellContext`\[Alpha]] 
                 Csc[($CellContext`\[Alpha] + $CellContext`\[Phi]$$)/2] 
                 Sec[($CellContext`\[Alpha] - $CellContext`\[Phi]$$)/2]]], 
               
               Circle[{
                0, Cos[$CellContext`\[Phi]$$] 
                 Csc[($CellContext`\[Alpha] - $CellContext`\[Phi]$$)/2] 
                 Sec[($CellContext`\[Alpha] + $CellContext`\[Phi]$$)/2]}, 
                Abs[
                Cos[$CellContext`\[Alpha]] 
                 Csc[($CellContext`\[Alpha] - $CellContext`\[Phi]$$)/2] 
                 Sec[($CellContext`\[Alpha] + $CellContext`\[Phi]$$)/
                   2]]]], {$CellContext`\[Alpha], (-89.999) Degree, 90 Degree,
                9. Degree}]}, {{
              Lighter[Gray, 0.5], 
              Opacity[0.5], 
              
              Disk[{0, -Cot[$CellContext`\[Phi]$$/2] + 
                Tan[$CellContext`\[Phi]$$/2]}, 2 Abs[
                 Csc[$CellContext`\[Phi]$$]]]}, 
             Directive[Red, 
              AbsoluteThickness[3]], 
             
             Circle[{0, -Cot[$CellContext`\[Phi]$$/2] + 
               Tan[$CellContext`\[Phi]$$/2]}, 2 Abs[
                Csc[$CellContext`\[Phi]$$]]]}, {Red, 
             AbsoluteThickness[2], 
             Circle[
              
              If[$CellContext`\[Phi]$$ >= 0, {
               0, (-2) Cot[(Pi + 2 $CellContext`\[Phi]$$)/4]}, {
               0, 2 Tan[(Pi + 2 $CellContext`\[Phi]$$)/4]}], 0.05]}, {Gray, 
             Circle[{0, 0}, 2]}, {Gray, Dashed, 
             
             Circle[{0, 0}, 
              2 (Cos[$CellContext`\[Epsilon]$]/(1 + 
               Sin[$CellContext`\[Epsilon]$]))]}, {
             AbsoluteThickness[5], Black, 
             
             Circle[{0, 0}, 
              2 (Cos[$CellContext`\[Epsilon]$]/(1 - 
               Sin[$CellContext`\[Epsilon]$]))]}, 
            Text[
             Style["Tempus Fugit", 15, Italic, Bold], {0, -2.5}], {
             AbsoluteThickness[3], Blue, 
             Map[
             Circle[$CellContext`ep$, # Sec[$CellContext`\[Epsilon]$]]& , {
              1.95, 1.68}], 
             AbsoluteThickness[2], 
             Line[1.6 {{
                 Sin[$CellContext`d$ - $CellContext`t$], 
                 Cos[$CellContext`d$ - $CellContext`t$]}, {-
                 Sin[$CellContext`d$ - $CellContext`t$], -
                 Cos[$CellContext`d$ - $CellContext`t$]}}], 
             Line[{0.97 {-Cos[$CellContext`d$ - $CellContext`t$], 
                 Sin[$CellContext`d$ - $CellContext`t$]}, 2.7 {
                 Cos[$CellContext`d$ - $CellContext`t$], -
                 Sin[$CellContext`d$ - $CellContext`t$]}}], 
             Map[Line, 
              Transpose[
               Table[
                Part[{
                  
                  Map[((-2) Cos[# + 0.35] Tan[$CellContext`\[Epsilon]$] + 
                    Sqrt[$CellContext`i^2 Sec[$CellContext`\[Epsilon]$]^2 - 4 
                    Sin[# + 0.35]^2 Tan[$CellContext`\[Epsilon]$]^2]) {-
                    Cos[# + 0.35 + $CellContext`d$ - $CellContext`t$], 
                    Sin[# + 0.35 + $CellContext`d$ - $CellContext`t$]}& , 
                   Range[Pi/6, 2 Pi, Pi/6]]}, 1], {$CellContext`i, {1.95, 
                 1.68}}]]]}, {Purple, 
             AbsolutePointSize[7], 
             Point[$CellContext`ep$], 
             AbsoluteThickness[1], 
             Line[{$CellContext`ep$, $CellContext`sp$}], 
             Line[{$CellContext`ep$, $CellContext`mp$}]}, $CellContext`dial, {
             AbsoluteThickness[3], 
             Arrow[{0.35 {
                 Cos[$CellContext`t$], 
                 Sin[$CellContext`t$]}, (-3.45) {
                 Cos[$CellContext`t$], 
                 Sin[$CellContext`t$]}}]}, {Yellow, 
             Disk[$CellContext`sp$, 0.195], Red, 
             Circle[$CellContext`sp$, 0.198]}, {
             AbsoluteThickness[2], Gray, 
             Line[{0.35 {
                 Cos[$CellContext`t$ - $CellContext`m$], 
                 Sin[$CellContext`t$ - $CellContext`m$]}, (-3.2) {
                 Cos[$CellContext`t$ - $CellContext`m$], 
                 Sin[$CellContext`t$ - $CellContext`m$]}}]}, 
            $CellContext`moon[
             Rescale[
              MoonPhase[
               DatePlus[{
                 First[
                  DateList[Today]], 0, 0}, $CellContext`date$$]], {0, 1}, {-1,
               1}], $CellContext`mp$, 0.185], {
             Disk[{0, 0}, 0.1]}}, PlotRange -> 4.1, ImageSize -> 400]]], 
      "Specifications" :> {{{$CellContext`pd$$, 104.60867024739584`}, 
         ControlType -> None}, {{$CellContext`pt$$, 14.6}, ControlType -> 
         None}, "observer's latitude", {{$CellContext`\[Phi]$$, 61 Degree, 
          ""}, (-90) Degree, 90 Degree, Degree, ImageSize -> Tiny, Appearance -> 
         "Labeled", 
         AppearanceElements -> {
          "InputField", "StepLeftButton", "PlayPauseButton", 
           "StepRightButton"}}, 
        "city", {{$CellContext`\[Phi]$$, 61 Degree, ""}, {
         61 Degree -> "Anchorage", (-37) Degree -> "Auckland", 14 Degree -> 
          "Bangkok", 40 Degree -> "Beijing", 5 Degree -> "Bogota", 19 Degree -> 
          "Bombay", 51 Degree -> "Brussels", (-35) Degree -> "BuenosAires", 
          30 Degree -> "Cairo", (-34) Degree -> "CapeTown", 
          Rational[67, 2] Degree -> "Casablanca", Rational[209, 5] Degree -> 
          "Chicago", Rational[1, 100] Degree -> "Equator", 22 Degree -> 
          "HongKong", 41 Degree -> "Istanbul", (-6) Degree -> 
          "Jakarta", (-4) Degree -> "Kinshasa", (-12) Degree -> "Lima", 
          52 Degree -> "London", 34 Degree -> "LosAngeles", 15 Degree -> 
          "Manila", 26 Degree -> "Miami", 46 Degree -> "Montreal", 56 Degree -> 
          "Moscow", -Degree -> "Nairobi", Rational[423, 10] Degree -> 
          "NewYork", 90 Degree -> "North Pole", 49 Degree -> "Paris", 
          Rational[419, 10] Degree -> "Rome", 60 Degree -> "SaintPetersburg", 
          38 Degree -> "San Francisco", (-33) Degree -> 
          "Santiago", (-24) Degree -> "SaoPaulo", 31 Degree -> "Shanghai", 
          Degree -> "Singapore", (-90) Degree -> "South Pole", 
          Rational[-169, 5] Degree -> "Sydney", 36 Degree -> "Tokyo"}}, 
        Delimiter, 
        "date", {{$CellContext`date$$, 355, ""}, 0, 1460, 1, ImageSize -> 
         Tiny, AppearanceElements -> {
          "InputField", "StepLeftButton", "PlayPauseButton", 
           "StepRightButton", "FasterSlowerButtons"}, ControlPlacement -> 1}, 
        Row[{
          Manipulate`Place[1], 
          Spacer[4], 
          Dynamic[
           DateString[
            DatePlus[{$CellContext`thisYear$$, 1, 1}, $CellContext`date$$], {
            "Day", " ", "MonthNameShort", " ", 
             "YearShort"}]]}], {{$CellContext`date$$, 355, ""}, {
         80.5 -> "Mar 21", 172 -> "Jun 21", 265 -> "Sep 22", 355 -> 
          "Dec 21"}}, Delimiter, 
        "apparent solar time", {{$CellContext`time$$, 11.983333333333338`, 
          ""}, 0, 24, 0.016666666666666666`, ImageSize -> Tiny, 
         AppearanceElements -> {
          "InputField", "StepLeftButton", "PlayPauseButton", 
           "StepRightButton", "FasterSlowerButtons"}, ControlPlacement -> 2}, 
        Row[{
          Manipulate`Place[2], 
          Spacer[4], 
          Dynamic[
           DateString[{$CellContext`thisYear$$, 1, 1, 
             Mod[$CellContext`time$$, 12]}, {"Hour", ":", "Minute"}]]}], 
        Delimiter, 
        Button[
        "at your location now", $CellContext`\[Phi]$$ = 
          First[Round[Part[$GeoLocation, 1] 10] (Degree/
             10.)]; $CellContext`date$$ = Part[
            DateDifference[{$CellContext`thisYear$$, 1, 1}, 
             DateList[]], 1]; $CellContext`time$$ = Mod[First[Part[
                 DateList[], 4] 60 + Part[
                DateList[], 5] + $CellContext`TCF[
                Part[
                 DateDifference[$CellContext`thisYear$$, 
                  DateList[]], 1], 
                Part[$GeoLocation, 1], $TimeZone, False]]/60, 24], ImageSize -> 
         155], {$CellContext`thisYear$$, 2017, ControlType -> None}, 
        Delimiter}, 
      "Options" :> {
       ControlPlacement -> Left, 
        TrackedSymbols :> {$CellContext`pd$$, $CellContext`pt$$, \
$CellContext`\[Phi]$$, $CellContext`date$$, $CellContext`time$$, \
$CellContext`thisYear$$}, SynchronousUpdating -> True, 
        AutorunSequencing -> {3, 4, 5, 6, 7}}, 
      "DefaultOptions" :> {ControllerLinking -> True}],
     ImageSizeCache->{610., {225., 232.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    Initialization:>(($CellContext`latitudes = {
        61 Degree -> "Anchorage", (-37) Degree -> "Auckland", 14 Degree -> 
         "Bangkok", 40 Degree -> "Beijing", 5 Degree -> "Bogota", 19 Degree -> 
         "Bombay", 51 Degree -> "Brussels", (-35) Degree -> "BuenosAires", 
         30 Degree -> "Cairo", (-34) Degree -> "CapeTown", (335/10) Degree -> 
         "Casablanca", (418/10) Degree -> "Chicago", (1/100) Degree -> 
         "Equator", 22 Degree -> "HongKong", 41 Degree -> 
         "Istanbul", (-6) Degree -> "Jakarta", (-4) Degree -> 
         "Kinshasa", (-12) Degree -> "Lima", 52 Degree -> "London", 34 Degree -> 
         "LosAngeles", 15 Degree -> "Manila", 26 Degree -> "Miami", 46 Degree -> 
         "Montreal", 56 Degree -> "Moscow", -Degree -> 
         "Nairobi", (423/10) Degree -> "NewYork", 90 Degree -> "North Pole", 
         49 Degree -> "Paris", (419/10) Degree -> "Rome", 60 Degree -> 
         "SaintPetersburg", 38 Degree -> "San Francisco", (-33) Degree -> 
         "Santiago", (-24) Degree -> "SaoPaulo", 31 Degree -> "Shanghai", 
         Degree -> "Singapore", (-90) Degree -> 
         "South Pole", ((-338)/10) Degree -> "Sydney", 36 Degree -> 
         "Tokyo"}; $CellContext`dial = {{
          Map[{
            GrayLevel[1 - #^2], Thick, 
            Circle[{0, 0}, 3.1 + #]}& , 
           Range[0, 1.05, 0.025]]}, {Gray, Thick, 
          Map[Circle[{0, 0}, 4.05 + #]& , 
           Range[0, 1.74, 0.025]]}, {Thick, 
          Map[Line[{3.1 {
               Sin[#], -Cos[#]}, 3.2 {
               Sin[#], -Cos[#]}}]& , 
           Range[0, 2 Pi, Pi/12]]}, {
          Map[Text[
            Style[
             IntegerString[
              If[
               Or[# == 0, # == 12], 12, 
               Mod[#, 12]], "Roman"], 14, Bold], 3.5 {
              Sin[(#/12) Pi], 
              Cos[(#/12) Pi]}]& , 
           Range[0, 23]]}, {
          Map[{White, 
            Text[
             Style[
              Part[#, 1], 12, Bold, Italic], 3.85 {
               Sin[
                Part[#, 2]], -Cos[
                 Part[#, 2]]}]}& , {{"N", 0}, {"W", Pi/2}, {"S", Pi}, {
            "E", 3 (Pi/2)}}]}}; $CellContext`moon[
         Pattern[$CellContext`m, 
          Blank[]], {
          Pattern[$CellContext`x0, 
           Blank[]], 
          Pattern[$CellContext`y0, 
           Blank[]]}, 
         Pattern[$CellContext`r, 
          Blank[]]] := Part[
         Plot[
          Evaluate[
           
           Map[$CellContext`y0 - # 
            Sqrt[$CellContext`r^2 - ($CellContext`x0 - $CellContext`x)^2]& , {
            1, $CellContext`m, -1}]], {$CellContext`x, -3.5, 3.5}, PlotStyle -> 
          Directive[Black, Thin], Filling -> {1 -> {2}, 3 -> {2}}, 
          FillingStyle -> {Black, White}, AspectRatio -> 1], 
         1]; $CellContext`eqT[
         Pattern[$CellContext`day, 
          Blank[]]] := 
       Module[{$CellContext`b = 
          2 Pi (($CellContext`day - 81)/365)}, ((9.87 Sin[2 $CellContext`b] - 
           7.53 Cos[$CellContext`b] - 1.5 Sin[$CellContext`b])/60) 
         15]; $CellContext`TCF[
         Pattern[$CellContext`day, 
          Blank[]], 
         Pattern[$CellContext`long, 
          Blank[]], 
         Pattern[$CellContext`tz, 
          Blank[]], 
         Pattern[$CellContext`dst, 
          Blank[]]] := (-60) ($CellContext`tz + If[$CellContext`dst, 1, 0]) + 
        4 $CellContext`long + 4 $CellContext`eqT[$CellContext`day]); 
     Typeset`initDone$$ = True),
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellID->502904314],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`date$$ = 172, $CellContext`pd$$ = 
    102.63668565538194`, $CellContext`pt$$ = 
    15.266666666666667`, $CellContext`thisYear$$ = 2017, $CellContext`time$$ =
     15.299999999999999`, $CellContext`\[Phi]$$ = (-37) Degree, 
    Typeset`show$$ = True, Typeset`bookmarkList$$ = {
    "\"New Moon\"" :> {$CellContext`date$$ = 11.5, $CellContext`pd$$ = 
       96, $CellContext`pt$$ = 10, $CellContext`time$$ = 
       19, $CellContext`\[Phi]$$ = 5 Degree}, 
     "\"Full Moon\"" :> {$CellContext`date$$ = 27.75, $CellContext`pd$$ = 
       96, $CellContext`pt$$ = 10, $CellContext`time$$ = 
       19.9, $CellContext`\[Phi]$$ = 34 Degree}}, Typeset`bookmarkMode$$ = 
    "Menu", Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`pd$$], 102.63668565538194`}}, {{
       Hold[$CellContext`pt$$], 15.266666666666667`}}, {
      Hold["observer's latitude"], Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`\[Phi]$$], (-37) Degree, ""}, (-90) Degree, 90 
      Degree, Degree}, {
      Hold["city"], Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`\[Phi]$$], (-37) Degree, ""}, {
      61 Degree -> "Anchorage", (-37) Degree -> "Auckland", 14 Degree -> 
       "Bangkok", 40 Degree -> "Beijing", 5 Degree -> "Bogota", 19 Degree -> 
       "Bombay", 51 Degree -> "Brussels", (-35) Degree -> "BuenosAires", 
       30 Degree -> "Cairo", (-34) Degree -> "CapeTown", 
       Rational[67, 2] Degree -> "Casablanca", Rational[209, 5] Degree -> 
       "Chicago", Rational[1, 100] Degree -> "Equator", 22 Degree -> 
       "HongKong", 41 Degree -> "Istanbul", (-6) Degree -> 
       "Jakarta", (-4) Degree -> "Kinshasa", (-12) Degree -> "Lima", 
       52 Degree -> "London", 34 Degree -> "LosAngeles", 15 Degree -> 
       "Manila", 26 Degree -> "Miami", 46 Degree -> "Montreal", 56 Degree -> 
       "Moscow", -Degree -> "Nairobi", Rational[423, 10] Degree -> "NewYork", 
       90 Degree -> "North Pole", 49 Degree -> "Paris", 
       Rational[419, 10] Degree -> "Rome", 60 Degree -> "SaintPetersburg", 
       38 Degree -> "San Francisco", (-33) Degree -> "Santiago", (-24) Degree -> 
       "SaoPaulo", 31 Degree -> "Shanghai", Degree -> 
       "Singapore", (-90) Degree -> "South Pole", Rational[-169, 5] Degree -> 
       "Sydney", 36 Degree -> "Tokyo"}}, {
      Hold["date"], Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`date$$], 172, ""}, 0, 1460, 1}, {
      Hold[
       Row[{
         Manipulate`Place[1], 
         Spacer[4], 
         Dynamic[
          DateString[
           DatePlus[{$CellContext`thisYear$$, 1, 1}, $CellContext`date$$], {
           "Day", " ", "MonthNameShort", " ", "YearShort"}]]}]], 
      Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`date$$], 172, ""}, {
      80.5 -> "Mar 21", 172 -> "Jun 21", 265 -> "Sep 22", 355 -> "Dec 21"}}, {
      Hold["apparent solar time"], Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`time$$], 15.299999999999999`, ""}, 0, 24, 
      0.016666666666666666`}, {
      Hold[
       Row[{
         Manipulate`Place[2], 
         Spacer[4], 
         Dynamic[
          DateString[{$CellContext`thisYear$$, 1, 1, 
            Mod[$CellContext`time$$, 12]}, {"Hour", ":", "Minute"}]]}]], 
      Manipulate`Dump`ThisIsNotAControl}, {
      Hold[
       Button[
       "at your location now", $CellContext`\[Phi]$$ = 
         First[Round[Part[$GeoLocation, 1] 10] (Degree/
            10.)]; $CellContext`date$$ = Part[
           DateDifference[{$CellContext`thisYear$$, 1, 1}, 
            DateList[]], 1]; $CellContext`time$$ = Mod[First[Part[
                DateList[], 4] 60 + Part[
               DateList[], 5] + $CellContext`TCF[
               Part[
                DateDifference[$CellContext`thisYear$$, 
                 DateList[]], 1], 
               Part[$GeoLocation, 1], $TimeZone, False]]/60, 24], ImageSize -> 
        155]], Manipulate`Dump`ThisIsNotAControl}, {
      Hold[$CellContext`thisYear$$], 2017}}, Typeset`size$$ = {
    400., {198., 202.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = False, $CellContext`\[Phi]$52660$$ = 
    0, $CellContext`date$52661$$ = 0, $CellContext`time$52662$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     2, StandardForm, 
      "Variables" :> {$CellContext`date$$ = 172, $CellContext`pd$$ = 
        102.63668565538194`, $CellContext`pt$$ = 
        15.266666666666667`, $CellContext`thisYear$$ = 
        2017, $CellContext`time$$ = 
        15.299999999999999`, $CellContext`\[Phi]$$ = (-37) Degree}, 
      "ControllerVariables" :> {
        Hold[$CellContext`\[Phi]$$, $CellContext`\[Phi]$52660$$, 0], 
        Hold[$CellContext`date$$, $CellContext`date$52661$$, 0], 
        Hold[$CellContext`time$$, $CellContext`time$52662$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> Quiet[
        Module[{$CellContext`\[Epsilon]$ = 
          23.45 Degree, $CellContext`d$, $CellContext`m$, $CellContext`t$, \
$CellContext`sp$, $CellContext`mp$, $CellContext`ep$}, 
         If[$CellContext`\[Phi]$$ == 0, $CellContext`\[Phi]$$ = 
           0.001]; $CellContext`thisYear$$ = First[
            DateList[Today]]; $CellContext`d$ = 2 Pi ((Mod[
               
               If[$CellContext`\[Phi]$$ >= 
                0, $CellContext`date$$, $CellContext`date$$ - 182.5], 365] + 
             10)/365); $CellContext`m$ = (-12.36) 2 
            Pi (($CellContext`date$$ + 10)/365) + 
           0.7; $CellContext`t$ = (Pi/12) (30 - $CellContext`time$$ + 
            If[$CellContext`\[Phi]$$ >= 0, 0, 12]); $CellContext`sp$ = 
          2 Sec[$CellContext`\[Epsilon]$] ((-Cos[$CellContext`d$]) 
             Tan[$CellContext`\[Epsilon]$] + 
            Sqrt[1 - Sin[$CellContext`d$]^2 
              Tan[$CellContext`\[Epsilon]$]^2]) {-Cos[$CellContext`t$], -
             Sin[$CellContext`t$]}; $CellContext`mp$ = 
          2 Sec[$CellContext`\[Epsilon]$] ((-
              Cos[$CellContext`d$ - $CellContext`m$]) 
             Tan[$CellContext`\[Epsilon]$] + 
            Sqrt[1 - Sin[$CellContext`d$ - $CellContext`m$]^2 
              Tan[$CellContext`\[Epsilon]$]^2]) {-
             Cos[$CellContext`t$ - $CellContext`m$], -
             Sin[$CellContext`t$ - $CellContext`m$]}; $CellContext`ep$ = 
          2 Tan[$CellContext`\[Epsilon]$] {
             Cos[$CellContext`d$ - $CellContext`t$], -
             Sin[$CellContext`d$ - $CellContext`t$]}; Graphics[{{Gray, 
             Line[{{-3, 0}, {3, 0}}], 
             Line[{{0, -3}, {0, 3}}]}, {Gray, 
             If[$CellContext`\[Phi]$$ >= 0, 
              
              Disk[{0, -Cot[(Pi + 10 $CellContext`\[Phi]$$)/20] - 
                Tan[(Pi - 10 $CellContext`\[Phi]$$)/20]}, 
               Abs[
               Cot[(Pi + 10 $CellContext`\[Phi]$$)/20] - 
                Tan[(Pi - 10 $CellContext`\[Phi]$$)/20]]], 
              
              Disk[{0, Cot[(Pi - 10 $CellContext`\[Phi]$$)/20] + 
                Tan[(Pi + 10 $CellContext`\[Phi]$$)/20]}, 
               Abs[
               Cot[(Pi - 10 $CellContext`\[Phi]$$)/20] - 
                Tan[(Pi + 10 $CellContext`\[Phi]$$)/20]]]]}, {
             Lighter[Red, 0.75], 
             Table[
              If[$CellContext`\[Phi]$$ >= 0, 
               
               Circle[{
                0, (-Cos[$CellContext`\[Phi]$$]) 
                 Csc[($CellContext`\[Alpha] + $CellContext`\[Phi]$$)/2] 
                 Sec[($CellContext`\[Alpha] - $CellContext`\[Phi]$$)/2]}, 
                Abs[
                Cos[$CellContext`\[Alpha]] 
                 Csc[($CellContext`\[Alpha] + $CellContext`\[Phi]$$)/2] 
                 Sec[($CellContext`\[Alpha] - $CellContext`\[Phi]$$)/2]]], 
               
               Circle[{
                0, Cos[$CellContext`\[Phi]$$] 
                 Csc[($CellContext`\[Alpha] - $CellContext`\[Phi]$$)/2] 
                 Sec[($CellContext`\[Alpha] + $CellContext`\[Phi]$$)/2]}, 
                Abs[
                Cos[$CellContext`\[Alpha]] 
                 Csc[($CellContext`\[Alpha] - $CellContext`\[Phi]$$)/2] 
                 Sec[($CellContext`\[Alpha] + $CellContext`\[Phi]$$)/
                   2]]]], {$CellContext`\[Alpha], (-89.999) Degree, 90 Degree,
                9. Degree}]}, {{
              Lighter[Gray, 0.5], 
              Opacity[0.5], 
              
              Disk[{0, -Cot[$CellContext`\[Phi]$$/2] + 
                Tan[$CellContext`\[Phi]$$/2]}, 2 Abs[
                 Csc[$CellContext`\[Phi]$$]]]}, 
             Directive[Red, 
              AbsoluteThickness[3]], 
             
             Circle[{0, -Cot[$CellContext`\[Phi]$$/2] + 
               Tan[$CellContext`\[Phi]$$/2]}, 2 Abs[
                Csc[$CellContext`\[Phi]$$]]]}, {Red, 
             AbsoluteThickness[2], 
             Circle[
              
              If[$CellContext`\[Phi]$$ >= 0, {
               0, (-2) Cot[(Pi + 2 $CellContext`\[Phi]$$)/4]}, {
               0, 2 Tan[(Pi + 2 $CellContext`\[Phi]$$)/4]}], 0.05]}, {Gray, 
             Circle[{0, 0}, 2]}, {Gray, Dashed, 
             
             Circle[{0, 0}, 
              2 (Cos[$CellContext`\[Epsilon]$]/(1 + 
               Sin[$CellContext`\[Epsilon]$]))]}, {
             AbsoluteThickness[5], Black, 
             
             Circle[{0, 0}, 
              2 (Cos[$CellContext`\[Epsilon]$]/(1 - 
               Sin[$CellContext`\[Epsilon]$]))]}, 
            Text[
             Style["Tempus Fugit", 15, Italic, Bold], {0, -2.5}], {
             AbsoluteThickness[3], Blue, 
             Map[
             Circle[$CellContext`ep$, # Sec[$CellContext`\[Epsilon]$]]& , {
              1.95, 1.68}], 
             AbsoluteThickness[2], 
             Line[1.6 {{
                 Sin[$CellContext`d$ - $CellContext`t$], 
                 Cos[$CellContext`d$ - $CellContext`t$]}, {-
                 Sin[$CellContext`d$ - $CellContext`t$], -
                 Cos[$CellContext`d$ - $CellContext`t$]}}], 
             Line[{0.97 {-Cos[$CellContext`d$ - $CellContext`t$], 
                 Sin[$CellContext`d$ - $CellContext`t$]}, 2.7 {
                 Cos[$CellContext`d$ - $CellContext`t$], -
                 Sin[$CellContext`d$ - $CellContext`t$]}}], 
             Map[Line, 
              Transpose[
               Table[
                Part[{
                  
                  Map[((-2) Cos[# + 0.35] Tan[$CellContext`\[Epsilon]$] + 
                    Sqrt[$CellContext`i^2 Sec[$CellContext`\[Epsilon]$]^2 - 4 
                    Sin[# + 0.35]^2 Tan[$CellContext`\[Epsilon]$]^2]) {-
                    Cos[# + 0.35 + $CellContext`d$ - $CellContext`t$], 
                    Sin[# + 0.35 + $CellContext`d$ - $CellContext`t$]}& , 
                   Range[Pi/6, 2 Pi, Pi/6]]}, 1], {$CellContext`i, {1.95, 
                 1.68}}]]]}, {Purple, 
             AbsolutePointSize[7], 
             Point[$CellContext`ep$], 
             AbsoluteThickness[1], 
             Line[{$CellContext`ep$, $CellContext`sp$}], 
             Line[{$CellContext`ep$, $CellContext`mp$}]}, $CellContext`dial, {
             AbsoluteThickness[3], 
             Arrow[{0.35 {
                 Cos[$CellContext`t$], 
                 Sin[$CellContext`t$]}, (-3.45) {
                 Cos[$CellContext`t$], 
                 Sin[$CellContext`t$]}}]}, {Yellow, 
             Disk[$CellContext`sp$, 0.195], Red, 
             Circle[$CellContext`sp$, 0.198]}, {
             AbsoluteThickness[2], Gray, 
             Line[{0.35 {
                 Cos[$CellContext`t$ - $CellContext`m$], 
                 Sin[$CellContext`t$ - $CellContext`m$]}, (-3.2) {
                 Cos[$CellContext`t$ - $CellContext`m$], 
                 Sin[$CellContext`t$ - $CellContext`m$]}}]}, 
            $CellContext`moon[
             Rescale[
              MoonPhase[
               DatePlus[{
                 First[
                  DateList[Today]], 0, 0}, $CellContext`date$$]], {0, 1}, {-1,
               1}], $CellContext`mp$, 0.185], {
             Disk[{0, 0}, 0.1]}}, PlotRange -> 4.1, ImageSize -> 400]]], 
      "Specifications" :> {{{$CellContext`pd$$, 102.63668565538194`}, 
         ControlType -> None}, {{$CellContext`pt$$, 15.266666666666667`}, 
         ControlType -> None}, 
        "observer's latitude", {{$CellContext`\[Phi]$$, (-37) Degree, 
          ""}, (-90) Degree, 90 Degree, Degree, ImageSize -> Tiny, Appearance -> 
         "Labeled", 
         AppearanceElements -> {
          "InputField", "StepLeftButton", "PlayPauseButton", 
           "StepRightButton"}}, 
        "city", {{$CellContext`\[Phi]$$, (-37) Degree, ""}, {
         61 Degree -> "Anchorage", (-37) Degree -> "Auckland", 14 Degree -> 
          "Bangkok", 40 Degree -> "Beijing", 5 Degree -> "Bogota", 19 Degree -> 
          "Bombay", 51 Degree -> "Brussels", (-35) Degree -> "BuenosAires", 
          30 Degree -> "Cairo", (-34) Degree -> "CapeTown", 
          Rational[67, 2] Degree -> "Casablanca", Rational[209, 5] Degree -> 
          "Chicago", Rational[1, 100] Degree -> "Equator", 22 Degree -> 
          "HongKong", 41 Degree -> "Istanbul", (-6) Degree -> 
          "Jakarta", (-4) Degree -> "Kinshasa", (-12) Degree -> "Lima", 
          52 Degree -> "London", 34 Degree -> "LosAngeles", 15 Degree -> 
          "Manila", 26 Degree -> "Miami", 46 Degree -> "Montreal", 56 Degree -> 
          "Moscow", -Degree -> "Nairobi", Rational[423, 10] Degree -> 
          "NewYork", 90 Degree -> "North Pole", 49 Degree -> "Paris", 
          Rational[419, 10] Degree -> "Rome", 60 Degree -> "SaintPetersburg", 
          38 Degree -> "San Francisco", (-33) Degree -> 
          "Santiago", (-24) Degree -> "SaoPaulo", 31 Degree -> "Shanghai", 
          Degree -> "Singapore", (-90) Degree -> "South Pole", 
          Rational[-169, 5] Degree -> "Sydney", 36 Degree -> "Tokyo"}}, 
        Delimiter, 
        "date", {{$CellContext`date$$, 172, ""}, 0, 1460, 1, ImageSize -> 
         Tiny, AppearanceElements -> {
          "InputField", "StepLeftButton", "PlayPauseButton", 
           "StepRightButton", "FasterSlowerButtons"}, ControlPlacement -> 1}, 
        Row[{
          Manipulate`Place[1], 
          Spacer[4], 
          Dynamic[
           DateString[
            DatePlus[{$CellContext`thisYear$$, 1, 1}, $CellContext`date$$], {
            "Day", " ", "MonthNameShort", " ", 
             "YearShort"}]]}], {{$CellContext`date$$, 172, ""}, {
         80.5 -> "Mar 21", 172 -> "Jun 21", 265 -> "Sep 22", 355 -> 
          "Dec 21"}}, Delimiter, 
        "apparent solar time", {{$CellContext`time$$, 15.299999999999999`, 
          ""}, 0, 24, 0.016666666666666666`, ImageSize -> Tiny, 
         AppearanceElements -> {
          "InputField", "StepLeftButton", "PlayPauseButton", 
           "StepRightButton", "FasterSlowerButtons"}, ControlPlacement -> 2}, 
        Row[{
          Manipulate`Place[2], 
          Spacer[4], 
          Dynamic[
           DateString[{$CellContext`thisYear$$, 1, 1, 
             Mod[$CellContext`time$$, 12]}, {"Hour", ":", "Minute"}]]}], 
        Delimiter, 
        Button[
        "at your location now", $CellContext`\[Phi]$$ = 
          First[Round[Part[$GeoLocation, 1] 10] (Degree/
             10.)]; $CellContext`date$$ = Part[
            DateDifference[{$CellContext`thisYear$$, 1, 1}, 
             DateList[]], 1]; $CellContext`time$$ = Mod[First[Part[
                 DateList[], 4] 60 + Part[
                DateList[], 5] + $CellContext`TCF[
                Part[
                 DateDifference[$CellContext`thisYear$$, 
                  DateList[]], 1], 
                Part[$GeoLocation, 1], $TimeZone, False]]/60, 24], ImageSize -> 
         155], {$CellContext`thisYear$$, 2017, ControlType -> None}, 
        Delimiter}, 
      "Options" :> {
       ControlPlacement -> Left, 
        TrackedSymbols :> {$CellContext`pd$$, $CellContext`pt$$, \
$CellContext`\[Phi]$$, $CellContext`date$$, $CellContext`time$$, \
$CellContext`thisYear$$}, SynchronousUpdating -> True, 
        AutorunSequencing -> {3, 4, 5, 6, 7}}, 
      "DefaultOptions" :> {ControllerLinking -> True}],
     ImageSizeCache->{610., {225., 232.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    Initialization:>(($CellContext`latitudes = {
        61 Degree -> "Anchorage", (-37) Degree -> "Auckland", 14 Degree -> 
         "Bangkok", 40 Degree -> "Beijing", 5 Degree -> "Bogota", 19 Degree -> 
         "Bombay", 51 Degree -> "Brussels", (-35) Degree -> "BuenosAires", 
         30 Degree -> "Cairo", (-34) Degree -> "CapeTown", (335/10) Degree -> 
         "Casablanca", (418/10) Degree -> "Chicago", (1/100) Degree -> 
         "Equator", 22 Degree -> "HongKong", 41 Degree -> 
         "Istanbul", (-6) Degree -> "Jakarta", (-4) Degree -> 
         "Kinshasa", (-12) Degree -> "Lima", 52 Degree -> "London", 34 Degree -> 
         "LosAngeles", 15 Degree -> "Manila", 26 Degree -> "Miami", 46 Degree -> 
         "Montreal", 56 Degree -> "Moscow", -Degree -> 
         "Nairobi", (423/10) Degree -> "NewYork", 90 Degree -> "North Pole", 
         49 Degree -> "Paris", (419/10) Degree -> "Rome", 60 Degree -> 
         "SaintPetersburg", 38 Degree -> "San Francisco", (-33) Degree -> 
         "Santiago", (-24) Degree -> "SaoPaulo", 31 Degree -> "Shanghai", 
         Degree -> "Singapore", (-90) Degree -> 
         "South Pole", ((-338)/10) Degree -> "Sydney", 36 Degree -> 
         "Tokyo"}; $CellContext`dial = {{
          Map[{
            GrayLevel[1 - #^2], Thick, 
            Circle[{0, 0}, 3.1 + #]}& , 
           Range[0, 1.05, 0.025]]}, {Gray, Thick, 
          Map[Circle[{0, 0}, 4.05 + #]& , 
           Range[0, 1.74, 0.025]]}, {Thick, 
          Map[Line[{3.1 {
               Sin[#], -Cos[#]}, 3.2 {
               Sin[#], -Cos[#]}}]& , 
           Range[0, 2 Pi, Pi/12]]}, {
          Map[Text[
            Style[
             IntegerString[
              If[
               Or[# == 0, # == 12], 12, 
               Mod[#, 12]], "Roman"], 14, Bold], 3.5 {
              Sin[(#/12) Pi], 
              Cos[(#/12) Pi]}]& , 
           Range[0, 23]]}, {
          Map[{White, 
            Text[
             Style[
              Part[#, 1], 12, Bold, Italic], 3.85 {
               Sin[
                Part[#, 2]], -Cos[
                 Part[#, 2]]}]}& , {{"N", 0}, {"W", Pi/2}, {"S", Pi}, {
            "E", 3 (Pi/2)}}]}}; $CellContext`moon[
         Pattern[$CellContext`m, 
          Blank[]], {
          Pattern[$CellContext`x0, 
           Blank[]], 
          Pattern[$CellContext`y0, 
           Blank[]]}, 
         Pattern[$CellContext`r, 
          Blank[]]] := Part[
         Plot[
          Evaluate[
           
           Map[$CellContext`y0 - # 
            Sqrt[$CellContext`r^2 - ($CellContext`x0 - $CellContext`x)^2]& , {
            1, $CellContext`m, -1}]], {$CellContext`x, -3.5, 3.5}, PlotStyle -> 
          Directive[Black, Thin], Filling -> {1 -> {2}, 3 -> {2}}, 
          FillingStyle -> {Black, White}, AspectRatio -> 1], 
         1]; $CellContext`eqT[
         Pattern[$CellContext`day, 
          Blank[]]] := 
       Module[{$CellContext`b = 
          2 Pi (($CellContext`day - 81)/365)}, ((9.87 Sin[2 $CellContext`b] - 
           7.53 Cos[$CellContext`b] - 1.5 Sin[$CellContext`b])/60) 
         15]; $CellContext`TCF[
         Pattern[$CellContext`day, 
          Blank[]], 
         Pattern[$CellContext`long, 
          Blank[]], 
         Pattern[$CellContext`tz, 
          Blank[]], 
         Pattern[$CellContext`dst, 
          Blank[]]] := (-60) ($CellContext`tz + If[$CellContext`dst, 1, 0]) + 
        4 $CellContext`long + 4 $CellContext`eqT[$CellContext`day]); 
     Typeset`initDone$$ = True),
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellID->208561602]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "DetailsSection"],

Cell["\<\
A detailed explanation of the astronomical clock in Prague, which inspired \
this Demonstration, can be found in [1].\
\>", "DetailNotes",
 CellChangeTimes->{{3.544384060709882*^9, 3.544384066814807*^9}},
 CellID->151340159],

Cell["\<\
The dial of the astronomical clock features several circles that are the \
stereographic projections of circles on the celestial sphere and of the \
supposed circular orbits of the Sun and Moon around the Earth.\
\>", "DetailNotes",
 CellChangeTimes->{{3.5443840757923203`*^9, 3.544384076263679*^9}, {
  3.5443841764933863`*^9, 3.544384184547701*^9}},
 CellID->402450682],

Cell[TextData[{
 "The Earth is supposed to be at ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{"0", ",", "0", ",", "0"}], ")"}], TraditionalForm]], "InlineMath"],
 " and the projection plane is ",
 Cell[BoxData[
  FormBox[
   RowBox[{"z", "=", 
    RowBox[{"-", "1"}]}], TraditionalForm]], "InlineMath"],
 ". Since the stereographic projection of a circle on the sphere is a circle \
in the plane, it is sufficient to calculate the centers and radii of the \
projected circles."
}], "DetailNotes",
 CellChangeTimes->{{3.54427343300873*^9, 3.5442734419106197`*^9}, {
   3.54438409839178*^9, 3.544384107839138*^9}, 3.5443842112484007`*^9, 
   3.544534305326404*^9},
 CellID->29490526],

Cell["\<\
The projection of the Earth is at the center of the clock. The three \
concentric circles around it are the projections of the Equator and the \
tropics. The largest circle just under the Roman numerals is the Tropic of \
Cancer. The dashed smallest circle is the Tropic of Capricorn and the middle \
circle is the Equator. These circles are fixed and stay fixed on the dial.\
\>", "DetailNotes",
 CellChangeTimes->{
  3.544384133016617*^9, {3.544384167822939*^9, 3.544384168697187*^9}, 
   3.544384208098166*^9, {3.544534315876996*^9, 3.5445343297402697`*^9}},
 CellID->44039224],

Cell[TextData[{
 "The red circles are the projection of the almucantars, that is, the lines \
of fixed solar altitude on the celestial sphere. The fat circle of altitude \
zero is the horizon. This circle divides the celestial sphere into day and \
night. The smallest tiny circle is the zenith and represents altitude 90\
\[Degree]. The other almucantars are at 9\[Degree] altitude intervals. The \
dark disk and circle at altitude ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"-", "18"}], "\[Degree]"}], TraditionalForm]], "InlineMath"],
 " define the area of complete darkness or astronomical night. The \
almucantars are only dependent on the latitude of the observer."
}], "DetailNotes",
 CellChangeTimes->{{3.544384377200658*^9, 3.544384419982955*^9}, 
   3.54453434937211*^9},
 CellID->15312235],

Cell["\<\
The projection of the ecliptic is represented by a ring of two concentric \
blue circles. This ring revolves around the center of the clock, showing the \
Earth's rotation around its axis. Its eccentricity to the center of the clock \
is the result of the Earth's axial tilt of 23.45\[Degree].\
\>", "DetailNotes",
 CellChangeTimes->{{3.544384209177401*^9, 3.544384210245199*^9}, {
  3.5443844453696833`*^9, 3.544384456493187*^9}},
 CellID->61596088],

Cell["\<\
Four spokes divide the ecliptic ring into four unequal parts representing the \
four seasons. The shortest spoke cuts the ecliptic at the winter solstice, \
the longest at the summer solstice. The two other spokes of equal length cut \
the ecliptic at the equinoxes. The ring is further divided into 12 sectors \
marking the months of the year.\
\>", "DetailNotes",
 CellChangeTimes->{{3.5443844654594584`*^9, 3.544384472106615*^9}},
 CellID->239776412],

Cell["\<\
The Sun travels counterclockwise along the ecliptic ring during one year. \
While crossing the horizon it will rise and set in the East or West depending \
on the observer's hemisphere. East is to the left of the clock, West is to \
the right. South is at the top of the clock and North is at the bottom.\
\>", "DetailNotes",
 CellChangeTimes->{3.5443842218820353`*^9},
 CellID->435152130],

Cell[TextData[{
 "The Moon travels along the ecliptic ring at a higher speed and goes to \
different phases depending on its position in relation to the Sun. The Prague \
clock uses gears with 379 and 366 teeth and hence gets ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"2", 
     RowBox[{"\[Pi]", "(", 
      RowBox[{"1", "+", 
       RowBox[{"366", "/", "379"}]}], ")"}]}], "\[TildeTilde]", "12.3509"}], 
   TraditionalForm]], "InlineMath"],
 " lunations. In this demonstration, the ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " expression MoonPhase is used to get the illumination fraction of the moon \
used for the moon's display on the dial."
}], "DetailNotes",
 CellChangeTimes->{
  3.544384222936185*^9, {3.5443843045417833`*^9, 3.54438430827813*^9}, {
   3.5443845364742393`*^9, 3.5443845773606577`*^9}, {3.5445343928826723`*^9, 
   3.544534406370473*^9}, 3.685264486422717*^9, {3.685270294255056*^9, 
   3.685270444795104*^9}},
 CellID->99655210],

Cell["\<\
Apparent solar time can be read by the Sun hand on the 2\[Times]12 hour Roman \
numeral dial. The division between am and pm hours depends on the observer's \
hemisphere. For this Demonstration, solar time is computed from the local \
(clock) time and depends on the observer's longitude, time zone, and the use \
of daylight saving time. The approximate date, or at least the month, can be \
read by estimating the sector of the ecliptic ring covered by the Sun hand. \
\>", "DetailNotes",
 CellChangeTimes->{{3.5442733277422037`*^9, 3.544273333536783*^9}, {
  3.54438422384593*^9, 3.5443842246381807`*^9}, {3.544384587196138*^9, 
  3.544384609615152*^9}, {3.544534487419483*^9, 3.544534491818099*^9}},
 CellID->240306128],

Cell["\<\
Snapshot 1: at the equator with 12 hours of daylight year round\
\>", "DetailNotes",
 CellChangeTimes->{{3.543405680421875*^9, 3.54340570275*^9}, {
   3.543405762265625*^9, 3.543405762265625*^9}, 3.544384617646285*^9},
 CellID->777683086],

Cell["\<\
Snapshot 2: at the North pole in December and no daylight all day long\
\>", "DetailNotes",
 CellChangeTimes->{{3.543405762890625*^9, 3.5434057940625*^9}, 
   3.5434059189375*^9, 3.544384619052363*^9},
 CellID->304876035],

Cell["\<\
Snapshot 3: Anchorage on December 21 with only a small time of daylight \
around solar noon\
\>", "DetailNotes",
 CellChangeTimes->{{3.543405552921875*^9, 3.543405591484375*^9}, {
   3.543405668828125*^9, 3.543405675703125*^9}, {3.543405858328125*^9, 
   3.54340585834375*^9}, 3.5434059209375*^9, 3.544384621055084*^9, {
   3.544534532193014*^9, 3.544534536583392*^9}},
 CellID->209868928],

Cell["\<\
Snapshot 4: Auckland, New Zealand in June with short days and long nights\
\>", "DetailNotes",
 CellChangeTimes->{{3.54340585896875*^9, 3.54340590496875*^9}, 
   3.544384625205751*^9},
 CellID->24284052],

Cell["Reference", "DetailNotes",
 CellChangeTimes->{{3.5425199694375*^9, 3.542519972046875*^9}, 
   3.544534539751203*^9},
 CellID->61528475],

Cell[TextData[{
 "[1] V. Sedl\[AAcute]\[CHacek]ek. \"The Astronomical Clock in Prague (A \
Detailed, Illustrated Description).\" ",
 StyleBox["Agentura ProV\[AAcute]s",
  FontSlant->"Italic"],
 ". (Aug 2010) ",
 ButtonBox["www.plakatovani.cz/english",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://www.plakatovani.cz/english/"], None},
  ButtonNote->"http://www.plakatovani.cz/english/"],
 "."
}], "DetailNotes",
 CellChangeTimes->{{3.542519634234375*^9, 3.542519668359375*^9}, {
   3.542519705234375*^9, 3.5425198155*^9}, {3.542519890703125*^9, 
   3.542519890703125*^9}, 3.54264552571875*^9, {3.542704765796875*^9, 
   3.542704799546875*^9}, {3.54270483275*^9, 3.54270484*^9}, {
   3.544384629661318*^9, 3.544384630223278*^9}, {3.5445345761995697`*^9, 
   3.5445346731215277`*^9}},
 CellID->482478948]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "ControlSuggestionsSection"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[True], Cell[" Resize Images"]}],
  "\"Click inside an image to reveal its orange resize frame.\\nDrag any of \
the orange resize handles to resize the image.\"",
  TooltipDelay->0.35]], "ControlSuggestions",
 CellChangeTimes->{3.54269004653125*^9},
 FontFamily->"Verdana",
 CellTags->"ResizeImages"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[False], Cell[" Rotate and Zoom in 3D"]}],
  RowBox[{
   "\"Drag a 3D graphic to rotate it. Starting the drag near the center \
tumbles\\nthe graphic; starting near a corner turns it parallel to the plane \
of the screen.\\nHold down \"", 
    FrameBox[
    "Ctrl", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], "\" (or \"", 
    FrameBox[
    "Cmd", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], "\" on Mac) and drag up and down to zoom.\""}],
  TooltipDelay->0.35]], "ControlSuggestions",
 FontFamily->"Verdana",
 CellTags->"RotateAndZoomIn3D"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[False], Cell[" Drag Locators"]}],
  RowBox[{"\"Drag any locator (\"", 
    GraphicsBox[
     LocatorBox[
      Scaled[{0.5, 0.5}]], ImageSize -> 20], 
    "\", etc.) to move it around.\""}],
  TooltipDelay->0.35]], "ControlSuggestions",
 FontFamily->"Verdana",
 CellTags->"DragLocators"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[False], Cell[" Create and Delete Locators"]}],
  RowBox[{"\"Insert a new locator in the graphic by holding down the \"", 
    FrameBox[
    "Alt", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], 
    "\" key\\nand clicking where you want it to be. Delete a locator by \
clicking it\\nwhile holding down the \"", 
    FrameBox[
    "Alt", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], "\" key.\""}],
  TooltipDelay->0.35]], "ControlSuggestions",
 FontFamily->"Verdana",
 CellTags->"CreateAndDeleteLocators"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[True], Cell[" Slider Zoom"]}],
  RowBox[{"\"Hold down the \"", 
    FrameBox[
    "Alt", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], 
    "\" key while moving a slider to make fine adjustments in the slider \
value.\\nHold \"", 
    FrameBox[
    "Ctrl", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], "\" and/or \"", 
    FrameBox[
    "Shift", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], "\" at the same time as \"", 
    FrameBox[
    "Alt", Background -> GrayLevel[0.9], FrameMargins -> 2, FrameStyle -> 
     GrayLevel[0.9]], "\" to make ever finer adjustments.\""}],
  TooltipDelay->0.35]], "ControlSuggestions",
 CellChangeTimes->{3.54269004246875*^9},
 FontFamily->"Verdana",
 CellTags->"SliderZoom"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[True], Cell[" Gamepad Controls"]}],
  "\"Control this Demonstration with a gamepad or other\\nhuman interface \
device connected to your computer.\"",
  TooltipDelay->0.35]], "ControlSuggestions",
 CellChangeTimes->{3.35696210375764*^9, 3.3895522232313623`*^9, 
  3.544384636969936*^9},
 FontFamily->"Verdana",
 CellTags->"GamepadControls"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[True], Cell[" Automatic Animation"]}],
  RowBox[{"\"Animate a slider in this Demonstration by clicking the\"", 
    AdjustmentBox[
     Cell[
      GraphicsData[
      "CompressedBitmap", 
       "eJzzTSzJSM1NLMlMTlRwL0osyMhMLlZwyy8CCjEzMjAwcIKwAgOI/R/IhBKc\n\
/4EAyGAG0f+nTZsGwgysIJIRKsWKLAXGIHFmEpUgLADxWUAkI24jZs+eTaEt\n\
IG+wQKRmzJgBlYf5lhEA30OqWA=="], "Graphics", ImageSize -> {9, 9}, ImageMargins -> 
      0, CellBaseline -> Baseline], BoxBaselineShift -> 0.1839080459770115, 
     BoxMargins -> {{0., 0.}, {-0.1839080459770115, 0.1839080459770115}}], 
    "\"button\\nnext to the slider, and then clicking the play button that \
appears.\\nAnimate all controls by selecting \"", 
    StyleBox["Autorun", FontWeight -> "Bold"], "\" from the\"", 
    AdjustmentBox[
     Cell[
      GraphicsData[
      "CompressedBitmap", 
       "eJyNULENwyAQfEySIlMwTVJlCGRFsosokeNtqBmDBagoaZjAI1C8/8GUUUC6\n\
57h7cQ8PvU7Pl17nUav7oj/TPH7V7b2QJAUAXBkKmCPRowxICy64bRvGGNF7\n\
X8CctGoDSN4xhIDGGDhzFXwUh3/ClBKrDQPmnGXtI6u0OOd+tZBVUqy1xSaH\n\
UqiK6pPe4XdEdAz6563tx/gejuORGMxJaz8mdpJn7hc="], "Graphics", 
      ImageSize -> {10, 10}, ImageMargins -> 0, CellBaseline -> Baseline], 
     BoxBaselineShift -> 0.1839080459770115, 
     BoxMargins -> {{0., 0.}, {-0.1839080459770115, 0.1839080459770115}}], 
    "\"menu.\""}],
  TooltipDelay->0.35]], "ControlSuggestions",
 CellChangeTimes->{3.542690040625*^9},
 FontFamily->"Verdana",
 CellTags->"AutomaticAnimation"],

Cell[BoxData[
 TooltipBox[
  RowBox[{
   CheckboxBox[True], Cell[" Bookmark Animation"]}],
  RowBox[{
   "\"See a prepared animation of this Demonstration by selecting\\n\"", 
    StyleBox["Animate Bookmarks", FontWeight -> "Bold"], "\" from the\"", 
    AdjustmentBox[
     Cell[
      GraphicsData[
      "CompressedBitmap", 
       "eJyNULENwyAQfEySIlMwTVJlCGRFsosokeNtqBmDBagoaZjAI1C8/8GUUUC6\n\
57h7cQ8PvU7Pl17nUav7oj/TPH7V7b2QJAUAXBkKmCPRowxICy64bRvGGNF7\n\
X8CctGoDSN4xhIDGGDhzFXwUh3/ClBKrDQPmnGXtI6u0OOd+tZBVUqy1xSaH\n\
UqiK6pPe4XdEdAz6563tx/gejuORGMxJaz8mdpJn7hc="], "Graphics", 
      ImageSize -> {10, 10}, ImageMargins -> 0, CellBaseline -> Baseline], 
     BoxBaselineShift -> 0.1839080459770115, 
     BoxMargins -> {{0., 0.}, {-0.1839080459770115, 0.1839080459770115}}], 
    "\"menu.\""}],
  TooltipDelay->0.35]], "ControlSuggestions",
 CellChangeTimes->{3.542705969953125*^9},
 FontFamily->"Verdana",
 CellTags->"BookmarkAnimation"]
}, Open  ]],

Cell["", "SearchTermsSection"],

Cell[CellGroupData[{

Cell["", "RelatedLinksSection"],

Cell[TextData[ButtonBox["The Orloj: Investigating the Astronomical Clock of \
Prague",
 BaseStyle->"Hyperlink",
 ButtonData->{
   URL["http://www.mathematica-journal.com/issue/v7i4/features/gehrig/\
contents/html/index.html"], None},
 ButtonNote->
  "http://www.mathematica-journal.com/issue/v7i4/features/gehrig/contents/\
html/index.html"]], "RelatedLinks",
 CellChangeTimes->{{3.542689987375*^9, 3.54269003034375*^9}, 
   3.542703515421875*^9, {3.544534707107232*^9, 3.544534707668378*^9}},
 CellID->199155948],

Cell[TextData[ButtonBox["Stereographic Projection",
 BaseStyle->"Hyperlink",
 ButtonData->{
   URL["http://mathworld.wolfram.com/StereographicProjection.html"], None},
 ButtonNote->
  "http://mathworld.wolfram.com/StereographicProjection.html"]], \
"RelatedLinks",
 CellChangeTimes->{{3.542689879171875*^9, 3.54268988715625*^9}, {
  3.542689924875*^9, 3.542689924875*^9}},
 CellID->147018]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "AuthorSection"],

Cell[TextData[{
 "Contributed by: ",
 ButtonBox["Erik Mahieu",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://demonstrations.wolfram.com/author.html?author=Erik+Mahieu"], 
    None},
  ButtonNote->
   "http://demonstrations.wolfram.com/author.html?author=Erik+Mahieu"]
}], "Author",
 CellChangeTimes->{{3.5423657493165503`*^9, 3.5423657524885674`*^9}}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{768, 926},
WindowMargins->{{9, Automatic}, {Automatic, 28}},
PrintingPageRange->{Automatic, Automatic},
ShowSelection->True,
FrontEndVersion->"10.2 for Microsoft Windows (64-bit) (July 7, 2015)",
StyleDefinitions->FrontEnd`FileName[{"Wolfram"}, "Demonstration.nb", 
  CharacterEncoding -> "WindowsANSI"]
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "ResizeImages"->{
  Cell[222558, 4579, 352, 9, 22, "ControlSuggestions",
   CellTags->"ResizeImages"]},
 "RotateAndZoomIn3D"->{
  Cell[222913, 4590, 678, 16, 22, "ControlSuggestions",
   CellTags->"RotateAndZoomIn3D"]},
 "DragLocators"->{
  Cell[223594, 4608, 340, 11, 22, "ControlSuggestions",
   CellTags->"DragLocators"]},
 "CreateAndDeleteLocators"->{
  Cell[223937, 4621, 637, 15, 22, "ControlSuggestions",
   CellTags->"CreateAndDeleteLocators"]},
 "SliderZoom"->{
  Cell[224577, 4638, 884, 22, 22, "ControlSuggestions",
   CellTags->"SliderZoom"]},
 "GamepadControls"->{
  Cell[225464, 4662, 393, 10, 22, "ControlSuggestions",
   CellTags->"GamepadControls"]},
 "AutomaticAnimation"->{
  Cell[225860, 4674, 1502, 32, 22, "ControlSuggestions",
   CellTags->"AutomaticAnimation"]},
 "BookmarkAnimation"->{
  Cell[227365, 4708, 949, 22, 22, "ControlSuggestions",
   CellTags->"BookmarkAnimation"]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"ResizeImages", 230214, 4795},
 {"RotateAndZoomIn3D", 230324, 4798},
 {"DragLocators", 230435, 4801},
 {"CreateAndDeleteLocators", 230552, 4804},
 {"SliderZoom", 230667, 4807},
 {"GamepadControls", 230774, 4810},
 {"AutomaticAnimation", 230889, 4813},
 {"BookmarkAnimation", 231007, 4816}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 150, 2, 74, "DemoTitle"],
Cell[732, 26, 33, 0, 287, "InitializationSection"],
Cell[CellGroupData[{
Cell[790, 30, 29, 0, 192, "ManipulateSection"],
Cell[CellGroupData[{
Cell[844, 34, 87218, 1774, 2503, "Input"],
Cell[88065, 1810, 20569, 420, 469, "Output",
 CellID->199510402]
}, {2}]]
}, Open  ]],
Cell[CellGroupData[{
Cell[108680, 2236, 36, 0, 169, "ManipulateCaptionSection"],
Cell[108719, 2238, 239, 5, 22, "ManipulateCaption",
 CellID->11173229],
Cell[108961, 2245, 2019, 29, 97, "ManipulateCaption",
 CellID->114066697],
Cell[110983, 2276, 1847, 28, 52, "ManipulateCaption",
 CellID->169231355]
}, Open  ]],
Cell[CellGroupData[{
Cell[112867, 2309, 28, 0, 173, "ThumbnailSection"],
Cell[112898, 2311, 20443, 414, 469, "Output",
 CellID->282373083]
}, Open  ]],
Cell[CellGroupData[{
Cell[133378, 2730, 28, 0, 143, "SnapshotsSection"],
Cell[133409, 2732, 20261, 409, 469, "Output",
 CellID->446967361],
Cell[153673, 3143, 20323, 411, 469, "Output",
 CellID->193695706],
Cell[173999, 3556, 20241, 408, 469, "Output",
 CellID->502904314],
Cell[194243, 3966, 20342, 411, 469, "Output",
 CellID->208561602]
}, Open  ]],
Cell[CellGroupData[{
Cell[214622, 4382, 26, 0, 336, "DetailsSection"],
Cell[214651, 4384, 234, 5, 37, "DetailNotes",
 CellID->151340159],
Cell[214888, 4391, 381, 7, 52, "DetailNotes",
 CellID->402450682],
Cell[215272, 4400, 694, 18, 53, "DetailNotes",
 CellID->29490526],
Cell[215969, 4420, 590, 10, 67, "DetailNotes",
 CellID->44039224],
Cell[216562, 4432, 810, 16, 98, "DetailNotes",
 CellID->15312235],
Cell[217375, 4450, 460, 8, 52, "DetailNotes",
 CellID->61596088],
Cell[217838, 4460, 463, 8, 67, "DetailNotes",
 CellID->239776412],
Cell[218304, 4470, 399, 7, 52, "DetailNotes",
 CellID->435152130],
Cell[218706, 4479, 974, 23, 83, "DetailNotes",
 CellID->99655210],
Cell[219683, 4504, 733, 11, 82, "DetailNotes",
 CellID->240306128],
Cell[220419, 4517, 248, 5, 22, "DetailNotes",
 CellID->777683086],
Cell[220670, 4524, 231, 5, 22, "DetailNotes",
 CellID->304876035],
Cell[220904, 4531, 399, 8, 22, "DetailNotes",
 CellID->209868928],
Cell[221306, 4541, 213, 5, 22, "DetailNotes",
 CellID->24284052],
Cell[221522, 4548, 141, 3, 22, "DetailNotes",
 CellID->61528475],
Cell[221666, 4553, 815, 19, 37, "DetailNotes",
 CellID->482478948]
}, Open  ]],
Cell[CellGroupData[{
Cell[222518, 4577, 37, 0, 126, "ControlSuggestionsSection"],
Cell[222558, 4579, 352, 9, 22, "ControlSuggestions",
 CellTags->"ResizeImages"],
Cell[222913, 4590, 678, 16, 22, "ControlSuggestions",
 CellTags->"RotateAndZoomIn3D"],
Cell[223594, 4608, 340, 11, 22, "ControlSuggestions",
 CellTags->"DragLocators"],
Cell[223937, 4621, 637, 15, 22, "ControlSuggestions",
 CellTags->"CreateAndDeleteLocators"],
Cell[224577, 4638, 884, 22, 22, "ControlSuggestions",
 CellTags->"SliderZoom"],
Cell[225464, 4662, 393, 10, 22, "ControlSuggestions",
 CellTags->"GamepadControls"],
Cell[225860, 4674, 1502, 32, 22, "ControlSuggestions",
 CellTags->"AutomaticAnimation"],
Cell[227365, 4708, 949, 22, 22, "ControlSuggestions",
 CellTags->"BookmarkAnimation"]
}, Open  ]],
Cell[228329, 4733, 30, 0, 155, "SearchTermsSection"],
Cell[CellGroupData[{
Cell[228384, 4737, 31, 0, 129, "RelatedLinksSection"],
Cell[228418, 4739, 513, 11, 22, "RelatedLinks",
 CellID->199155948],
Cell[228934, 4752, 389, 9, 22, "RelatedLinks",
 CellID->147018]
}, Open  ]],
Cell[CellGroupData[{
Cell[229360, 4766, 25, 0, 141, "AuthorSection"],
Cell[229388, 4768, 363, 10, 22, "Author"]
}, Open  ]]
}, Open  ]]
}
]
*)

